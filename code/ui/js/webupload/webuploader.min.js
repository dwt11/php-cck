!function(Q,S){var P,T={},O=function(C,E){var B,A,D;if("string"==typeof C){return N(C)}for(B=[],A=C.length,D=0;A>D;D++){B.push(N(C[D]))}return E.apply(null,B)},K=function(C,A,B){2===arguments.length&&(B=A,A=null),O(A||[],function(){L(C,B,arguments)})},L=function(B,D,E){var C,A={exports:D};"function"==typeof D&&(E.length||(E=[O,A.exports,A]),C=D.apply(null,E),void 0!==C&&(A.exports=C)),T[B]=A.exports},N=function(A){var B=T[A]||Q[A];if(!B){throw new Error("`"+A+"` is undefined")}return B},R=function(E){var D,C,G,F,A,B;B=function(H){return H&&H.charAt(0).toUpperCase()+H.substr(1)};for(D in T){if(C=E,T.hasOwnProperty(D)){for(G=D.split("/"),A=B(G.pop());F=B(G.shift());){C[F]=C[F]||{},C=C[F]}C[A]=T[D]}}return E},M=function(A){return Q.__dollar=A,R(S(Q,K,O))};"object"==typeof module&&"object"==typeof module.exports?module.exports=M():"function"==typeof define&&define.amd?define(["jquery"],M):(P=Q.WebUploader,Q.WebUploader=M(),Q.WebUploader.noConflict=function(){Q.WebUploader=P})}(window,function(E,F,D){return F("dollar-third",[],function(){var A=E.__dollar||E.jQuery||E.Zepto;if(!A){throw new Error("jQuery or Zepto not found!")}return A}),F("dollar",["dollar-third"],function(A){return A}),F("promise-third",["dollar"],function(A){return{Deferred:A.Deferred,when:A.when,isPromise:function(B){return B&&"function"==typeof B.then}}}),F("promise",["promise-third"],function(A){return A}),F("base",["dollar","promise"],function(B,C){function K(G){return function(){return M.apply(G,arguments)}}function A(H,G){return function(){return H.apply(G,arguments)}}function N(H){var G;return Object.create?Object.create(H):(G=function(){},G.prototype=H,new G)}var L=function(){},M=Function.call;return{version:"0.1.5",$:B,Deferred:C.Deferred,isPromise:C.isPromise,when:C.when,browser:function(I){var S={},H=I.match(/WebKit\/([\d.]+)/),T=I.match(/Chrome\/([\d.]+)/)||I.match(/CriOS\/([\d.]+)/),G=I.match(/MSIE\s([\d\.]+)/)||I.match(/(?:trident)(?:.*rv:([\w.]+))?/i),U=I.match(/Firefox\/([\d.]+)/),V=I.match(/Safari\/([\d.]+)/),J=I.match(/OPR\/([\d.]+)/);return H&&(S.webkit=parseFloat(H[1])),T&&(S.chrome=parseFloat(T[1])),G&&(S.ie=parseFloat(G[1])),U&&(S.firefox=parseFloat(U[1])),V&&(S.safari=parseFloat(V[1])),J&&(S.opera=parseFloat(J[1])),S}(navigator.userAgent),os:function(H){var I={},J=H.match(/(?:Android);?[\s\/]+([\d.]+)?/),G=H.match(/(?:iPad|iPod|iPhone).*OS\s([\d_]+)/);return J&&(I.android=parseFloat(J[1])),G&&(I.ios=parseFloat(G[1].replace(/_/g,"."))),I}(navigator.userAgent),inherits:function(H,J,G){var I;return"function"==typeof J?(I=J,J=null):I=J&&J.hasOwnProperty("constructor")?J.constructor:function(){return H.apply(this,arguments)},B.extend(!0,I,H,G||{}),I.__super__=H.prototype,I.prototype=N(H.prototype),J&&B.extend(!0,I.prototype,J),I},noop:L,bindFn:A,log:function(){return E.console?A(console.log,console):L}(),nextTick:function(){return function(G){setTimeout(G,1)}}(),slice:K([].slice),guid:function(){var G=0;return function(J){for(var H=(+new Date).toString(32),I=0;5>I;I++){H+=Math.floor(65535*Math.random()).toString(32)}return(J||"wu_")+H+(G++).toString(32)}}(),formatSize:function(H,I,J){var G;for(J=J||["B","K","M","G","TB"];(G=J.shift())&&H>1024;){H/=1024}return("B"===G?H:H.toFixed(I||2))+G}}}),F("mediator",["base"],function(B){function L(H,J,G,I){return C.grep(H,function(K){return !(!K||J&&K.e!==J||G&&K.cb!==G&&K.cb._cb!==G||I&&K.ctx!==I)})}function M(G,H,I){C.each((G||"").split(O),function(K,J){I(J,H)})}function A(J,I){for(var H,K=!1,R=-1,G=J.length;++R<G;){if(H=J[R],H.cb.apply(H.ctx2,I)===!1){K=!0;break}}return !K}var N,C=B.$,P=[].slice,O=/\s+/;return N={on:function(I,H,J){var K,G=this;return H?(K=this._events||(this._events=[]),M(I,H,function(U,V){var T={e:U};T.cb=V,T.ctx=J,T.ctx2=J||G,T.id=K.length,K.push(T)}),this):this},once:function(H,G,I){var J=this;return G?(M(H,G,function(K,S){var T=function(){return J.off(K,T),S.apply(I||J,arguments)};T._cb=S,J.on(K,T,I)}),J):J},off:function(H,J,G){var I=this._events;return I?H||J||G?(M(H,J,function(R,K){C.each(L(I,R,K,G),function(){delete I[this.id]})}),this):(this._events=[],this):this},trigger:function(G){var J,I,H;return this._events&&G?(J=P.call(arguments,1),I=L(this._events,G),H=L(this._events,"all"),A(I,J)&&A(H,arguments)):this}},C.extend({installTo:function(G){return C.extend(G,N)}},N)}),F("uploader",["base","mediator"],function(B,H){function A(G){this.options=C.extend(!0,{},A.options,G),this._init(this.options)}var C=B.$;return A.options={},H.installTo(A.prototype),C.each({upload:"start-upload",stop:"stop-upload",getFile:"get-file",getFiles:"get-files",addFile:"add-file",addFiles:"add-file",sort:"sort-files",removeFile:"remove-file",cancelFile:"cancel-file",skipFile:"skip-file",retry:"retry",isInProgress:"is-in-progress",makeThumb:"make-thumb",md5File:"md5-file",getDimension:"get-dimension",addButton:"add-btn",predictRuntimeType:"predict-runtime-type",refresh:"refresh",disable:"disable",enable:"enable",reset:"reset"},function(J,G){A.prototype[J]=function(){return this.request(G,arguments)}}),C.extend(A.prototype,{state:"pending",_init:function(J){var G=this;G.request("init",J,function(){G.state="ready",G.trigger("ready")})},option:function(L,G){var K=this.options;return arguments.length>1?void (C.isPlainObject(G)&&C.isPlainObject(K[L])?C.extend(K[L],G):K[L]=G):L?K[L]:K},getStats:function(){var G=this.request("get-stats");return G?{successNum:G.numOfSuccess,progressNum:G.numOfProgress,cancelNum:G.numOfCancel,invalidNum:G.numOfInvalid,uploadFailNum:G.numOfUploadFailed,queueNum:G.numOfQueue,interruptNum:G.numofInterrupt}:{}},trigger:function(N){var M=[].slice.call(arguments,1),L=this.options,G="on"+N.substring(0,1).toUpperCase()+N.substring(1);return H.trigger.apply(this,arguments)===!1||C.isFunction(L[G])&&L[G].apply(this,M)===!1||C.isFunction(this[G])&&this[G].apply(this,M)===!1||H.trigger.apply(H,[this,N].concat(M))===!1?!1:!0},destroy:function(){this.request("destroy",arguments),this.off()},request:B.noop}),B.create=A.create=function(G){return new A(G)},B.Uploader=A,A}),F("runtime/runtime",["base","mediator"],function(B,A){function C(G){this.options=J.extend({container:document.body},G),this.uid=B.guid("rt_")}var J=B.$,K={},L=function(G){for(var H in G){if(G.hasOwnProperty(H)){return H}}return null};return J.extend(C.prototype,{getContainer:function(){var H,I,G=this.options;return this._container?this._container:(H=J(G.container||document.body),I=J(document.createElement("div")),I.attr("id","rt_"+this.uid),I.css({position:"absolute",top:"0px",left:"0px",width:"1px",height:"1px",overflow:"hidden"}),H.append(I),H.addClass("webuploader-container"),this._container=I,this._parent=H,I)},init:B.noop,exec:B.noop,destroy:function(){this._container&&this._container.remove(),this._parent&&this._parent.removeClass("webuploader-container"),this.off()}}),C.orders="html5,flash",C.addRuntime=function(G,H){K[G]=H},C.hasRuntime=function(G){return !!(G?K[G]:L(K))},C.create=function(I,H){var N,G;if(H=H||C.orders,J.each(H.split(/\s*,\s*/g),function(){return K[this]?(N=this,!1):void 0}),N=N||L(K),!N){throw new Error("Runtime Error")}return G=new K[N](I)},A.installTo(C.prototype),C}),F("runtime/client",["base","mediator","runtime/runtime"],function(B,A,C){function I(G,N){var M,H=B.Deferred();this.uid=B.guid("client_"),this.runtimeReady=function(K){return H.done(K)},this.connectRuntime=function(K,L){if(M){throw new Error("already connected!")}return H.done(L),"string"==typeof K&&J.get(K)&&(M=J.get(K)),M=M||J.get(null,N),M?(B.$.extend(M.options,K),M.__promise.then(H.resolve),M.__client++):(M=C.create(K,K.runtimeOrder),M.__promise=H.promise(),M.once("ready",H.resolve),M.init(),J.add(M),M.__client=1),N&&(M.__standalone=N),M},this.getRuntime=function(){return M},this.disconnectRuntime=function(){M&&(M.__client--,M.__client<=0&&(J.remove(M),delete M.__promise,M.destroy()),M=null)},this.exec=function(){if(M){var K=B.slice(arguments);return G&&K.unshift(G),M.exec.apply(this,K)}},this.getRuid=function(){return M&&M.uid},this.destroy=function(K){return function(){K&&K.apply(this,arguments),this.trigger("destroy"),this.off(),this.exec("destroy"),this.disconnectRuntime()}}(this.destroy)}var J;return J=function(){var G={};return{add:function(H){G[H.uid]=H},get:function(H,M){var N;if(H){return G[H]}for(N in G){if(!M||!G[N].__standalone){return G[N]}}return null},remove:function(H){delete G[H.uid]}}}(),A.installTo(I.prototype),I}),F("lib/dnd",["base","mediator","runtime/client"],function(B,A,C){function I(G){G=this.options=J.extend({},I.options,G),G.container=J(G.container),G.container.length&&C.call(this,"DragAndDrop")}var J=B.$;return I.options={accept:null,disableGlobalDnd:!1},B.inherits(C,{constructor:I,init:function(){var G=this;G.connectRuntime(G.options,function(){G.exec("init"),G.trigger("ready")})}}),A.installTo(I.prototype),I}),F("widgets/widget",["base","uploader"],function(C,O){function B(H){if(!H){return !1}var I=H.length,G=P.type(H);return 1===H.nodeType&&I?!0:"array"===G||"function"!==G&&"string"!==G&&(0===I||"number"==typeof I&&I>0&&I-1 in H)}function M(G){this.owner=G,this.options=G.options}var P=C.$,R=O.prototype._init,A=O.prototype.destroy,Q={},N=[];return P.extend(M.prototype,{init:C.noop,invoke:function(H,I){var G=this.responseMap;return G&&H in G&&G[H] in this&&P.isFunction(this[G[H]])?this[G[H]].apply(this,I):Q},request:function(){return this.owner.request.apply(this.owner,arguments)}}),P.extend(O.prototype,{_init:function(){var H=this,I=H._widgets=[],G=H.options.disableWidgets||"";return P.each(N,function(J,K){(!G||!~G.indexOf(K._name))&&I.push(new K(H))}),R.apply(H,arguments)},request:function(d,J,I){var a,b,Y,G,H=0,L=this._widgets,c=L&&L.length,Z=[],K=[];for(J=B(J)?J:[J];c>H;H++){a=L[H],b=a.invoke(d,J),b!==Q&&(C.isPromise(b)?K.push(b):Z.push(b))}return I||K.length?(Y=C.when.apply(C,K),G=Y.pipe?"pipe":"then",Y[G](function(){var T=C.Deferred(),S=arguments;return 1===S.length&&(S=S[0]),setTimeout(function(){T.resolve(S)},1),T.promise()})[I?G:"done"](I||C.noop)):Z[0]},destroy:function(){A.apply(this,arguments),this._widgets=null}}),O.register=M.register=function(H,I){var G,J={init:"init",destroy:"destroy",name:"anonymous"};return 1===arguments.length?(I=H,P.each(I,function(K){return"_"===K[0]||"name"===K?void ("name"===K&&(J.name=I.name)):void (J[K.replace(/[A-Z]/g,"-$&").toLowerCase()]=K)})):J=P.extend(J,H),I.responseMap=J,G=C.inherits(M,I),G._name=J.name,N.push(G),G},O.unRegister=M.unRegister=function(G){if(G&&"anonymous"!==G){for(var H=N.length;H--;){N[H]._name===G&&N.splice(H,1)}}},M}),F("widgets/filednd",["base","uploader","lib/dnd","widgets/widget"],function(B,H,A){var C=B.$;return H.options.dnd="",H.register({name:"dnd",init:function(G){if(G.dnd&&"html5"===this.request("predict-runtime-type")){var P,O=this,M=B.Deferred(),N=C.extend({},{disableGlobalDnd:G.disableGlobalDnd,container:G.dnd,accept:G.accept});return this.dnd=P=new A(N),P.once("ready",M.resolve),P.on("drop",function(I){O.request("add-file",[I])}),P.on("accept",function(I){return O.owner.trigger("dndAccept",I)}),P.init(),M.promise()}},destroy:function(){this.dnd&&this.dnd.destroy()}})}),F("lib/filepaste",["base","mediator","runtime/client"],function(B,A,C){function I(G){G=this.options=J.extend({},G),G.container=J(G.container||document.body),C.call(this,"FilePaste")}var J=B.$;return B.inherits(C,{constructor:I,init:function(){var G=this;G.connectRuntime(G.options,function(){G.exec("init"),G.trigger("ready")})}}),A.installTo(I.prototype),I}),F("widgets/filepaste",["base","uploader","lib/filepaste","widgets/widget"],function(B,H,A){var C=B.$;return H.register({name:"paste",init:function(G){if(G.paste&&"html5"===this.request("predict-runtime-type")){var P,O=this,M=B.Deferred(),N=C.extend({},{container:G.paste,accept:G.accept});return this.paste=P=new A(N),P.once("ready",M.resolve),P.on("paste",function(I){O.owner.request("add-file",[I])}),P.init(),M.promise()}},destroy:function(){this.paste&&this.paste.destroy()}})}),F("lib/blob",["base","runtime/client"],function(A,B){function C(K,J){var L=this;L.source=J,L.ruid=K,this.size=J.size||0,this.type=!J.type&&this.ext&&~"jpg,jpeg,png,gif,bmp".indexOf(this.ext)?"image/"+("jpg"===this.ext?"jpeg":this.ext):J.type||"application/octet-stream",B.call(L,"Blob"),this.uid=J.uid||this.uid,K&&L.connectRuntime(K)}return A.inherits(B,{constructor:C,slice:function(I,J){return this.exec("slice",I,J)},getSource:function(){return this.source}}),C}),F("lib/file",["base","lib/blob"],function(B,A){function C(L,H){var G;this.name=H.name||"untitled"+I++,G=J.exec(H.name)?RegExp.$1.toLowerCase():"",!G&&H.type&&(G=/\/(jpg|jpeg|png|gif|bmp)$/i.exec(H.type)?RegExp.$1.toLowerCase():"",this.name+="."+G),this.ext=G,this.lastModifiedDate=H.lastModifiedDate||(new Date).toLocaleString(),A.apply(this,arguments)}var I=1,J=/\.([^.]+)$/;return B.inherits(A,C)}),F("lib/filepicker",["base","runtime/client","lib/file"],function(A,B,C){function I(G){if(G=this.options=J.extend({},I.options,G),G.container=J(G.id),!G.container.length){throw new Error("按钮指定错误")}G.innerHTML=G.innerHTML||G.label||G.container.html()||"",G.button=J(G.button||document.createElement("div")),G.button.html(G.innerHTML),G.container.html(G.button),B.call(this,"FilePicker",!0)}var J=A.$;return I.options={button:null,container:null,label:null,innerHTML:null,multiple:!0,accept:null,name:"file"},A.inherits(B,{constructor:I,init:function(){var G=this,L=G.options,H=L.button;H.addClass("webuploader-pick"),G.on("all",function(N){var K;switch(N){case"mouseenter":H.addClass("webuploader-pick-hover");break;case"mouseleave":H.removeClass("webuploader-pick-hover");break;case"change":K=G.exec("getFiles"),G.trigger("select",J.map(K,function(M){return M=new C(G.getRuid(),M),M._refer=L.container,M}),L.container)}}),G.connectRuntime(L,function(){G.refresh(),G.exec("init",L),G.trigger("ready")}),this._resizeHandler=A.bindFn(this.refresh,this),J(E).on("resize",this._resizeHandler)},refresh:function(){var O=this.getRuntime().getContainer(),G=this.options.button,N=G.outerWidth?G.outerWidth():G.width(),H=G.outerHeight?G.outerHeight():G.height(),P=G.offset();N&&H&&O.css({bottom:"auto",right:"auto",width:N+"px",height:H+"px"}).offset(P)},enable:function(){var G=this.options.button;G.removeClass("webuploader-pick-disable"),this.refresh()},disable:function(){var G=this.options.button;this.getRuntime().getContainer().css({top:"-99999px"}),G.addClass("webuploader-pick-disable")},destroy:function(){var G=this.options.button;J(E).off("resize",this._resizeHandler),G.removeClass("webuploader-pick-disable webuploader-pick-hover webuploader-pick")}}),I}),F("widgets/filepicker",["base","uploader","lib/filepicker","widgets/widget"],function(B,H,A){var C=B.$;return C.extend(H.options,{pick:null,accept:null}),H.register({name:"picker",init:function(G){return this.pickers=[],G.pick&&this.addBtn(G.pick)},refresh:function(){C.each(this.pickers,function(){this.refresh()})},addBtn:function(G){var P=this,O=P.options,M=O.accept,N=[];if(G){return C.isPlainObject(G)||(G={id:G}),C(G.id).each(function(){var K,I,J;J=B.Deferred(),K=C.extend({},G,{accept:C.isPlainObject(M)?[M]:M,swf:O.swf,runtimeOrder:O.runtimeOrder,id:this}),I=new A(K),I.once("ready",J.resolve),I.on("select",function(L){P.owner.request("add-file",[L])}),I.init(),P.pickers.push(I),N.push(J.promise())}),B.when.apply(B,N)}},disable:function(){C.each(this.pickers,function(){this.disable()})},enable:function(){C.each(this.pickers,function(){this.enable()})},destroy:function(){C.each(this.pickers,function(){this.destroy()}),this.pickers=null}})}),F("lib/image",["base","runtime/client","lib/blob"],function(B,A,C){function I(G){this.options=J.extend({},I.options,G),A.call(this,"Image"),this.on("load",function(){this._info=this.exec("info"),this._meta=this.exec("meta")})}var J=B.$;return I.options={quality:90,crop:!1,preserveHeaders:!1,allowMagnify:!1},B.inherits(A,{constructor:I,info:function(G){return G?(this._info=G,this):this._info},meta:function(G){return G?(this._meta=G,this):this._meta},loadFromBlob:function(G){var H=this,L=G.getRuid();this.connectRuntime(L,function(){H.exec("init",H.options),H.exec("loadFromBlob",G)})},resize:function(){var G=B.slice(arguments);return this.exec.apply(this,["resize"].concat(G))},crop:function(){var G=B.slice(arguments);return this.exec.apply(this,["crop"].concat(G))},getAsDataUrl:function(G){return this.exec("getAsDataUrl",G)},getAsBlob:function(H){var G=this.exec("getAsBlob",H);return new C(this.getRuid(),G)}}),I}),F("widgets/image",["base","uploader","lib/image","widgets/widget"],function(B,A,C){var I,J=B.$;return I=function(M){var N=0,G=[],H=function(){for(var K;G.length&&M>N;){K=G.shift(),N+=K[0],K[1]()}};return function(K,P,L){G.push([P,L]),K.once("destroy",function(){N-=P,setTimeout(H,1)}),setTimeout(H,1)}}(5242880),J.extend(A.options,{thumb:{width:110,height:110,quality:70,allowMagnify:!0,crop:!0,preserveHeaders:!1,type:"image/jpeg"},compress:{width:1600,height:1600,quality:90,allowMagnify:!1,crop:!1,preserveHeaders:!0}}),A.register({name:"image",makeThumb:function(Q,P,O,H){var R,G;return Q=this.request("get-file",Q),Q.type.match(/^image/)?(R=J.extend({},this.options.thumb),J.isPlainObject(O)&&(R=J.extend(R,O),O=null),O=O||R.width,H=H||R.height,G=new C(R),G.once("load",function(){Q._info=Q._info||G.info(),Q._meta=Q._meta||G.meta(),1>=O&&O>0&&(O=Q._info.width*O),1>=H&&H>0&&(H=Q._info.height*H),G.resize(O,H)}),G.once("complete",function(){P(!1,G.getAsDataUrl(R.type)),G.destroy()}),G.once("error",function(K){P(K||!0),G.destroy()}),void I(G,Q.source.size,function(){Q._info&&G.info(Q._info),Q._meta&&G.meta(Q._meta),G.loadFromBlob(Q.source)})):void P(!0)},beforeSendFile:function(Q){var R,O,H=this.options.compress||this.options.resize,G=H&&H.compressSize||0,P=H&&H.noCompressIfLarger||!1;return Q=this.request("get-file",Q),!H||!~"image/jpeg,image/jpg".indexOf(Q.type)||Q.size<G||Q._compressed?void 0:(H=J.extend({},H),O=B.Deferred(),R=new C(H),O.always(function(){R.destroy(),R=null}),R.once("error",O.reject),R.once("load",function(){var L=H.width,K=H.height;Q._info=Q._info||R.info(),Q._meta=Q._meta||R.meta(),1>=L&&L>0&&(L=Q._info.width*L),1>=K&&K>0&&(K=Q._info.height*K),R.resize(L,K)}),R.once("complete",function(){var M,L;try{M=R.getAsBlob(H.type),L=Q.size,(!P||M.size<L)&&(Q.source=M,Q.size=M.size,Q.trigger("resize",M.size,L)),Q._compressed=!0,O.resolve()}catch(K){O.resolve()}}),Q._info&&R.info(Q._info),Q._meta&&R.meta(Q._meta),R.loadFromBlob(Q.source),O.promise())}})}),F("file",["base","mediator"],function(C,O){function B(){return R+A++}function M(G){this.name=G.name||"Untitled",this.size=G.size||0,this.type=G.type||"application/octet-stream",this.lastModifiedDate=G.lastModifiedDate||1*new Date,this.id=B(),this.ext=Q.exec(this.name)?RegExp.$1:"",this.statusText="",N[this.id]=M.Status.INITED,this.source=G,this.loaded=0,this.on("error",function(H){this.setStatus(M.Status.ERROR,H)})}var P=C.$,R="WU_FILE_",A=0,Q=/\.([^.]+)$/,N={};return P.extend(M.prototype,{setStatus:function(H,I){var G=N[this.id];"undefined"!=typeof I&&(this.statusText=I),H!==G&&(N[this.id]=H,this.trigger("statuschange",H,G))},getStatus:function(){return N[this.id]},getSource:function(){return this.source},destroy:function(){this.off(),delete N[this.id]}}),O.installTo(M.prototype),M.Status={INITED:"inited",QUEUED:"queued",PROGRESS:"progress",ERROR:"error",COMPLETE:"complete",CANCELLED:"cancelled",INTERRUPT:"interrupt",INVALID:"invalid"},M}),F("queue",["base","mediator","file"],function(B,A,C){function J(){this.stats={numOfQueue:0,numOfSuccess:0,numOfCancel:0,numOfProgress:0,numOfUploadFailed:0,numOfInvalid:0,numofDeleted:0,numofInterrupt:0},this._queue=[],this._map={}}var K=B.$,L=C.Status;return K.extend(J.prototype,{append:function(G){return this._queue.push(G),this._fileAdded(G),this},prepend:function(G){return this._queue.unshift(G),this._fileAdded(G),this},getFile:function(G){return"string"!=typeof G?G:this._map[G]},fetch:function(I){var G,H,N=this._queue.length;for(I=I||L.QUEUED,G=0;N>G;G++){if(H=this._queue[G],I===H.getStatus()){return H}}return null},sort:function(G){"function"==typeof G&&this._queue.sort(G)},getFiles:function(){for(var O,G=[].slice.call(arguments,0),I=[],P=0,H=this._queue.length;H>P;P++){O=this._queue[P],(!G.length||~K.inArray(O.getStatus(),G))&&I.push(O)}return I},removeFile:function(G){var H=this._map[G.id];H&&(delete this._map[G.id],G.destroy(),this.stats.numofDeleted++)},_fileAdded:function(H){var I=this,G=this._map[H.id];G||(this._map[H.id]=H,H.on("statuschange",function(O,P){I._onFileStatusChange(O,P)}))},_onFileStatusChange:function(H,I){var G=this.stats;switch(I){case L.PROGRESS:G.numOfProgress--;break;case L.QUEUED:G.numOfQueue--;break;case L.ERROR:G.numOfUploadFailed--;break;case L.INVALID:G.numOfInvalid--;break;case L.INTERRUPT:G.numofInterrupt--}switch(H){case L.QUEUED:G.numOfQueue++;break;case L.PROGRESS:G.numOfProgress++;break;case L.ERROR:G.numOfUploadFailed++;break;case L.COMPLETE:G.numOfSuccess++;break;case L.CANCELLED:G.numOfCancel++;break;case L.INVALID:G.numOfInvalid++;break;case L.INTERRUPT:G.numofInterrupt++}}}),A.installTo(J.prototype),J}),F("widgets/queue",["base","uploader","queue","file","lib/file","runtime/client","widgets/widget"],function(C,O,B,M,P,R){var A=C.$,Q=/\.\w+$/,N=M.Status;return O.register({name:"queue",init:function(W){var X,I,L,V,G,H,J,K=this;if(A.isPlainObject(W.accept)&&(W.accept=[W.accept]),W.accept){for(G=[],L=0,I=W.accept.length;I>L;L++){V=W.accept[L].extensions,V&&G.push(V)}G.length&&(H="\\."+G.join(",").replace(/,/g,"$|\\.").replace(/\*/g,".*")+"$"),K.accept=new RegExp(H,"i")}return K.queue=new B,K.stats=K.queue.stats,"html5"===this.request("predict-runtime-type")?(X=C.Deferred(),this.placeholder=J=new R("Placeholder"),J.connectRuntime({runtimeOrder:"html5"},function(){K._ruid=J.getRuid(),X.resolve()}),X.promise()):void 0},_wrapFile:function(G){if(!(G instanceof M)){if(!(G instanceof P)){if(!this._ruid){throw new Error("Can't add external files.")}G=new P(this._ruid,G)}G=new M(G)}return G},acceptFile:function(G){var H=!G||!G.size||this.accept&&Q.exec(G.name)&&!this.accept.test(G.name);return !H},_addFile:function(G){var H=this;return G=H._wrapFile(G),H.owner.trigger("beforeFileQueued",G)?H.acceptFile(G)?(H.queue.append(G),H.owner.trigger("fileQueued",G),G):void H.owner.trigger("error","Q_TYPE_DENIED",G):void 0},getFile:function(G){return this.queue.getFile(G)},addFile:function(G){var H=this;G.length||(G=[G]),G=A.map(G,function(I){return H._addFile(I)}),H.owner.trigger("filesQueued",G),H.options.auto&&setTimeout(function(){H.request("start-upload")},20)},getStats:function(){return this.stats},removeFile:function(H,I){var G=this;H=H.id?H:G.queue.getFile(H),this.request("cancel-file",H),I&&this.queue.removeFile(H)},getFiles:function(){return this.queue.getFiles.apply(this.queue,arguments)},fetchFile:function(){return this.queue.fetch.apply(this.queue,arguments)},retry:function(K,J){var I,L,H,G=this;if(K){return K=K.id?K:G.queue.getFile(K),K.setStatus(N.QUEUED),void (J||G.request("start-upload"))}for(I=G.queue.getFiles(N.ERROR),L=0,H=I.length;H>L;L++){K=I[L],K.setStatus(N.QUEUED)}G.request("start-upload")},sortFiles:function(){return this.queue.sort.apply(this.queue,arguments)},reset:function(){this.owner.trigger("reset"),this.queue=new B,this.stats=this.queue.stats},destroy:function(){this.reset(),this.placeholder&&this.placeholder.destroy()}})}),F("widgets/runtime",["uploader","runtime/runtime","widgets/widget"],function(B,A){return B.support=function(){return A.hasRuntime.apply(A,arguments)},B.register({name:"runtime",init:function(){if(!this.predictRuntimeType()){throw Error("Runtime Error")}},predictRuntimeType:function(){var K,J,C=this.options.runtimeOrder||A.orders,L=this.type;if(!L){for(C=C.split(/\s*,\s*/g),K=0,J=C.length;J>K;K++){if(A.hasRuntime(C[K])){this.type=L=C[K];break}}}return L}})}),F("lib/transport",["base","runtime/client","mediator"],function(B,A,C){function I(H){var G=this;H=G.options=J.extend(!0,{},I.options,H||{}),A.call(this,"Transport"),this._blob=null,this._formData=H.formData||{},this._headers=H.headers||{},this.on("progress",this._timeout),this.on("load error",function(){G.trigger("progress",1),clearTimeout(G._timer)})}var J=B.$;return I.options={server:"",method:"POST",withCredentials:!1,fileVal:"file",timeout:120000,formData:{},headers:{},sendAsBinary:!1},J.extend(I.prototype,{appendBlob:function(O,G,N){var H=this,P=H.options;H.getRuid()&&H.disconnectRuntime(),H.connectRuntime(G.ruid,function(){H.exec("init")}),H._blob=G,P.fileVal=O||P.fileVal,P.filename=N||P.filename},append:function(H,G){"object"==typeof H?J.extend(this._formData,H):this._formData[H]=G},setRequestHeader:function(H,G){"object"==typeof H?J.extend(this._headers,H):this._headers[H]=G},send:function(G){this.exec("send",G),this._timeout()},abort:function(){return clearTimeout(this._timer),this.exec("abort")},destroy:function(){this.trigger("destroy"),this.off(),this.exec("destroy"),this.disconnectRuntime()},getResponse:function(){return this.exec("getResponse")},getResponseAsJson:function(){return this.exec("getResponseAsJson")},getStatus:function(){return this.exec("getStatus")},_timeout:function(){var H=this,G=H.options.timeout;G&&(clearTimeout(H._timer),H._timer=setTimeout(function(){H.abort(),H.trigger("error","timeout")},G))}}),C.installTo(I.prototype),I}),F("widgets/upload",["base","uploader","file","lib/transport","widgets/widget"],function(B,L,M,A){function N(K,W){var X,Z,I=[],V=K.source,Y=V.size,G=W?Math.ceil(Y/W):1,H=0,J=0;for(Z={file:K,has:function(){return !!I.length},shift:function(){return I.shift()},unshift:function(Q){I.unshift(Q)}};G>J;){X=Math.min(W,Y-H),I.push({file:K,start:H,end:W?H+X:Y,total:Y,chunks:G,chunk:J++,cuted:Z}),H+=X}return K.blocks=I.concat(),K.remaning=I.length,Z}var C=B.$,P=B.isPromise,O=M.Status;C.extend(L.options,{prepareNextFile:!1,chunked:!1,chunkSize:5242880,chunkRetry:2,threads:3,formData:{}}),L.register({name:"upload",init:function(){var G=this.owner,H=this;this.runing=!1,this.progress=!1,G.on("startUpload",function(){H.progress=!0}).on("uploadFinished",function(){H.progress=!1}),this.pool=[],this.stack=[],this.pending=[],this.remaning=0,this.__tick=B.bindFn(this._tick,this),G.on("uploadComplete",function(I){I.blocks&&C.each(I.blocks,function(K,J){J.transport&&(J.transport.abort(),J.transport.destroy()),delete J.transport}),delete I.blocks,delete I.remaning})},reset:function(){this.request("stop-upload",!0),this.runing=!1,this.pool=[],this.stack=[],this.pending=[],this.remaning=0,this._trigged=!1,this._promise=null},startUpload:function(I){var G=this;if(C.each(G.request("get-files",O.INVALID),function(){G.request("remove-file",this)}),I){if(I=I.id?I:G.request("get-file",I),I.getStatus()===O.INTERRUPT){C.each(G.pool,function(K,J){J.file===I&&J.transport&&J.transport.send()}),I.setStatus(O.QUEUED)}else{if(I.getStatus()===O.PROGRESS){return}I.setStatus(O.QUEUED)}}else{C.each(G.request("get-files",[O.INITED]),function(){this.setStatus(O.QUEUED)})}if(!G.runing){G.runing=!0;var H=[];C.each(G.pool,function(R,K){var J=K.file;J.getStatus()===O.INTERRUPT&&(H.push(J),G._trigged=!1,K.transport&&K.transport.send())});for(var I;I=H.shift();){I.setStatus(O.PROGRESS)}I||C.each(G.request("get-files",O.INTERRUPT),function(){this.setStatus(O.PROGRESS)}),G._trigged=!1,B.nextTick(G.__tick),G.owner.trigger("startUpload")}},stopUpload:function(I,G){var H=this;if(I===!0&&(G=I,I=null),H.runing!==!1){if(I){if(I=I.id?I:H.request("get-file",I),I.getStatus()!==O.PROGRESS&&I.getStatus()!==O.QUEUED){return}return I.setStatus(O.INTERRUPT),C.each(H.pool,function(K,J){J.file===I&&(J.transport&&J.transport.abort(),H._putback(J),H._popBlock(J))}),B.nextTick(H.__tick)}H.runing=!1,this._promise&&this._promise.file&&this._promise.file.setStatus(O.INTERRUPT),G&&C.each(H.pool,function(K,J){J.transport&&J.transport.abort(),J.file.setStatus(O.INTERRUPT)}),H.owner.trigger("stopUpload")}},cancelFile:function(G){G=G.id?G:this.request("get-file",G),G.blocks&&C.each(G.blocks,function(I,J){var H=J.transport;H&&(H.abort(),H.destroy(),delete J.transport)}),G.setStatus(O.CANCELLED),this.owner.trigger("fileDequeued",G)},isInProgress:function(){return !!this.progress},_getStats:function(){return this.request("get-stats")},skipFile:function(H,G){H=H.id?H:this.request("get-file",H),H.setStatus(G||O.COMPLETE),H.skipped=!0,H.blocks&&C.each(H.blocks,function(K,J){var I=J.transport;I&&(I.abort(),I.destroy(),delete J.transport)}),this.owner.trigger("uploadSkip",H)},_tick:function(){var G,H,I=this,J=I.options;return I._promise?I._promise.always(I.__tick):void (I.pool.length<J.threads&&(H=I._nextBlock())?(I._trigged=!1,G=function(K){I._promise=null,K&&K.file&&I._startSend(K),B.nextTick(I.__tick)},I._promise=P(H)?H.always(G):G(H)):I.remaning||I._getStats().numOfQueue||I._getStats().numofInterrupt||(I.runing=!1,I._trigged||B.nextTick(function(){I.owner.trigger("uploadFinished")}),I._trigged=!0))},_putback:function(H){var G;H.cuted.unshift(H),G=this.stack.indexOf(H.cuted),~G||this.stack.unshift(H.cuted)},_getStack:function(){for(var H,G=0;H=this.stack[G++];){if(H.has()&&H.file.getStatus()===O.PROGRESS){return H}(!H.has()||H.file.getStatus()!==O.PROGRESS&&H.file.getStatus()!==O.INTERRUPT)&&this.stack.splice(--G,1)}return null},_nextBlock:function(){var J,I,H,R,K=this,G=K.options;return(J=this._getStack())?(G.prepareNextFile&&!K.pending.length&&K._prepareNextFile(),J.shift()):K.runing?(!K.pending.length&&K._getStats().numOfQueue&&K._prepareNextFile(),I=K.pending.shift(),H=function(Q){return Q?(J=N(Q,G.chunked?G.chunkSize:0),K.stack.push(J),J.shift()):null},P(I)?(R=I.file,I=I[I.pipe?"pipe":"then"](H),I.file=R,I):H(I)):void 0},_prepareNextFile:function(){var H,J=this,G=J.request("fetch-file"),I=J.pending;G&&(H=J.request("before-send-file",G,function(){return G.getStatus()===O.PROGRESS||G.getStatus()===O.INTERRUPT?G:J._finishFile(G)}),J.owner.trigger("uploadStart",G),G.setStatus(O.PROGRESS),H.file=G,H.done(function(){var K=C.inArray(H,I);~K&&I.splice(K,1,G)}),H.fail(function(K){G.setStatus(O.ERROR,K),J.owner.trigger("uploadError",G,K),J.owner.trigger("uploadComplete",G)}),I.push(H))},_popBlock:function(H){var G=C.inArray(H,this.pool);this.pool.splice(G,1),H.file.remaning--,this.remaning--},_startSend:function(G){var H,I=this,J=G.file;return J.getStatus()!==O.PROGRESS?void (J.getStatus()===O.INTERRUPT&&I._putback(G)):(I.pool.push(G),I.remaning++,G.blob=1===G.chunks?J.source:J.source.slice(G.start,G.end),H=I.request("before-send",G,function(){J.getStatus()===O.PROGRESS?I._doSend(G):(I._popBlock(G),B.nextTick(I.__tick))}),void H.fail(function(){1===J.remaning?I._finishFile(J).always(function(){G.percentage=1,I._popBlock(G),I.owner.trigger("uploadComplete",J),B.nextTick(I.__tick)}):(G.percentage=1,I.updateFileProgress(J),I._popBlock(G),B.nextTick(I.__tick))}))},_doSend:function(V){var Y,I,Z=this,H=Z.owner,J=Z.options,G=V.file,X=new A(J),K=C.extend({},J.formData),W=C.extend({},J.headers);V.transport=X,X.on("destroy",function(){delete V.transport,Z._popBlock(V),B.nextTick(Z.__tick)}),X.on("progress",function(Q){V.percentage=Q,Z.updateFileProgress(G)}),Y=function(R){var Q;return I=X.getResponseAsJson()||{},I._raw=X.getResponse(),Q=function(S){R=S},H.trigger("uploadAccept",V,I,Q)||(R=R||"server"),R},X.on("error",function(R,Q){V.retried=V.retried||0,V.chunks>1&&~"http,abort".indexOf(R)&&V.retried<J.chunkRetry?(V.retried++,X.send()):(Q||"server"!==R||(R=Y(R)),G.setStatus(O.ERROR,R),H.trigger("uploadError",G,R),H.trigger("uploadComplete",G))}),X.on("load",function(){var Q;return(Q=Y())?void X.trigger("error",Q,!0):void (1===G.remaning?Z._finishFile(G,I):X.destroy())}),K=C.extend(K,{id:G.id,name:G.name,type:G.type,lastModifiedDate:G.lastModifiedDate,size:G.size}),V.chunks>1&&C.extend(K,{chunks:V.chunks,chunk:V.chunk}),H.trigger("uploadBeforeSend",V,K,W),X.appendBlob(J.fileVal,V.blob,G.name),X.append(K),X.setRequestHeader(W),X.send()},_finishFile:function(H,J,G){var I=this.owner;return I.request("after-send-file",arguments,function(){H.setStatus(O.COMPLETE),I.trigger("uploadSuccess",H,J,G)}).fail(function(K){H.getStatus()===O.PROGRESS&&H.setStatus(O.ERROR,K),I.trigger("uploadError",H,K)}).always(function(){I.trigger("uploadComplete",H)})},updateFileProgress:function(G){var H=0,I=0;G.blocks&&(C.each(G.blocks,function(K,J){I+=(J.percentage||0)*(J.end-J.start)}),H=I/G.size,this.owner.trigger("uploadProgress",G,H||0))}})}),F("widgets/validator",["base","uploader","file","widgets/widget"],function(B,A,C){var J,K=B.$,L={};return J={addValidator:function(G,H){L[G]=H},removeValidator:function(G){delete L[G]}},A.register({name:"validator",init:function(){var G=this;B.nextTick(function(){K.each(L,function(){this.call(G.owner)})})}}),J.addValidator("fileNumLimit",function(){var H=this,I=H.options,O=0,P=parseInt(I.fileNumLimit,10),G=!0;P&&(H.on("beforeFileQueued",function(M){return O>=P&&G&&(G=!1,this.trigger("error","Q_EXCEED_NUM_LIMIT",P,M),setTimeout(function(){G=!0},1)),O>=P?!1:!0}),H.on("fileQueued",function(){O++}),H.on("fileDequeued",function(){O--}),H.on("reset",function(){O=0}))}),J.addValidator("fileSizeLimit",function(){var H=this,I=H.options,O=0,P=parseInt(I.fileSizeLimit,10),G=!0;P&&(H.on("beforeFileQueued",function(N){var M=O+N.size>P;return M&&G&&(G=!1,this.trigger("error","Q_EXCEED_SIZE_LIMIT",P,N),setTimeout(function(){G=!0},1)),M?!1:!0}),H.on("fileQueued",function(M){O+=M.size}),H.on("fileDequeued",function(M){O-=M.size}),H.on("reset",function(){O=0}))}),J.addValidator("fileSingleSizeLimit",function(){var H=this,G=H.options,I=G.fileSingleSizeLimit;I&&H.on("beforeFileQueued",function(N){return N.size>I?(N.setStatus(C.Status.INVALID,"exceed_size"),this.trigger("error","F_EXCEED_SIZE",I,N),!1):void 0})}),J.addValidator("duplicate",function(){function I(S){for(var U,V=0,T=0,M=S.length;M>T;T++){U=S.charCodeAt(T),V=U+(V<<6)+(V<<16)-V}return V}var G=this,H=G.options,N={};H.duplicate||(G.on("beforeFileQueued",function(M){var P=M.__hash||(M.__hash=I(M.name+M.size+M.lastModifiedDate));return N[P]?(this.trigger("error","F_DUPLICATE",M),!1):void 0}),G.on("fileQueued",function(P){var M=P.__hash;M&&(N[M]=!0)}),G.on("fileDequeued",function(P){var M=P.__hash;M&&delete N[M]}),G.on("reset",function(){N={}}))}),J}),F("lib/md5",["runtime/client","mediator"],function(A,B){function C(){A.call(this,"Md5")}return B.installTo(C.prototype),C.prototype.loadFromBlob=function(I){var J=this;J.getRuid()&&J.disconnectRuntime(),J.connectRuntime(I.ruid,function(){J.exec("init"),J.exec("loadFromBlob",I)})},C.prototype.getResult=function(){return this.exec("getResult")},C}),F("widgets/md5",["base","uploader","lib/md5","lib/blob","widgets/widget"],function(B,H,A,C){return H.register({name:"md5",md5File:function(P,R,Q){var N=new A,O=B.Deferred(),G=P instanceof C?P:this.request("get-file",P).source;return N.on("progress load",function(I){I=I||{},O.notify(I.total?I.loaded/I.total:1)}),N.on("complete",function(){O.resolve(N.getResult())}),N.on("error",function(I){O.reject(I)}),arguments.length>1&&(R=R||0,Q=Q||0,0>R&&(R=G.size+R),0>Q&&(Q=G.size+Q),Q=Math.min(Q,G.size),G=G.slice(R,Q)),N.loadFromBlob(G),O.promise()}})}),F("runtime/compbase",[],function(){function A(B,C){this.owner=B,this.options=B.options,this.getRuntime=function(){return C},this.getRuid=function(){return C.uid},this.trigger=function(){return B.trigger.apply(B,arguments)}}return A}),F("runtime/html5/runtime",["base","runtime/runtime","runtime/compbase"],function(B,A,J){function C(){var H={},I=this,G=this.destroy;A.apply(I,arguments),I.type=L,I.exec=function(V,U){var T,X=this,S=X.uid,W=B.slice(arguments,2);return K[V]&&(T=H[S]=H[S]||new K[V](X,I),T[U])?T[U].apply(T,W):void 0},I.destroy=function(){return G&&G.apply(this,arguments)}}var L="html5",K={};return B.inherits(A,{constructor:C,init:function(){var G=this;setTimeout(function(){G.trigger("ready")},1)}}),C.register=function(H,G){var I=K[H]=B.inherits(J,G);return I},E.Blob&&E.FileReader&&E.DataView&&A.addRuntime(L,C),C}),F("runtime/html5/blob",["runtime/html5/runtime","lib/blob"],function(B,A){return B.register("Blob",{slice:function(K,J){var C=this.owner.source,L=C.slice||C.webkitSlice||C.mozSlice;return C=L.call(C,K,J),new A(this.getRuid(),C)}})}),F("runtime/html5/dnd",["base","runtime/html5/runtime","lib/file"],function(B,A,C){var I=B.$,J="webuploader-dnd-";return A.register("DragAndDrop",{init:function(){var G=this.elem=this.options.container;this.dragEnterHandler=B.bindFn(this._dragEnterHandler,this),this.dragOverHandler=B.bindFn(this._dragOverHandler,this),this.dragLeaveHandler=B.bindFn(this._dragLeaveHandler,this),this.dropHandler=B.bindFn(this._dropHandler,this),this.dndOver=!1,G.on("dragenter",this.dragEnterHandler),G.on("dragover",this.dragOverHandler),G.on("dragleave",this.dragLeaveHandler),G.on("drop",this.dropHandler),this.options.disableGlobalDnd&&(I(document).on("dragover",this.dragOverHandler),I(document).on("drop",this.dropHandler))},_dragEnterHandler:function(M){var N,G=this,H=G._denied||!1;return M=M.originalEvent||M,G.dndOver||(G.dndOver=!0,N=M.dataTransfer.items,N&&N.length&&(G._denied=H=!G.trigger("accept",N)),G.elem.addClass(J+"over"),G.elem[H?"addClass":"removeClass"](J+"denied")),M.dataTransfer.dropEffect=H?"none":"copy",!1},_dragOverHandler:function(H){var G=this.elem.parent().get(0);return G&&!I.contains(G,H.currentTarget)?!1:(clearTimeout(this._leaveTimer),this._dragEnterHandler.call(this,H),!1)},_dragLeaveHandler:function(){var H,G=this;return H=function(){G.dndOver=!1,G.elem.removeClass(J+"over "+J+"denied")},clearTimeout(G._leaveTimer),G._leaveTimer=setTimeout(H,100),!1},_dropHandler:function(P){var S,Q,H=this,T=H.getRuid(),G=H.elem.parent().get(0);if(G&&!I.contains(G,P.currentTarget)){return !1}P=P.originalEvent||P,S=P.dataTransfer;try{Q=S.getData("text/html")}catch(R){}return Q?void 0:(H._getTansferFiles(S,function(K){H.trigger("drop",I.map(K,function(L){return new C(T,L)}))}),H.dndOver=!1,H.elem.removeClass(J+"over"),!1)},_getTansferFiles:function(U,Z){var Y,H,a,X,V,W,b,G=[],T=[];for(Y=U.items,H=U.files,b=!(!Y||!Y[0].webkitGetAsEntry),V=0,W=H.length;W>V;V++){a=H[V],X=Y&&Y[V],b&&X.webkitGetAsEntry().isDirectory?T.push(this._traverseDirectoryTree(X.webkitGetAsEntry(),G)):G.push(a)}B.when.apply(B,T).done(function(){G.length&&Z(G)})},_traverseDirectoryTree:function(G,M){var H=B.Deferred(),N=this;return G.isFile?G.file(function(K){M.push(K),H.resolve()}):G.isDirectory&&G.createReader().readEntries(function(R){var S,T=R.length,L=[],K=[];for(S=0;T>S;S++){L.push(N._traverseDirectoryTree(R[S],K))}B.when.apply(B,L).then(function(){M.push.apply(M,K),H.resolve()},H.reject)}),H.promise()},destroy:function(){var G=this.elem;G&&(G.off("dragenter",this.dragEnterHandler),G.off("dragover",this.dragOverHandler),G.off("dragleave",this.dragLeaveHandler),G.off("drop",this.dropHandler),this.options.disableGlobalDnd&&(I(document).off("dragover",this.dragOverHandler),I(document).off("drop",this.dropHandler)))}})}),F("runtime/html5/filepaste",["base","runtime/html5/runtime","lib/file"],function(A,B,C){return B.register("FilePaste",{init:function(){var N,R,O,P,S=this.options,Q=this.elem=S.container,T=".*";if(S.accept){for(N=[],R=0,O=S.accept.length;O>R;R++){P=S.accept[R].mimeTypes,P&&N.push(P)}N.length&&(T=N.join(","),T=T.replace(/,/g,"|").replace(/\*/g,".*"))}this.accept=T=new RegExp(T,"i"),this.hander=A.bindFn(this._pasteHander,this),Q.on("paste",this.hander)},_pasteHander:function(O){var V,R,U,S,T,P=[],Q=this.getRuid();for(O=O.originalEvent||O,V=O.clipboardData.items,S=0,T=V.length;T>S;S++){R=V[S],"file"===R.kind&&(U=R.getAsFile())&&P.push(new C(Q,U))}P.length&&(O.preventDefault(),O.stopPropagation(),this.trigger("paste",P))},destroy:function(){this.elem.off("paste",this.hander)}})}),F("runtime/html5/filepicker",["base","runtime/html5/runtime"],function(A,B){var C=A.$;return B.register("FilePicker",{init:function(){var W,V,Y,X,T=this.getRuntime().getContainer(),U=this,Z=U.owner,Q=U.options,R=this.label=C(document.createElement("label")),S=this.input=C(document.createElement("input"));if(S.attr("type","file"),S.attr("name",Q.name),S.addClass("webuploader-element-invisible"),R.on("click",function(){S.trigger("click")}),R.css({opacity:0,width:"100%",height:"100%",display:"block",cursor:"pointer",background:"#ffffff"}),Q.multiple&&S.attr("multiple","multiple"),Q.accept&&Q.accept.length>0){for(W=[],V=0,Y=Q.accept.length;Y>V;V++){W.push(Q.accept[V].mimeTypes)}S.attr("accept",W.join(","))}T.append(S),T.append(R),X=function(G){Z.trigger(G.type)},S.on("change",function(H){var G,I=arguments.callee;U.files=H.target.files,G=this.cloneNode(!0),G.value=null,this.parentNode.replaceChild(G,this),S.off(),S=C(G).on("change",I).on("mouseenter mouseleave",X),Z.trigger("change")}),R.on("mouseenter mouseleave",X)},getFiles:function(){return this.files},destroy:function(){this.input.off(),this.label.off()}})}),F("runtime/html5/util",["base"],function(A){var B=E.createObjectURL&&E||E.URL&&URL.revokeObjectURL&&URL||E.webkitURL,C=A.noop,H=C;return B&&(C=function(){return B.createObjectURL.apply(B,arguments)},H=function(){return B.revokeObjectURL.apply(B,arguments)}),{createObjectURL:C,revokeObjectURL:H,dataURL2Blob:function(S){var G,R,P,T,Q,O;for(O=S.split(","),G=~O[0].indexOf("base64")?atob(O[1]):decodeURIComponent(O[1]),P=new ArrayBuffer(G.length),R=new Uint8Array(P),T=0;T<G.length;T++){R[T]=G.charCodeAt(T)}return Q=O[0].split(":")[1].split(";")[0],this.arrayBufferToBlob(P,Q)},dataURL2ArrayBuffer:function(O){var P,G,M,N;for(N=O.split(","),P=~N[0].indexOf("base64")?atob(N[1]):decodeURIComponent(N[1]),G=new Uint8Array(P.length),M=0;M<P.length;M++){G[M]=P.charCodeAt(M)}return G.buffer},arrayBufferToBlob:function(N,G){var L,M=E.BlobBuilder||E.WebKitBlobBuilder;return M?(L=new M,L.append(N),L.getBlob(G)):new Blob([N],G?{type:G}:{})},canvasToDataUrl:function(L,G,K){return L.toDataURL(G,K/100)},parseMeta:function(J,G){G(!1,{})},updateImageHead:function(G){return G}}}),F("runtime/html5/imagemeta",["runtime/html5/util"],function(B){var A;return A={parsers:{65505:[]},maxMetaDataSize:262144,parse:function(K,J){var C=this,L=new FileReader;L.onload=function(){J(!1,C._parse(this.result)),L=L.onload=L.onerror=null},L.onerror=function(G){J(G.message),L=L.onload=L.onerror=null},K=K.slice(0,C.maxMetaDataSize),L.readAsArrayBuffer(K.getSource())},_parse:function(V,U){if(!(V.byteLength<6)){var Y,W,S,T,R=new DataView(V),Z=2,X=R.byteLength-4,Q=Z,C={};if(65496===R.getUint16(0)){for(;X>Z&&(Y=R.getUint16(Z),Y>=65504&&65519>=Y||65534===Y)&&(W=R.getUint16(Z+2)+2,!(Z+W>R.byteLength));){if(S=A.parsers[Y],!U&&S){for(T=0;T<S.length;T+=1){S[T].call(A,R,Z,W,C)}}Z+=W,Q=Z}Q>6&&(C.imageHead=V.slice?V.slice(2,Q):new Uint8Array(V).subarray(2,Q))}return C}},updateImageHead:function(P,L){var M,C,N,O=this._parse(P,!0);return N=2,O.imageHead&&(N=2+O.imageHead.byteLength),C=P.slice?P.slice(N):new Uint8Array(P).subarray(N),M=new Uint8Array(L.byteLength+2+C.byteLength),M[0]=255,M[1]=216,M.set(new Uint8Array(L),2),M.set(new Uint8Array(C),L.byteLength+2),M.buffer}},B.parseMeta=function(){return A.parse.apply(A,arguments)},B.updateImageHead=function(){return A.updateImageHead.apply(A,arguments)},A}),F("runtime/html5/imagemeta/exif",["base","runtime/html5/imagemeta"],function(A,B){var C={};return C.ExifMap=function(){return this},C.ExifMap.prototype.map={Orientation:274},C.ExifMap.prototype.get=function(H){return this[H]||this[this.map[H]]},C.exifTagTypes={1:{getValue:function(I,J){return I.getUint8(J)},size:1},2:{getValue:function(I,J){return String.fromCharCode(I.getUint8(J))},size:1,ascii:!0},3:{getValue:function(L,K,J){return L.getUint16(K,J)},size:2},4:{getValue:function(L,K,J){return L.getUint32(K,J)},size:4},5:{getValue:function(L,K,J){return L.getUint32(K,J)/L.getUint32(K+4,J)},size:8},9:{getValue:function(L,K,J){return L.getInt32(K,J)},size:4},10:{getValue:function(L,K,J){return L.getInt32(K,J)/L.getInt32(K+4,J)},size:8}},C.exifTagTypes[7]=C.exifTagTypes[1],C.getExifValue=function(d,c,a,e,b,f){var T,U,V,W,X,Y,Z=C.exifTagTypes[e];if(!Z){return void A.log("Invalid Exif data: Invalid tag type.")}if(T=Z.size*b,U=T>4?c+d.getUint32(a+8,f):a+8,U+T>d.byteLength){return void A.log("Invalid Exif data: Invalid data offset.")}if(1===b){return Z.getValue(d,U,f)}for(V=[],W=0;b>W;W+=1){V[W]=Z.getValue(d,U+W*Z.size,f)}if(Z.ascii){for(X="",W=0;W<V.length&&(Y=V[W],"\x00"!==Y);W+=1){X+=Y}return X}return V},C.parseExifTag=function(M,R,N,O,Q){var P=M.getUint16(N,O);Q.exif[P]=C.getExifValue(M,R,N,M.getUint16(N+2,O),M.getUint32(N+4,O),O)},C.parseExifTags=function(V,O,R,U,S){var T,P,Q;if(R+6>V.byteLength){return void A.log("Invalid Exif data: Invalid directory offset.")}if(T=V.getUint16(R,U),P=R+2+12*T,P+4>V.byteLength){return void A.log("Invalid Exif data: Invalid directory size.")}for(Q=0;T>Q;Q+=1){this.parseExifTag(V,O,R+2+12*Q,U,S)}return V.getUint32(P,U)},C.parseExifData=function(R,O,P,S){var Q,T,N=O+10;if(1165519206===R.getUint32(O+4)){if(N+8>R.byteLength){return void A.log("Invalid Exif data: Invalid segment size.")}if(0!==R.getUint16(O+8)){return void A.log("Invalid Exif data: Missing byte alignment offset.")}switch(R.getUint16(N)){case 18761:Q=!0;break;case 19789:Q=!1;break;default:return void A.log("Invalid Exif data: Invalid byte alignment marker.")}if(42!==R.getUint16(N+2,Q)){return void A.log("Invalid Exif data: Missing TIFF marker.")}T=R.getUint32(N+4,Q),S.exif=new C.ExifMap,T=C.parseExifTags(R,N,N+T,Q,S)}},B.parsers[65505].push(C.parseExifData),C}),F("runtime/html5/jpegencoder",[],function(){function A(G){function a(Ah){for(var Am=[16,11,10,16,24,40,51,61,12,12,14,19,26,58,60,55,14,13,16,24,40,57,69,56,14,17,22,29,51,87,80,62,18,22,37,56,68,109,103,77,24,35,55,64,81,104,113,92,49,64,78,87,103,121,120,101,72,92,95,98,112,100,103,99],Y=0;64>Y;Y++){var Ag=m((Am[Y]*Ah+50)/100);1>Ag?Ag=1:Ag>255&&(Ag=255),c[e[Y]]=Ag}for(var Al=[17,18,24,47,99,99,99,99,18,21,26,66,99,99,99,99,24,26,56,99,99,99,99,99,47,66,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99,99],Ai=0;64>Ai;Ai++){var Af=m((Al[Ai]*Ah+50)/100);1>Af?Af=1:Af>255&&(Af=255),v[e[Ai]]=Af}for(var Z=[1,1.387039845,1.306562965,1.175875602,1,0.785694958,0.5411961,0.275899379],Ae=0,Aj=0;8>Aj;Aj++){for(var Ak=0;8>Ak;Ak++){l[Ae]=1/(c[e[Ae]]*Z[Aj]*Z[Ak]*8),Ab[Ae]=1/(v[e[Ae]]*Z[Aj]*Z[Ak]*8),Ae++}}}function L(Ai,Z){for(var Ae=0,Y=0,Af=new Array,Ah=1;16>=Ah;Ah++){for(var Ag=1;Ag<=Ai[Ah];Ag++){Af[Z[Y]]=[],Af[Z[Y]][0]=Ae,Af[Z[Y]][1]=Ah,Y++,Ae++}Ae*=2}return Af}function S(){X=L(J,u),t=L(H,Ad),N=L(i,k),y=L(q,z)}function Aa(){for(var Ae=1,Z=2,Y=1;15>=Y;Y++){for(var Af=Ae;Z>Af;Af++){B[32767+Af]=Y,K[32767+Af]=[],K[32767+Af][1]=Y,K[32767+Af][0]=Af}for(var Ag=-(Z-1);-Ae>=Ag;Ag++){B[32767+Ag]=Y,K[32767+Ag]=[],K[32767+Ag][1]=Y,K[32767+Ag][0]=Z-1+Ag}Ae<<=1,Z<<=1}}function n(){for(var Y=0;256>Y;Y++){b[Y]=19595*Y,b[Y+256>>0]=38470*Y,b[Y+512>>0]=7471*Y+32768,b[Y+768>>0]=-11059*Y,b[Y+1024>>0]=-21709*Y,b[Y+1280>>0]=32768*Y+8421375,b[Y+1536>>0]=-27439*Y,b[Y+1792>>0]=-5329*Y}}function h(Z){for(var Ae=Z[0],Y=Z[1]-1;Y>=0;){Ae&1<<Y&&(O|=1<<g),Y--,g--,0>g&&(255==O?(V(255),V(0)):V(O),g=7,O=0)}}function V(Y){M.push(o[Y])}function Ac(Y){V(Y>>8&255),V(255&Y)}function p(AM,Aw){var AQ,BN,AL,Az,At,BQ,AP,As,AJ,Ak=0,AV=8,Ao=64;for(AJ=0;AV>AJ;++AJ){AQ=AM[Ak],BN=AM[Ak+1],AL=AM[Ak+2],Az=AM[Ak+3],At=AM[Ak+4],BQ=AM[Ak+5],AP=AM[Ak+6],As=AM[Ak+7];var Aq=AQ+As,AS=AQ-As,AU=BN+AP,AG=BN-AP,BM=AL+BQ,BP=AL-BQ,Ay=Az+At,Av=Az-At,Ah=Aq+Ay,Ar=Aq-Ay,AO=AU+BM,Ax=AU-BM;AM[Ak]=Ah+AO,AM[Ak+4]=Ah-AO;var Ap=0.707106781*(Ax+Ar);AM[Ak+2]=Ar+Ap,AM[Ak+6]=Ar-Ap,Ah=Av+BP,AO=BP+AG,Ax=AG+AS;var Y=0.382683433*(Ah-Ax),AD=0.5411961*Ah+Y,Al=1.306562965*Ax+Y,AK=0.707106781*AO,Aj=AS+AK,AE=AS-AK;AM[Ak+5]=AE+AD,AM[Ak+3]=AE-AD,AM[Ak+1]=Aj+Al,AM[Ak+7]=Aj-Al,Ak+=8}for(Ak=0,AJ=0;AV>AJ;++AJ){AQ=AM[Ak],BN=AM[Ak+8],AL=AM[Ak+16],Az=AM[Ak+24],At=AM[Ak+32],BQ=AM[Ak+40],AP=AM[Ak+48],As=AM[Ak+56];var AA=AQ+As,Bh=AQ-As,AR=BN+AP,AN=BN-AP,AF=AL+BQ,Ag=AL-BQ,BO=Az+At,A7=Az-At,AH=AA+BO,AC=AA-BO,Au=AR+AF,Z=AR-AF;AM[Ak]=AH+Au,AM[Ak+32]=AH-Au;var AB=0.707106781*(Z+AC);AM[Ak+16]=AC+AB,AM[Ak+48]=AC-AB,AH=A7+Ag,Au=Ag+AN,Z=AN+Bh;var Af=0.382683433*(AH-Z),Ae=0.5411961*AH+Af,Ai=1.306562965*Z+Af,AT=0.707106781*Au,AI=Bh+AT,Am=Bh-AT;AM[Ak+40]=Am+Ae,AM[Ak+24]=Am-Ae,AM[Ak+8]=AI+Ai,AM[Ak+56]=AI-Ai,Ak++}var An;for(AJ=0;Ao>AJ;++AJ){An=AM[AJ]*Aw[AJ],x[AJ]=An>0?An+0.5|0:An-0.5|0}return x}function d(){Ac(65504),Ac(16),V(74),V(70),V(73),V(70),V(0),V(1),V(1),V(0),Ac(1),Ac(1),V(0),V(0)}function I(Y,Z){Ac(65472),Ac(17),V(8),Ac(Z),Ac(Y),V(3),V(1),V(17),V(0),V(2),V(17),V(1),V(3),V(17),V(1)}function f(){Ac(65499),Ac(132),V(0);for(var Y=0;64>Y;Y++){V(c[Y])}V(1);for(var Z=0;64>Z;Z++){V(v[Z])}}function w(){Ac(65476),Ac(418),V(0);for(var Ae=0;16>Ae;Ae++){V(J[Ae+1])}for(var Ah=0;11>=Ah;Ah++){V(u[Ah])}V(16);for(var Z=0;16>Z;Z++){V(i[Z+1])}for(var Af=0;161>=Af;Af++){V(k[Af])}V(1);for(var Ai=0;16>Ai;Ai++){V(H[Ai+1])}for(var Aj=0;11>=Aj;Aj++){V(Ad[Aj])}V(17);for(var Y=0;16>Y;Y++){V(q[Y+1])}for(var Ag=0;161>=Ag;Ag++){V(z[Ag])}}function j(){Ac(65498),Ac(12),V(3),V(1),V(0),V(2),V(17),V(3),V(17),V(0),V(63),V(0)}function P(Ak,Ae,Aj,Ai,Y){for(var Ah,As=Y[0],Ap=Y[240],Ar=16,Ag=63,Z=64,Aq=p(Ak,Ae),Af=0;Z>Af;++Af){W[e[Af]]=Aq[Af]}var Au=W[0]-Aj;Aj=W[0],0==Au?h(Ai[0]):(Ah=32767+Au,h(Ai[B[Ah]]),h(K[Ah]));for(var An=63;An>0&&0==W[An];An--){}if(0==An){return h(As),Aj}for(var Av,At=1;An>=At;){for(var Al=At;0==W[At]&&An>=At;++At){}var Am=At-Al;if(Am>=Ar){Av=Am>>4;for(var Ao=1;Av>=Ao;++Ao){h(Ap)}Am=15&Am}Ah=32767+W[At],h(Y[(Am<<4)+B[Ah]]),h(K[Ah]),At++}return An!=Ag&&h(As),Aj}function R(){for(var Y=String.fromCharCode,Z=0;256>Z;Z++){o[Z]=Y(Z)}}function C(Y){if(0>=Y&&(Y=1),Y>100&&(Y=100),U!=Y){var Z=0;Z=Math.floor(50>Y?5000/Y:200-2*Y),a(Z),U=Y}}function s(){G||(G=50),R(),S(),Aa(),n(),C(G)}var X,t,N,y,U,m=(Math.round,Math.floor),c=new Array(64),v=new Array(64),l=new Array(64),Ab=new Array(64),K=new Array(65535),B=new Array(65535),x=new Array(64),W=new Array(64),M=[],O=0,g=7,Q=new Array(64),T=new Array(64),r=new Array(64),o=new Array(256),b=new Array(2048),e=[0,1,5,6,14,15,27,28,2,4,7,13,16,26,29,42,3,8,12,17,25,30,41,43,9,11,18,24,31,40,44,53,10,19,23,32,39,45,52,54,20,22,33,38,46,51,55,60,21,34,37,47,50,56,59,61,35,36,48,49,57,58,62,63],J=[0,0,1,5,1,1,1,1,1,1,0,0,0,0,0,0,0],u=[0,1,2,3,4,5,6,7,8,9,10,11],i=[0,0,2,1,3,3,2,4,3,5,5,4,4,0,0,1,125],k=[1,2,3,0,4,17,5,18,33,49,65,6,19,81,97,7,34,113,20,50,129,145,161,8,35,66,177,193,21,82,209,240,36,51,98,114,130,9,10,22,23,24,25,26,37,38,39,40,41,42,52,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,225,226,227,228,229,230,231,232,233,234,241,242,243,244,245,246,247,248,249,250],H=[0,0,3,1,1,1,1,1,1,1,1,1,0,0,0,0,0],Ad=[0,1,2,3,4,5,6,7,8,9,10,11],q=[0,0,2,1,2,4,4,3,4,7,5,4,4,0,1,2,119],z=[0,1,2,3,17,4,5,33,49,6,18,65,81,7,97,113,19,34,50,129,8,20,66,145,161,177,193,9,35,51,82,240,21,98,114,209,10,22,36,52,225,37,241,23,24,25,26,38,39,40,41,42,53,54,55,56,57,58,67,68,69,70,71,72,73,74,83,84,85,86,87,88,89,90,99,100,101,102,103,104,105,106,115,116,117,118,119,120,121,122,130,131,132,133,134,135,136,137,138,146,147,148,149,150,151,152,153,154,162,163,164,165,166,167,168,169,170,178,179,180,181,182,183,184,185,186,194,195,196,197,198,199,200,201,202,210,211,212,213,214,215,216,217,218,226,227,228,229,230,231,232,233,234,242,243,244,245,246,247,248,249,250];this.encode=function(Aw,At){At&&C(At),M=new Array,O=0,g=7,Ac(65496),d(),f(),I(Aw.width,Aw.height),w(),j();var Au=0,Am=0,An=0;O=0,g=7,this.encode.displayName="_encode_";for(var Aj,Ap,Ao,Ar,Aq,Ai,Af,Ah,Al,Ae=Aw.data,Z=Aw.width,Av=Aw.height,Y=4*Z,Ak=0;Av>Ak;){for(Aj=0;Y>Aj;){for(Aq=Y*Ak+Aj,Ai=Aq,Af=-1,Ah=0,Al=0;64>Al;Al++){Ah=Al>>3,Af=4*(7&Al),Ai=Aq+Ah*Y+Af,Ak+Ah>=Av&&(Ai-=Y*(Ak+1+Ah-Av)),Aj+Af>=Y&&(Ai-=Aj+Af-Y+4),Ap=Ae[Ai++],Ao=Ae[Ai++],Ar=Ae[Ai++],Q[Al]=(b[Ap]+b[Ao+256>>0]+b[Ar+512>>0]>>16)-128,T[Al]=(b[Ap+768>>0]+b[Ao+1024>>0]+b[Ar+1280>>0]>>16)-128,r[Al]=(b[Ap+1280>>0]+b[Ao+1536>>0]+b[Ar+1792>>0]>>16)-128}Au=P(Q,l,Au,X,N),Am=P(T,Ab,Am,t,y),An=P(r,Ab,An,t,y),Aj+=32}Ak+=8}if(g>=0){var Ag=[];Ag[1]=g+1,Ag[0]=(1<<g+1)-1,h(Ag)}Ac(65497);var As="data:image/jpeg;base64,"+btoa(M.join(""));return M=[],As},s()}return A.encode=function(B,C){var H=new A(C);return H.encode(B)},A}),F("runtime/html5/androidpatch",["runtime/html5/util","runtime/html5/jpegencoder","base"],function(B,A,C){var I,J=B.canvasToDataUrl;B.canvasToDataUrl=function(Q,R,U){var G,S,H,V,T;return C.os.android?("image/jpeg"===R&&"undefined"==typeof I&&(V=J.apply(null,arguments),T=V.split(","),V=~T[0].indexOf("base64")?atob(T[1]):decodeURIComponent(T[1]),V=V.substring(0,2),I=255===V.charCodeAt(0)&&216===V.charCodeAt(1)),"image/jpeg"!==R||I?J.apply(null,arguments):(S=Q.width,H=Q.height,G=Q.getContext("2d"),A.encode(G.getImageData(0,0,S,H),U))):J.apply(null,arguments)}}),F("runtime/html5/image",["base","runtime/html5/runtime","runtime/html5/util"],function(B,H,A){var C="data:image/gif;base64,R0lGODlhAQABAAD/ACwAAAAAAQABAAACADs%3D";return H.register("Image",{modified:!1,init:function(){var J=this,G=new Image;G.onload=function(){J._info={type:J.type,width:this.width,height:this.height},J._metas||"image/jpeg"!==J.type?J.owner.trigger("load"):A.parseMeta(J._blob,function(L,I){J._metas=I,J.owner.trigger("load")})},G.onerror=function(){J.owner.trigger("error")},J._img=G},loadFromBlob:function(L){var K=this,G=K._img;K._blob=L,K.type=L.type,G.src=A.createObjectURL(L.getSource()),K.owner.once("load",function(){A.revokeObjectURL(G.src)})},resize:function(L,G){var K=this._canvas||(this._canvas=document.createElement("canvas"));this._resize(this._img,K,L,G),this._blob=null,this.modified=!0,this.owner.trigger("complete","resize")},crop:function(V,X,U,Y,S){var Z=this._canvas||(this._canvas=document.createElement("canvas")),a=this.options,G=this._img,W=G.naturalWidth,T=G.naturalHeight,b=this.getOrientation();S=S||1,Z.width=U,Z.height=Y,a.preserveHeaders||this._rotate2Orientaion(Z,b),this._renderImageToCanvas(Z,G,-V,-X,W*S,T*S),this._blob=null,this.modified=!0,this.owner.trigger("complete","crop")},getAsBlob:function(G){var N,L=this._blob,M=this.options;if(G=G||this.type,this.modified||this.type!==G){if(N=this._canvas,"image/jpeg"===G){if(L=A.canvasToDataUrl(N,G,M.quality),M.preserveHeaders&&this._metas&&this._metas.imageHead){return L=A.dataURL2ArrayBuffer(L),L=A.updateImageHead(L,this._metas.imageHead),L=A.arrayBufferToBlob(L,G)}}else{L=A.canvasToDataUrl(N,G)}L=A.dataURL2Blob(L)}return L},getAsDataUrl:function(J){var G=this.options;return J=J||this.type,"image/jpeg"===J?A.canvasToDataUrl(this._canvas,J,G.quality):this._canvas.toDataURL(J)},getOrientation:function(){return this._metas&&this._metas.exif&&this._metas.exif.get("Orientation")||1},info:function(G){return G?(this._info=G,this):this._info},meta:function(G){return G?(this._meta=G,this):this._meta},destroy:function(){var G=this._canvas;this._img.onload=null,G&&(G.getContext("2d").clearRect(0,0,G.width,G.height),G.width=G.height=0,this._canvas=null),this._img.src=C,this._img=this._blob=null},_resize:function(d,X,c,e){var U,a,b,G,Y,V=this.options,f=d.width,Z=d.height,W=this.getOrientation();~[5,6,7,8].indexOf(W)&&(c^=e,e^=c,c^=e),U=Math[V.crop?"max":"min"](c/f,e/Z),V.allowMagnify||(U=Math.min(1,U)),a=f*U,b=Z*U,V.crop?(X.width=c,X.height=e):(X.width=a,X.height=b),G=(X.width-a)/2,Y=(X.height-b)/2,V.preserveHeaders||this._rotate2Orientaion(X,W),this._renderImageToCanvas(X,d,G,Y,a,b)},_rotate2Orientaion:function(O,P){var G=O.width,M=O.height,N=O.getContext("2d");switch(P){case 5:case 6:case 7:case 8:O.width=M,O.height=G}switch(P){case 2:N.translate(G,0),N.scale(-1,1);break;case 3:N.translate(G,M),N.rotate(Math.PI);break;case 4:N.translate(0,M),N.scale(1,-1);break;case 5:N.rotate(0.5*Math.PI),N.scale(1,-1);break;case 6:N.rotate(0.5*Math.PI),N.translate(0,-M);break;case 7:N.rotate(0.5*Math.PI),N.translate(G,-M),N.scale(-1,1);break;case 8:N.rotate(-0.5*Math.PI),N.translate(-G,0)}},_renderImageToCanvas:function(){function G(b,V,a){var c,d,Y,Z=document.createElement("canvas"),X=Z.getContext("2d"),U=0,I=a,W=a;for(Z.width=1,Z.height=a,X.drawImage(b,0,0),c=X.getImageData(0,0,1,a).data;W>U;){d=c[4*(W-1)+3],0===d?I=W:U=W,W=I+U>>1}return Y=W/a,0===Y?1:Y}function J(O){var P,Q,R=O.naturalWidth,I=O.naturalHeight;return R*I>1048576?(P=document.createElement("canvas"),P.width=P.height=1,Q=P.getContext("2d"),Q.drawImage(O,-R+1,0),0===Q.getImageData(0,0,1,1).data[3]):!1}return B.os.ios?B.os.ios>=7?function(T,S,W,Z,X,Y){var U=S.naturalWidth,V=S.naturalHeight,I=G(S,U,V);return T.getContext("2d").drawImage(S,0,0,U*I,V*I,W,Z,X,Y)}:function(I,s,t,f,g,k){var l,e,u,a,d,i,j,q=s.naturalWidth,r=s.naturalHeight,m=I.getContext("2d"),n=J(s),v="image/jpeg"===this.type,h=1024,o=0,p=0;for(n&&(q/=2,r/=2),m.save(),l=document.createElement("canvas"),l.width=l.height=h,e=l.getContext("2d"),u=v?G(s,q,r):1,a=Math.ceil(h*g/q),d=Math.ceil(h*k/r/u);r>o;){for(i=0,j=0;q>i;){e.clearRect(0,0,h,h),e.drawImage(s,-i,-o),m.drawImage(l,0,0,h,h,t+j,f+p,a,d),i+=h,j+=a}o+=h,p+=d}m.restore(),l=e=null}:function(I){var M=B.slice(arguments,1),N=I.getContext("2d");N.drawImage.apply(N,M)}}()})}),F("runtime/html5/transport",["base","runtime/html5/runtime"],function(B,H){var A=B.noop,C=B.$;return H.register("Transport",{init:function(){this._status=0,this._response=null},send:function(){var T,U,P,R=this.owner,S=this.options,V=this._initAjax(),G=R._blob,Q=S.server;S.sendAsBinary?(Q+=(/\?/.test(Q)?"&":"?")+C.param(R._formData),U=G.getSource()):(T=new FormData,C.each(R._formData,function(J,I){T.append(J,I)}),T.append(S.fileVal,G.getSource(),S.filename||R._formData.name||"")),S.withCredentials&&"withCredentials" in V?(V.open(S.method,Q,!0),V.withCredentials=!0):V.open(S.method,Q),this._setRequestHeader(V,S.headers),U?(V.overrideMimeType&&V.overrideMimeType("application/octet-stream"),B.os.android?(P=new FileReader,P.onload=function(){V.send(this.result),P=P.onload=null},P.readAsArrayBuffer(U)):V.send(U)):V.send(T)},getResponse:function(){return this._response},getResponseAsJson:function(){return this._parseJson(this._response)},getStatus:function(){return this._status},abort:function(){var G=this._xhr;G&&(G.upload.onprogress=A,G.onreadystatechange=A,G.abort(),this._xhr=G=null)},destroy:function(){this.abort()},_initAjax:function(){var L=this,K=new XMLHttpRequest,G=this.options;return !G.withCredentials||"withCredentials" in K||"undefined"==typeof XDomainRequest||(K=new XDomainRequest),K.upload.onprogress=function(I){var J=0;return I.lengthComputable&&(J=I.loaded/I.total),L.trigger("progress",J)},K.onreadystatechange=function(){return 4===K.readyState?(K.upload.onprogress=A,K.onreadystatechange=A,L._xhr=null,L._status=K.status,K.status>=200&&K.status<300?(L._response=K.responseText,L.trigger("load")):K.status>=500&&K.status<600?(L._response=K.responseText,L.trigger("error","server")):L.trigger("error",L._status?"http":"abort")):void 0},L._xhr=K,K},_setRequestHeader:function(J,G){C.each(G,function(L,I){J.setRequestHeader(L,I)})},_parseJson:function(L){var G;try{G=JSON.parse(L)}catch(K){G={}}return G}})}),F("runtime/html5/md5",["runtime/html5/runtime"],function(C){var a=function(G,H){return G+H&4294967295},b=function(K,J,I,H,G,L){return J=a(a(J,K),a(H,L)),a(J<<G|J>>>32-G,I)},B=function(I,L,J,K,M,H,G){return b(L&J|~L&K,I,L,M,H,G)},V=function(I,L,J,K,M,H,G){return b(L&K|J&~K,I,L,M,H,G)},U=function(I,L,J,K,M,H,G){return b(L^J^K,I,L,M,H,G)},A=function(I,L,J,K,M,H,G){return b(J^(L|~K),I,L,M,H,G)},Y=function(K,J){var L=K[0],I=K[1],H=K[2],G=K[3];L=B(L,I,H,G,J[0],7,-680876936),G=B(G,L,I,H,J[1],12,-389564586),H=B(H,G,L,I,J[2],17,606105819),I=B(I,H,G,L,J[3],22,-1044525330),L=B(L,I,H,G,J[4],7,-176418897),G=B(G,L,I,H,J[5],12,1200080426),H=B(H,G,L,I,J[6],17,-1473231341),I=B(I,H,G,L,J[7],22,-45705983),L=B(L,I,H,G,J[8],7,1770035416),G=B(G,L,I,H,J[9],12,-1958414417),H=B(H,G,L,I,J[10],17,-42063),I=B(I,H,G,L,J[11],22,-1990404162),L=B(L,I,H,G,J[12],7,1804603682),G=B(G,L,I,H,J[13],12,-40341101),H=B(H,G,L,I,J[14],17,-1502002290),I=B(I,H,G,L,J[15],22,1236535329),L=V(L,I,H,G,J[1],5,-165796510),G=V(G,L,I,H,J[6],9,-1069501632),H=V(H,G,L,I,J[11],14,643717713),I=V(I,H,G,L,J[0],20,-373897302),L=V(L,I,H,G,J[5],5,-701558691),G=V(G,L,I,H,J[10],9,38016083),H=V(H,G,L,I,J[15],14,-660478335),I=V(I,H,G,L,J[4],20,-405537848),L=V(L,I,H,G,J[9],5,568446438),G=V(G,L,I,H,J[14],9,-1019803690),H=V(H,G,L,I,J[3],14,-187363961),I=V(I,H,G,L,J[8],20,1163531501),L=V(L,I,H,G,J[13],5,-1444681467),G=V(G,L,I,H,J[2],9,-51403784),H=V(H,G,L,I,J[7],14,1735328473),I=V(I,H,G,L,J[12],20,-1926607734),L=U(L,I,H,G,J[5],4,-378558),G=U(G,L,I,H,J[8],11,-2022574463),H=U(H,G,L,I,J[11],16,1839030562),I=U(I,H,G,L,J[14],23,-35309556),L=U(L,I,H,G,J[1],4,-1530992060),G=U(G,L,I,H,J[4],11,1272893353),H=U(H,G,L,I,J[7],16,-155497632),I=U(I,H,G,L,J[10],23,-1094730640),L=U(L,I,H,G,J[13],4,681279174),G=U(G,L,I,H,J[0],11,-358537222),H=U(H,G,L,I,J[3],16,-722521979),I=U(I,H,G,L,J[6],23,76029189),L=U(L,I,H,G,J[9],4,-640364487),G=U(G,L,I,H,J[12],11,-421815835),H=U(H,G,L,I,J[15],16,530742520),I=U(I,H,G,L,J[2],23,-995338651),L=A(L,I,H,G,J[0],6,-198630844),G=A(G,L,I,H,J[7],10,1126891415),H=A(H,G,L,I,J[14],15,-1416354905),I=A(I,H,G,L,J[5],21,-57434055),L=A(L,I,H,G,J[12],6,1700485571),G=A(G,L,I,H,J[3],10,-1894986606),H=A(H,G,L,I,J[10],15,-1051523),I=A(I,H,G,L,J[1],21,-2054922799),L=A(L,I,H,G,J[8],6,1873313359),G=A(G,L,I,H,J[15],10,-30611744),H=A(H,G,L,I,J[6],15,-1560198380),I=A(I,H,G,L,J[13],21,1309151649),L=A(L,I,H,G,J[4],6,-145523070),G=A(G,L,I,H,J[11],10,-1120210379),H=A(H,G,L,I,J[2],15,718787259),I=A(I,H,G,L,J[9],21,-343485551),K[0]=a(L,K[0]),K[1]=a(I,K[1]),K[2]=a(H,K[2]),K[3]=a(G,K[3])},Z=function(H){var I,G=[];for(I=0;64>I;I+=4){G[I>>2]=H.charCodeAt(I)+(H.charCodeAt(I+1)<<8)+(H.charCodeAt(I+2)<<16)+(H.charCodeAt(I+3)<<24)}return G},e=function(H){var I,G=[];for(I=0;64>I;I+=4){G[I>>2]=H[I]+(H[I+1]<<8)+(H[I+2]<<16)+(H[I+3]<<24)}return G},f=function(G){var H,I,L,O,J,K,M=G.length,N=[1732584193,-271733879,-1732584194,271733878];for(H=64;M>=H;H+=64){Y(N,Z(G.substring(H-64,H)))}for(G=G.substring(H-64),I=G.length,L=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],H=0;I>H;H+=1){L[H>>2]|=G.charCodeAt(H)<<(H%4<<3)}if(L[H>>2]|=128<<(H%4<<3),H>55){for(Y(N,L),H=0;16>H;H+=1){L[H]=0}}return O=8*M,O=O.toString(16).match(/(.*?)(.{0,8})$/),J=parseInt(O[2],16),K=parseInt(O[1],16)||0,L[14]=J,L[15]=K,Y(N,L),N},c=function(G){var J,I,L,O,K,H,N=G.length,M=[1732584193,-271733879,-1732584194,271733878];for(J=64;N>=J;J+=64){Y(M,e(G.subarray(J-64,J)))}for(G=N>J-64?G.subarray(J-64):new Uint8Array(0),I=G.length,L=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],J=0;I>J;J+=1){L[J>>2]|=G[J]<<(J%4<<3)}if(L[J>>2]|=128<<(J%4<<3),J>55){for(Y(M,L),J=0;16>J;J+=1){L[J]=0}}return O=8*N,O=O.toString(16).match(/(.*?)(.{0,8})$/),K=parseInt(O[2],16),H=parseInt(O[1],16)||0,L[14]=K,L[15]=H,Y(M,L),M},d=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f"],W=function(H){var I,G="";for(I=0;4>I;I+=1){G+=d[H>>8*I+4&15]+d[H>>8*I&15]}return G},X=function(G){var H;for(H=0;H<G.length;H+=1){G[H]=W(G[H])}return G.join("")},g=function(G){return X(f(G))},h=function(){this.reset()};return"5d41402abc4b2a76b9719d911017c592"!==g("hello")&&(a=function(I,H){var G=(65535&I)+(65535&H),J=(I>>16)+(H>>16)+(G>>16);return J<<16|65535&G}),h.prototype.append=function(G){return/[\u0080-\uFFFF]/.test(G)&&(G=unescape(encodeURIComponent(G))),this.appendBinary(G),this},h.prototype.appendBinary=function(H){this._buff+=H,this._length+=H.length;var I,G=this._buff.length;for(I=64;G>=I;I+=64){Y(this._state,Z(this._buff.substring(I-64,I)))}return this._buff=this._buff.substr(I-64),this},h.prototype.end=function(K){var J,I,L=this._buff,H=L.length,G=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(J=0;H>J;J+=1){G[J>>2]|=L.charCodeAt(J)<<(J%4<<3)}return this._finish(G,H),I=K?this._state:X(this._state),this.reset(),I},h.prototype._finish=function(K,J){var I,L,H,G=J;if(K[G>>2]|=128<<(G%4<<3),G>55){for(Y(this._state,K),G=0;16>G;G+=1){K[G]=0}}I=8*this._length,I=I.toString(16).match(/(.*?)(.{0,8})$/),L=parseInt(I[2],16),H=parseInt(I[1],16)||0,K[14]=L,K[15]=H,Y(this._state,K)},h.prototype.reset=function(){return this._buff="",this._length=0,this._state=[1732584193,-271733879,-1732584194,271733878],this},h.prototype.destroy=function(){delete this._state,delete this._buff,delete this._length},h.hash=function(H,I){/[\u0080-\uFFFF]/.test(H)&&(H=unescape(encodeURIComponent(H)));var G=f(H);return I?G:X(G)},h.hashBinary=function(H,I){var G=f(H);return I?G:X(G)},h.ArrayBuffer=function(){this.reset()},h.ArrayBuffer.prototype.append=function(I){var H,G=this._concatArrayBuffer(this._buff,I),J=G.length;for(this._length+=I.byteLength,H=64;J>=H;H+=64){Y(this._state,e(G.subarray(H-64,H)))}return this._buff=J>H-64?G.subarray(H-64):new Uint8Array(0),this},h.ArrayBuffer.prototype.end=function(K){var J,I,L=this._buff,H=L.length,G=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0];for(J=0;H>J;J+=1){G[J>>2]|=L[J]<<(J%4<<3)}return this._finish(G,H),I=K?this._state:X(this._state),this.reset(),I},h.ArrayBuffer.prototype._finish=h.prototype._finish,h.ArrayBuffer.prototype.reset=function(){return this._buff=new Uint8Array(0),this._length=0,this._state=[1732584193,-271733879,-1732584194,271733878],this},h.ArrayBuffer.prototype.destroy=h.prototype.destroy,h.ArrayBuffer.prototype._concatArrayBuffer=function(I,H){var G=I.length,J=new Uint8Array(G+H.byteLength);return J.set(I),J.set(new Uint8Array(H),G),J},h.ArrayBuffer.hash=function(H,I){var G=c(new Uint8Array(H));return I?G:X(G)},C.register("Md5",{init:function(){},loadFromBlob:function(N){var H,M,G=N.getSource(),Q=2097152,K=Math.ceil(G.size/Q),L=0,I=this.owner,J=new h.ArrayBuffer,O=this,P=G.mozSlice||G.webkitSlice||G.slice;M=new FileReader,(H=function(){var S,R;S=L*Q,R=Math.min(S+Q,G.size),M.onload=function(T){J.append(T.target.result),I.trigger("progress",{total:N.size,loaded:R})},M.onloadend=function(){M.onloadend=M.onload=null,++L<K?setTimeout(H,1):setTimeout(function(){I.trigger("load"),O.result=J.end(),H=N=G=J=null,I.trigger("complete")},50)},M.readAsArrayBuffer(P.call(G,S,R))})()},getResult:function(){return this.result}})}),F("runtime/flash/runtime",["base","runtime/runtime","runtime/compbase"],function(M,B,A){function N(){var G;try{G=navigator.plugins["Shockwave Flash"],G=G.description}catch(H){try{G=new ActiveXObject("ShockwaveFlash.ShockwaveFlash").GetVariable("$version")}catch(I){G="0.0"}}return G=G.match(/\d+/g),parseFloat(G[0]+"."+G[1],10)}function C(){function R(X,Y){var Z,Q,W=X.type||X;Z=W.split("::"),Q=Z[0],W=Z[1],"Ready"===W&&Q===H.uid?H.trigger("ready"):K[Q]&&K[Q].trigger(W.toLowerCase(),X,Y)}var I={},K={},J=this.destroy,H=this,G=M.guid("webuploader_");B.apply(H,arguments),H.type=O,H.exec=function(Y,b){var X,Q=this,a=Q.uid,Z=M.slice(arguments,2);return K[a]=Q,L[Y]&&(I[a]||(I[a]=new L[Y](Q,H)),X=I[a],X[b])?X[b].apply(X,Z):H.flashExec.apply(Q,arguments)},E[G]=function(){var Q=arguments;setTimeout(function(){R.apply(null,Q)},1)},this.jsreciver=G,this.destroy=function(){return J&&J.apply(this,arguments)},this.flashExec=function(X,W){var Q=H.getFlash(),V=M.slice(arguments,2);return Q.exec(this.uid,X,W,V)}}var P=M.$,O="flash",L={};return M.inherits(B,{constructor:C,init:function(){var G,I=this.getContainer(),H=this.options;I.css({position:"absolute",top:"-8px",left:"-8px",width:"9px",height:"9px",overflow:"hidden"}),G='<object id="'+this.uid+'" type="application/x-shockwave-flash" data="'+H.swf+'" ',M.browser.ie&&(G+='classid="clsid:d27cdb6e-ae6d-11cf-96b8-444553540000" '),G+='width="100%" height="100%" style="outline:0"><param name="movie" value="'+H.swf+'" /><param name="flashvars" value="uid='+this.uid+"&jsreciver="+this.jsreciver+'" /><param name="wmode" value="transparent" /><param name="allowscriptaccess" value="always" /></object>',I.html(G)},getFlash:function(){return this._flash?this._flash:(this._flash=P("#"+this.uid).get(0),this._flash)}}),C.register=function(H,G){return G=L[H]=M.inherits(A,P.extend({flashExec:function(){var J=this.owner,I=this.getRuntime();return I.flashExec.apply(J,arguments)}},G))},N()>=11.4&&B.addRuntime(O,C),C}),F("runtime/flash/filepicker",["base","runtime/flash/runtime"],function(A,B){var C=A.$;return B.register("FilePicker",{init:function(N){var M,L,K=C.extend({},N);for(M=K.accept&&K.accept.length,L=0;M>L;L++){K.accept[L].title||(K.accept[L].title="Files")}delete K.button,delete K.id,delete K.container,this.flashExec("FilePicker","init",K)},destroy:function(){this.flashExec("FilePicker","destroy")}})}),F("runtime/flash/image",["runtime/flash/runtime"],function(A){return A.register("Image",{loadFromBlob:function(B){var C=this.owner;C.info()&&this.flashExec("Image","info",C.info()),C.meta()&&this.flashExec("Image","meta",C.meta()),this.flashExec("Image","loadFromBlob",B.uid)}})}),F("runtime/flash/transport",["base","runtime/flash/runtime","runtime/client"],function(A,B,C){var H=A.$;return B.register("Transport",{init:function(){this._status=0,this._response=null,this._responseJson=null},send:function(){var P,R=this.owner,G=this.options,O=this._initAjax(),Q=R._blob,N=G.server;O.connectRuntime(Q.ruid),G.sendAsBinary?(N+=(/\?/.test(N)?"&":"?")+H.param(R._formData),P=Q.uid):(H.each(R._formData,function(J,I){O.exec("append",J,I)}),O.exec("appendBlob",G.fileVal,Q.uid,G.filename||R._formData.name||"")),this._setRequestHeader(O,G.headers),O.exec("send",{method:G.method,url:N,forceURLStream:G.forceURLStream,mimeType:"application/octet-stream"},P)},getStatus:function(){return this._status},getResponse:function(){return this._response||""},getResponseAsJson:function(){return this._responseJson},abort:function(){var G=this._xhr;G&&(G.exec("abort"),G.destroy(),this._xhr=G=null)},destroy:function(){this.abort()},_initAjax:function(){var G=this,J=new C("XMLHttpRequest");return J.on("uploadprogress progress",function(I){var L=I.loaded/I.total;return L=Math.min(1,Math.max(0,L)),G.trigger("progress",L)}),J.on("load",function(){var I,N=J.exec("getStatus"),O=!1,P="";return J.off(),G._xhr=null,N>=200&&300>N?O=!0:N>=500&&600>N?(O=!0,P="server"):P="http",O&&(G._response=J.exec("getResponse"),G._response=decodeURIComponent(G._response),I=E.JSON&&E.JSON.parse||function(L){try{return new Function("return "+L).call()}catch(K){return{}}},G._responseJson=G._response?I(G._response):{}),J.destroy(),J=null,P?G.trigger("error",P):G.trigger("load")}),J.on("error",function(){J.off(),G._xhr=null,G.trigger("error","http")}),G._xhr=J,J},_setRequestHeader:function(J,G){H.each(G,function(L,I){J.exec("setRequestHeader",L,I)})}})}),F("runtime/flash/blob",["runtime/flash/runtime","lib/blob"],function(B,A){return B.register("Blob",{slice:function(I,J){var C=this.flashExec("Blob","slice",I,J);return new A(C.uid,C)}})}),F("runtime/flash/md5",["runtime/flash/runtime"],function(A){return A.register("Md5",{init:function(){},loadFromBlob:function(B){return this.flashExec("Md5","loadFromBlob",B.uid)}})}),F("preset/all",["base","widgets/filednd","widgets/filepaste","widgets/filepicker","widgets/image","widgets/queue","widgets/runtime","widgets/upload","widgets/validator","widgets/md5","runtime/html5/blob","runtime/html5/dnd","runtime/html5/filepaste","runtime/html5/filepicker","runtime/html5/imagemeta/exif","runtime/html5/androidpatch","runtime/html5/image","runtime/html5/transport","runtime/html5/md5","runtime/flash/filepicker","runtime/flash/image","runtime/flash/transport","runtime/flash/blob","runtime/flash/md5"],function(A){return A}),F("widgets/log",["base","uploader","widgets/widget"],function(B,L){function M(H){var J=N.extend({},A,H),G=C.replace(/^(.*)\?/,"$1"+N.param(J)),I=new Image;I.src=G}var A,N=B.$,C=" http://static.tieba.baidu.com/tb/pms/img/st.gif??",P=(location.hostname||location.host||"protected").toLowerCase(),O=P&&/baidu/i.exec(P);if(O){return A={dv:3,master:"webuploader",online:/test/.exec(P)?0:1,module:"",product:P,type:0},L.register({name:"log",init:function(){var G=this.owner,I=0,H=0;G.on("error",function(J){M({type:2,c_error_code:J})}).on("uploadError",function(K,J){M({type:2,c_error_code:"UPLOAD_ERROR",c_reason:""+J})}).on("uploadComplete",function(J){I++,H+=J.size}).on("uploadFinished",function(){M({c_count:I,c_size:H}),I=H=0}),M({c_usage:1})}})}}),F("webuploader",["preset/all","widgets/log"],function(A){return A}),D("webuploader")});