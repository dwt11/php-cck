!function(B){"function"==typeof define&&define.amd?define(["jquery","codemirror"],B):B(window.jQuery,window.CodeMirror)}(function(W,Y){"function"!=typeof Array.prototype.reduce&&(Array.prototype.reduce=function(A,F){var C,E,D=this.length>>>0,B=!1;for(1<arguments.length&&(E=F,B=!0),C=0;D>C;++C){this.hasOwnProperty(C)&&(B?E=A(E,this[C],C,this):(E=this[C],B=!0))}if(!B){throw new TypeError("Reduce of empty array with no initial value")}return E});var Z={bMac:navigator.appVersion.indexOf("Mac")>-1,bMSIE:navigator.userAgent.indexOf("MSIE")>-1||navigator.userAgent.indexOf("Trident")>-1,bFF:navigator.userAgent.indexOf("Firefox")>-1,jqueryVersion:parseFloat(W.fn.jquery),bCodeMirror:!!Y},c=function(){var A=function(G){return function(H){return G===H}},F=function(G,H){return G===H},C=function(){return !0},E=function(){return !1},D=function(G){return function(){return !G.apply(G,arguments)}},B=function(G){return G};return{eq:A,eq2:F,ok:C,fail:E,not:D,self:B}}(),a=function(){var E=function(K){return K[0]},G=function(K){return K[K.length-1]},H=function(K){return K.slice(0,K.length-1)},I=function(K){return K.slice(1)},F=function(K,L){var M=K.indexOf(L);return -1===M?null:K[M+1]},A=function(K,L){var M=K.indexOf(L);return -1===M?null:K[M-1]},B=function(K,L){return L=L||c.self,K.reduce(function(N,M){return N+L(M)},0)},J=function(K){for(var N=[],L=-1,M=K.length;++L<M;){N[L]=K[L]}return N},C=function(L,M){if(0===L.length){return[]}var K=I(L);return K.reduce(function(N,O){var P=G(N);return M(G(P),O)?P[P.length]=O:N[N.length]=[O],N},[[E(L)]])},D=function(K){for(var N=[],L=0,M=K.length;M>L;L++){K[L]&&N.push(K[L])}return N};return{head:E,last:G,initial:H,tail:I,prev:A,next:F,sum:B,from:J,compact:D,clusterBy:C}}(),X=function(){var V=function(v){return v&&W(v).hasClass("note-editable")},T=function(v){return v&&W(v).hasClass("note-control-sizing")},P=function(v){var w=function(x){return function(){return v.find(x)}};return{editor:function(){return v},dropzone:w(".note-dropzone"),toolbar:w(".note-toolbar"),editable:w(".note-editable"),codable:w(".note-codable"),statusbar:w(".note-statusbar"),popover:w(".note-popover"),handle:w(".note-handle"),dialog:w(".note-dialog")}},u=function(v){return function(w){return w&&w.nodeName===v}},M=function(v){return v&&/^DIV|^P|^LI|^H[1-7]/.test(v.nodeName)},K=function(v){return v&&/^UL|^OL/.test(v.nodeName)},s=function(v){return v&&/^TD|^TH/.test(v.nodeName)},I=function(v,w){for(;v;){if(w(v)){return v}if(V(v)){break}v=v.parentNode}return null},Q=function(w,v){v=v||c.fail;var x=[];return I(w,function(y){return x.push(y),v(y)}),x},S=function(w,y){for(var v=Q(w),x=y;x;x=x.parentNode){if(W.inArray(x,v)>-1){return x}}return null},H=function(Aa,w){var z=[],v=!1,x=!1;return function y(Ad){if(Ad){if(Ad===Aa&&(v=!0),v&&!x&&z.push(Ad),Ad===w){return void (x=!0)}for(var Ac=0,Ab=Ad.childNodes.length;Ab>Ac;Ac++){y(Ad.childNodes[Ac])}}}(S(Aa,w)),z},E=function(w,v){v=v||c.fail;for(var x=[];w&&(x.push(w),!v(w));){w=w.previousSibling}return x},B=function(w,v){v=v||c.fail;for(var x=[];w&&(x.push(w),!v(w));){w=w.nextSibling}return x},G=function(y,v){var w=[];return v=v||c.ok,function x(Ab){y!==Ab&&v(Ab)&&w.push(Ab);for(var z=0,Aa=Ab.childNodes.length;Aa>z;z++){x(Ab.childNodes[z])}}(y),w},N=function(y,v){var w=v.nextSibling,x=v.parentNode;return w?x.insertBefore(y,w):x.appendChild(y),y},O=function(v,w){return W.each(w,function(x,y){v.appendChild(y)}),v},L=u("#text"),A=function(v){return L(v)?v.nodeValue.length:v.childNodes.length},R=function(v){for(var w=0;v=v.previousSibling;){w+=1}return w},F=function(v,w){var x=a.initial(Q(w,c.eq(v)));return W.map(x,R).reverse()},U=function(z,w){for(var y=z,v=0,x=w.length;x>v;v++){y=y.childNodes[w[v]]}return y},D=function(w,v){if(0===v){return w}if(v>=A(w)){return w.nextSibling}if(L(w)){return w.splitText(v)}var x=w.childNodes[v];return w=N(w.cloneNode(!1),w),O(w,B(x))},t=function(y,v,w){var x=Q(v,c.eq(y));return 1===x.length?D(v,w):x.reduce(function(z,Aa){var Ab=Aa.cloneNode(!1);return N(Ab,Aa),z===v&&(z=D(z,w)),O(Ab,B(z)),Ab})},J=function(Aa,w){if(Aa&&Aa.parentNode){if(Aa.removeNode){return Aa.removeNode(w)}var z=Aa.parentNode;if(!w){var v,x,y=[];for(v=0,x=Aa.childNodes.length;x>v;v++){y.push(Aa.childNodes[v])}for(v=0,x=y.length;x>v;v++){z.insertBefore(y[v],Aa)}}z.removeChild(Aa)}},C=function(v){return X.isTextarea(v[0])?v.val():v.html()};return{blank:Z.bMSIE?"&nbsp;":"<br/>",emptyPara:"<p><br/></p>",isEditable:V,isControlSizing:T,buildLayoutInfo:P,isText:L,isPara:M,isList:K,isTable:u("TABLE"),isCell:s,isAnchor:u("A"),isDiv:u("DIV"),isLi:u("LI"),isSpan:u("SPAN"),isB:u("B"),isU:u("U"),isS:u("S"),isI:u("I"),isImg:u("IMG"),isTextarea:u("TEXTAREA"),ancestor:I,listAncestor:Q,listNext:B,listPrev:E,listDescendant:G,commonAncestor:S,listBetween:H,insertAfter:N,position:R,makeOffsetPath:F,fromOffsetPath:U,split:t,remove:J,html:C}}(),b={version:"0.5.2",options:{width:null,height:null,focus:!1,tabsize:4,styleWithSpan:!0,disableLinkTarget:!1,disableDragAndDrop:!1,codemirror:null,lang:"en-US",direction:null,toolbar:[["style",["style"]],["font",["bold","italic","underline","clear"]],["fontname",["fontname"]],["color",["color"]],["para",["ul","ol","paragraph"]],["height",["height"]],["table",["table"]],["insert",["link","picture","video"]],["view",["fullscreen","codeview"]],["help",["help"]]],oninit:null,onfocus:null,onblur:null,onenter:null,onkeyup:null,onkeydown:null,onImageUpload:null,onImageUploadError:null,onToolbarClick:null,keyMap:{pc:{"CTRL+Z":"undo","CTRL+Y":"redo",TAB:"tab","SHIFT+TAB":"untab","CTRL+B":"bold","CTRL+I":"italic","CTRL+U":"underline","CTRL+SHIFT+S":"strikethrough","CTRL+BACKSLASH":"removeFormat","CTRL+SHIFT+L":"justifyLeft","CTRL+SHIFT+E":"justifyCenter","CTRL+SHIFT+R":"justifyRight","CTRL+SHIFT+J":"justifyFull","CTRL+SHIFT+NUM7":"insertUnorderedList","CTRL+SHIFT+NUM8":"insertOrderedList","CTRL+LEFTBRACKET":"outdent","CTRL+RIGHTBRACKET":"indent","CTRL+NUM0":"formatPara","CTRL+NUM1":"formatH1","CTRL+NUM2":"formatH2","CTRL+NUM3":"formatH3","CTRL+NUM4":"formatH4","CTRL+NUM5":"formatH5","CTRL+NUM6":"formatH6","CTRL+ENTER":"insertHorizontalRule"},mac:{"CMD+Z":"undo","CMD+SHIFT+Z":"redo",TAB:"tab","SHIFT+TAB":"untab","CMD+B":"bold","CMD+I":"italic","CMD+U":"underline","CMD+SHIFT+S":"strikethrough","CMD+BACKSLASH":"removeFormat","CMD+SHIFT+L":"justifyLeft","CMD+SHIFT+E":"justifyCenter","CMD+SHIFT+R":"justifyRight","CMD+SHIFT+J":"justifyFull","CMD+SHIFT+NUM7":"insertUnorderedList","CMD+SHIFT+NUM8":"insertOrderedList","CMD+LEFTBRACKET":"outdent","CMD+RIGHTBRACKET":"indent","CMD+NUM0":"formatPara","CMD+NUM1":"formatH1","CMD+NUM2":"formatH2","CMD+NUM3":"formatH3","CMD+NUM4":"formatH4","CMD+NUM5":"formatH5","CMD+NUM6":"formatH6","CMD+ENTER":"insertHorizontalRule"}}},lang:{"en-US":{font:{bold:"Bold",italic:"Italic",underline:"Underline",strike:"Strike",clear:"Remove Font Style",height:"Line Height",name:"Font Family",size:"Font Size"},image:{image:"Picture",insert:"Insert Image",resizeFull:"Resize Full",resizeHalf:"Resize Half",resizeQuarter:"Resize Quarter",floatLeft:"Float Left",floatRight:"Float Right",floatNone:"Float None",dragImageHere:"Drag an image here",selectFromFiles:"SELECT from files",url:"Image URL",remove:"Remove Image"},link:{link:"Link",insert:"Insert Link",unlink:"Unlink",edit:"Edit",textToDisplay:"Text to display",url:"To what URL should this link go?",openInNewWindow:"Open in new window"},video:{video:"Video",videoLink:"Video Link",insert:"Insert Video",url:"Video URL?",providers:"(YouTube, Vimeo, Vine, Instagram, or DailyMotion)"},table:{table:"Table"},hr:{insert:"Insert Horizontal Rule"},style:{style:"Style",normal:"Normal",blockquote:"Quote",pre:"Code",h1:"Header 1",h2:"Header 2",h3:"Header 3",h4:"Header 4",h5:"Header 5",h6:"Header 6"},lists:{unordered:"Unordered list",ordered:"Ordered list"},options:{help:"Help",fullscreen:"Full Screen",codeview:"Code View"},paragraph:{paragraph:"Paragraph",outdent:"Outdent",indent:"Indent",left:"Align left",center:"Align center",right:"Align right",justify:"Justify full"},color:{recent:"Recent Color",more:"More Color",background:"BackColor",foreground:"FontColor",transparent:"Transparent",setTransparent:"Set transparent",reset:"Reset",resetToDefault:"Reset to default"},shortcut:{shortcuts:"Keyboard shortcuts",close:"Close",textFormatting:"Text formatting",action:"Action",paragraphFormatting:"Paragraph formatting",documentStyle:"Document Style"},history:{undo:"Undo",redo:"Redo"}}}},d=function(){var B=function(C){return W.Deferred(function(D){W.extend(new FileReader,{onload:function(E){var F=E.target.result;D.resolve(F)},onerror:function(){D.reject(this)}}).readAsDataURL(C)}).promise()},A=function(C){return W.Deferred(function(D){W("<img>").one("load",function(){D.resolve(W(this))}).one("error abort",function(){D.reject(W(this))}).css({display:"none"}).appendTo(document.body).attr("src",C)}).promise()};return{readFileAsDataURL:B,createImage:A}}(),e={isEdit:function(A){return -1!==[8,9,13,32].indexOf(A)},nameFromCode:{8:"BACKSPACE",9:"TAB",13:"ENTER",32:"SPACE",48:"NUM0",49:"NUM1",50:"NUM2",51:"NUM3",52:"NUM4",53:"NUM5",54:"NUM6",55:"NUM7",56:"NUM8",66:"B",69:"E",73:"I",74:"J",75:"K",76:"L",82:"R",83:"S",85:"U",89:"Y",90:"Z",191:"SLASH",219:"LEFTBRACKET",220:"BACKSLASH",221:"RIGHTBRACKET"}},f=function(){var A=function(B,C){if(Z.jqueryVersion<1.9){var D={};return W.each(C,function(E,F){D[F]=B.css(F)}),D}return B.css.call(B,C)};this.stylePara=function(B,C){W.each(B.nodes(X.isPara),function(E,D){W(D).css(C)})},this.current=function(G,F){var C=W(X.isText(G.sc)?G.sc.parentNode:G.sc),E=["font-family","font-size","text-align","list-style-type","line-height"],I=A(C,E)||{};if(I["font-size"]=parseInt(I["font-size"],10),I["font-bold"]=document.queryCommandState("bold")?"bold":"normal",I["font-italic"]=document.queryCommandState("italic")?"italic":"normal",I["font-underline"]=document.queryCommandState("underline")?"underline":"normal",I["font-strikethrough"]=document.queryCommandState("strikeThrough")?"strikethrough":"normal",G.isOnList()){var H=["circle","disc","disc-leading-zero","square"],D=W.inArray(I["list-style-type"],H)>-1;I["list-style"]=D?"unordered":"ordered"}else{I["list-style"]="none"}var B=X.ancestor(G.sc,X.isPara);if(B&&B.style["line-height"]){I["line-height"]=B.style.lineHeight}else{var J=parseInt(I["line-height"],10)/parseInt(I["font-size"],10);I["line-height"]=J.toFixed(1)}return I.image=X.isImg(F)&&F,I.anchor=G.isOnAnchor()&&X.ancestor(G.sc,X.isAnchor),I.aAncestor=X.listAncestor(G.sc,X.isEditable),I}},g=function(){var D=!!document.createRange,A=function(J,E){var F,I,K=J.parentElement(),M=document.body.createTextRange(),N=a.from(K.childNodes);for(F=0;F<N.length;F++){if(!X.isText(N[F])){if(M.moveToElementText(N[F]),M.compareEndPoints("StartToStart",J)>=0){break}I=N[F]}}if(0!==F&&X.isText(N[F-1])){var L=document.body.createTextRange(),O=null;L.moveToElementText(I||K),L.collapse(!I),O=I?I.nextSibling:K.firstChild;var G=J.duplicate();G.setEndPoint("StartToStart",L);for(var H=G.text.replace(/[\r\n]/g,"").length;H>O.nodeValue.length&&O.nextSibling;){H-=O.nodeValue.length,O=O.nextSibling}O.nodeValue;E&&O.nextSibling&&X.isText(O.nextSibling)&&H===O.nodeValue.length&&(H-=O.nodeValue.length,O=O.nextSibling),K=O,F=H}return{cont:K,offset:F}},C=function(E){var G=function(I,L){var M,N;if(X.isText(I)){var K=X.listPrev(I,c.not(X.isText)),J=a.last(K).previousSibling;M=J||I.parentNode,L+=a.sum(a.tail(K),X.length),N=!J}else{if(M=I.childNodes[L]||I,X.isText(M)){return G(M,L)}L=0,N=!1}return{cont:M,collapseToStart:N,offset:L}},H=document.body.createTextRange(),F=G(E.cont,E.offset);return H.moveToElementText(F.cont),H.collapse(F.collapseToStart),H.moveStart("character",F.offset),H},B=function(G,I,H,J){this.sc=G,this.so=I,this.ec=H,this.eo=J;var E=function(){if(D){var K=document.createRange();return K.setStart(G,I),K.setEnd(H,J),K}var L=C({cont:G,offset:I});return L.setEndPoint("EndToEnd",C({cont:H,offset:J})),L};this.select=function(){var L=E();if(D){var K=document.getSelection();K.rangeCount>0&&K.removeAllRanges(),K.addRange(L)}else{L.select()}},this.nodes=function(M){var L=X.listBetween(G,H),K=a.compact(W.map(L,function(N){return X.ancestor(N,M)}));return W.map(a.clusterBy(K,c.eq2),a.head)},this.commonAncestor=function(){return X.commonAncestor(G,H)};var F=function(K){return function(){var L=X.ancestor(G,K);return !!L&&L===X.ancestor(H,K)}};this.isOnEditable=F(X.isEditable),this.isOnList=F(X.isList),this.isOnAnchor=F(X.isAnchor),this.isOnCell=F(X.isCell),this.isCollapsed=function(){return G===H&&I===J},this.insertNode=function(L){var K=E();D?K.insertNode(L):K.pasteHTML(L.outerHTML)},this.toString=function(){var K=E();return D?K.toString():K.text},this.bookmark=function(K){return{s:{path:X.makeOffsetPath(K,G),offset:I},e:{path:X.makeOffsetPath(K,H),offset:J}}}};return{create:function(F,I,N,J){if(0===arguments.length){if(D){var K=document.getSelection();if(0===K.rangeCount){return null}var M=K.getRangeAt(0);F=M.startContainer,I=M.startOffset,N=M.endContainer,J=M.endOffset}else{var O=document.selection.createRange(),L=O.duplicate();L.collapse(!1);var H=O;H.collapse(!0);var E=A(H,!0),G=A(L,!1);F=E.cont,I=E.offset,N=G.cont,J=G.offset}}else{2===arguments.length&&(N=F,J=I)}return new B(F,I,N,J)},createFromNode:function(E){return this.create(E,0,E,1)},createFromBookmark:function(H,I){var J=X.fromOffsetPath(H,I.s.path),E=I.s.offset,F=X.fromOffsetPath(H,I.e.path),G=I.e.offset;return new B(J,E,F,G)}}}(),h=function(){this.tab=function(F,B){var A=X.ancestor(F.commonAncestor(),X.isCell),D=X.ancestor(A,X.isTable),C=X.listDescendant(D,X.isCell),E=a[B?"prev":"next"](C,A);E&&g.create(E,0).select()},this.createTable=function(H,E){for(var D,I=[],F=0;H>F;F++){I.push("<td>"+X.blank+"</td>")}D=I.join("");for(var A,G=[],B=0;E>B;B++){G.push("<tr>"+D+"</tr>")}A=G.join("");var C='<table class="table table-bordered">'+A+"</table>";return W(C)[0]}},i=function(){var G=new f,D=new h;this.saveRange=function(H){H.data("range",g.create())},this.restoreRange=function(I){var H=I.data("range");H&&H.select()},this.currentStyle=function(H){var I=g.create();return I.isOnEditable()&&G.current(I,H)},this.undo=function(H){H.data("NoteHistory").undo(H)},this.redo=function(H){H.data("NoteHistory").redo(H)};for(var E=this.recordUndo=function(H){H.data("NoteHistory").recordUndo(H)},C=["bold","italic","underline","strikethrough","justifyLeft","justifyCenter","justifyRight","justifyFull","insertOrderedList","insertUnorderedList","indent","outdent","formatBlock","removeFormat","backColor","foreColor","insertHorizontalRule","fontName"],B=0,F=C.length;F>B;B++){this[C[B]]=function(H){return function(I,J){E(I),document.execCommand(H,!1,J)}}(C[B])}var A=function(L,J,H){E(L);var I=new Array(H+1).join("&nbsp;");J.insertNode(W('<span id="noteTab">'+I+"</span>")[0]);var K=W("#noteTab").removeAttr("id");J=g.create(K[0],1),J.select(),X.remove(K[0])};this.tab=function(H,I){var J=g.create();J.isCollapsed()&&J.isOnCell()?D.tab(J):A(H,J,I.tabsize)},this.untab=function(){var H=g.create();H.isCollapsed()&&H.isOnCell()&&D.tab(H,!0)},this.insertImage=function(I,H){d.createImage(H).then(function(J){E(I),J.css({display:"",width:Math.min(I.width(),J.width())}),g.create().insertNode(J[0])}).fail(function(){var J=I.data("callbacks");J.onImageUploadError&&J.onImageUploadError()})},this.insertVideo=function(T,R){E(T);var S,Q=/^.*(youtu.be\/|v\/|u\/\w\/|embed\/|watch\?v=|\&v=)([^#\&\?]*).*/,U=R.match(Q),I=/\/\/instagram.com\/p\/(.[a-zA-Z0-9]*)/,M=R.match(I),H=/\/\/vine.co\/v\/(.[a-zA-Z0-9]*)/,L=R.match(H),J=/\/\/(player.)?vimeo.com\/([a-z]*\/)*([0-9]{6,11})[?]?.*/,N=R.match(J),K=/.+dailymotion.com\/(video|hub)\/([^_]+)[^#]*(#video=([^_&]+))?/,O=R.match(K);if(U&&11===U[2].length){var P=U[2];S=W("<iframe>").attr("src","//www.youtube.com/embed/"+P).attr("width","640").attr("height","360")}else{M&&M[0].length>0?S=W("<iframe>").attr("src",M[0]+"/embed/").attr("width","612").attr("height","710").attr("scrolling","no").attr("allowtransparency","true"):L&&L[0].length>0?S=W("<iframe>").attr("src",L[0]+"/embed/simple").attr("width","600").attr("height","600").attr("class","vine-embed"):N&&N[3].length>0?S=W("<iframe webkitallowfullscreen mozallowfullscreen allowfullscreen>").attr("src","//player.vimeo.com/video/"+N[3]).attr("width","640").attr("height","360"):O&&O[2].length>0&&(S=W("<iframe>").attr("src","//www.dailymotion.com/embed/video/"+O[2]).attr("width","640").attr("height","360"))}S&&(S.attr("frameborder",0),g.create().insertNode(S[0]))},this.formatBlock=function(I,H){E(I),H=Z.bMSIE?"<"+H+">":H,document.execCommand("FormatBlock",!1,H)},this.formatPara=function(H){this.formatBlock(H,"P")};for(var B=1;6>=B;B++){this["formatH"+B]=function(H){return function(I){this.formatBlock(I,"H"+H)}}(B)}this.fontSize=function(I,H){E(I),document.execCommand("fontSize",!1,3),Z.bFF?I.find("font[size=3]").removeAttr("size").css("font-size",H+"px"):I.find("span").filter(function(){return"medium"===this.style.fontSize}).css("font-size",H+"px")},this.lineHeight=function(H,I){E(H),G.stylePara(g.create(),{lineHeight:I})},this.unlink=function(H){var I=g.create();if(I.isOnAnchor()){E(H);var J=X.ancestor(I.sc,X.isAnchor);I=g.createFromNode(J),I.select(),document.execCommand("unlink")}},this.createLink=function(H,M,J){var K=g.create();E(H);var L=M;if(-1!==M.indexOf("@")&&-1===M.indexOf(":")?L="mailto:"+M:-1===M.indexOf("://")&&(L="http://"+M),(Z.bMSIE||Z.bFF)&&K.isCollapsed()){K.insertNode(W('<A id="linkAnchor">'+M+"</A>")[0]);var I=W("#linkAnchor").attr("href",L).removeAttr("id");K=g.createFromNode(I[0]),K.select()}else{document.execCommand("createlink",!1,L),K=g.create()}W.each(K.nodes(X.isAnchor),function(O,N){J?W(N).attr("target","_blank"):W(N).removeAttr("target")})},this.getLinkInfo=function(){var I=g.create(),K=!0,H="";if(I.isOnAnchor()){var J=X.ancestor(I.sc,X.isAnchor);I=g.createFromNode(J),K="_blank"===W(J).attr("target"),H=J.href}return{text:I.toString(),url:H,newWindow:K}},this.getVideoInfo=function(){var I=g.create();if(I.isOnAnchor()){var H=X.ancestor(I.sc,X.isAnchor);I=g.createFromNode(H)}return{text:I.toString()}},this.color=function(I,H){var J=JSON.parse(H),K=J.foreColor,L=J.backColor;E(I),K&&document.execCommand("foreColor",!1,K),L&&document.execCommand("backColor",!1,L)},this.insertTable=function(H,I){E(H);var J=I.split("x");g.create().insertNode(D.createTable(J[0],J[1]))},this.floatMe=function(H,I,J){E(H),J.css("float",I)},this.resize=function(H,I,J){E(H),J.css({width:H.width()*I+"px",height:""})},this.resizeTo=function(M,I,L){var H;if(L){var J=M.y/M.x,K=I.data("ratio");H={width:K>J?M.x:M.y/K,height:K>J?M.x*K:M.y}}else{H={width:M.x,height:M.y}}I.css(H)},this.removeMedia=function(H,I,J){E(H),J.detach()}},j=function(){var A=[],C=[],D=function(G){var E=G[0],F=g.create();return{contents:G.html(),bookmark:F.bookmark(E),scrollTop:G.scrollTop()}},B=function(E,F){E.html(F.contents).scrollTop(F.scrollTop),g.createFromBookmark(E[0],F.bookmark).select()};this.undo=function(F){var E=D(F);0!==A.length&&(B(F,A.pop()),C.push(E))},this.redo=function(F){var E=D(F);0!==C.length&&(B(F,C.pop()),A.push(E))},this.recordUndo=function(E){C=[],A.push(D(E))}},k=function(){this.update=function(B,G){var F=function(I,J){I.find(".dropdown-menu li a").each(function(){var K=W(this).data("value")+""==J+"";this.className=K?"checked":""})},A=function(I,K){var J=B.find(I);J.toggleClass("active",K())},D=B.find(".note-fontname");if(D.length>0){var C=G["font-family"];C&&(C=a.head(C.split(",")),C=C.replace(/\'/g,""),D.find(".note-current-fontname").text(C),F(D,C))}var E=B.find(".note-fontsize");E.find(".note-current-fontsize").text(G["font-size"]),F(E,parseFloat(G["font-size"]));var H=B.find(".note-height");F(H,parseFloat(G["line-height"])),A('button[data-event="bold"]',function(){return"bold"===G["font-bold"]}),A('button[data-event="italic"]',function(){return"italic"===G["font-italic"]}),A('button[data-event="underline"]',function(){return"underline"===G["font-underline"]}),A('button[data-event="strikethrough"]',function(){return"strikethrough"===G["font-strikethrough"]}),A('button[data-event="justifyLeft"]',function(){return"left"===G["text-align"]||"start"===G["text-align"]}),A('button[data-event="justifyCenter"]',function(){return"center"===G["text-align"]}),A('button[data-event="justifyRight"]',function(){return"right"===G["text-align"]}),A('button[data-event="justifyFull"]',function(){return"justify"===G["text-align"]}),A('button[data-event="insertUnorderedList"]',function(){return"unordered"===G["list-style"]}),A('button[data-event="insertOrderedList"]',function(){return"ordered"===G["list-style"]})},this.updateRecentColor=function(F,A,D){var E=W(F).closest(".note-color"),G=E.find(".note-recent-color"),C=JSON.parse(G.attr("data-value"));C[A]=D,G.attr("data-value",JSON.stringify(C));var B="backColor"===A?"background-color":"color";G.find("i").css(B,D)},this.updateFullscreen=function(C,B){var A=C.find('button[data-event="fullscreen"]');A.toggleClass("active",B)},this.updateCodeview=function(C,B){var A=C.find('button[data-event="codeview"]');A.toggleClass("active",B)},this.activate=function(A){A.find("button").not('button[data-event="codeview"]').removeClass("disabled")},this.deactivate=function(A){A.find("button").not('button[data-event="codeview"]').addClass("disabled")}},m=function(){var A=function(C,F){var D=W(F),E=D.position(),B=D.height();C.css({display:"block",left:E.left,top:E.top+B})};this.update=function(D,C){var E=D.find(".note-link-popover");if(C.anchor){var F=E.find("a");F.attr("href",C.anchor.href).html(C.anchor.href),A(E,C.anchor)}else{E.hide()}var B=D.find(".note-image-popover");C.image?A(B,C.image):B.hide()},this.hide=function(B){B.children().hide()}},q=function(){this.update=function(F,A){var D=F.find(".note-control-selection");if(A.image){var E=W(A.image),G=E.position(),C={w:E.width(),h:E.height()};D.css({display:"block",left:G.left,top:G.top,width:C.w,height:C.h}).data("target",A.image);var B=C.w+"x"+C.h;D.find(".note-control-selection-info").text(B)}else{D.hide()}},this.hide=function(A){A.children().hide()}},n=function(){var A=function(C,B){C.toggleClass("disabled",!B),C.attr("disabled",!B)};this.showImageDialog=function(C,B){return W.Deferred(function(D){var H=B.find(".note-image-dialog"),E=B.find(".note-image-input"),F=B.find(".note-image-url"),G=B.find(".note-image-btn");H.one("shown.bs.modal",function(){E.replaceWith(E.clone().on("change",function(){H.modal("hide"),D.resolve(this.files)})),G.click(function(I){I.preventDefault(),H.modal("hide"),D.resolve(F.val())}),F.keyup(function(){A(G,F.val())}).val("").focus()}).one("hidden.bs.modal",function(){C.focus(),E.off("change"),F.off("keyup"),G.off("click")}).modal("show")})},this.showVideoDialog=function(B,C,D){return W.Deferred(function(E){var F=C.find(".note-video-dialog"),G=F.find(".note-video-url"),H=F.find(".note-video-btn");F.one("shown.bs.modal",function(){G.val(D.text).keyup(function(){A(H,G.val())}).trigger("keyup").trigger("focus"),H.click(function(I){I.preventDefault(),F.modal("hide"),E.resolve(G.val())})}).one("hidden.bs.modal",function(){B.focus(),G.off("keyup"),H.off("click")}).modal("show")})},this.showLinkDialog=function(B,C,D){return W.Deferred(function(J){var G=C.find(".note-link-dialog"),H=G.find(".note-link-text"),I=G.find(".note-link-url"),E=G.find(".note-link-btn"),F=G.find("input[type=checkbox]");G.one("shown.bs.modal",function(){H.val(D.text),I.keyup(function(){A(E,I.val()),D.text||H.val(I.val())}).val(D.url).trigger("focus"),F.prop("checked",D.newWindow),E.one("click",function(K){K.preventDefault(),G.modal("hide"),J.resolve(I.val(),F.is(":checked"))})}).one("hidden.bs.modal",function(){B.focus(),I.off("keyup")}).modal("show")}).promise()},this.showHelpDialog=function(B,C){var D=C.find(".note-help-dialog");D.one("hidden.bs.modal",function(){B.focus()}).modal("show")}},l=function(){var G=new i,O=new k,L=new m,M=new q,P=new n,B=function(U){var T=W(U).closest(".note-editor");return T.length>0&&X.buildLayoutInfo(T)},R=function(T,V){G.restoreRange(T);var U=T.data("callbacks");U.onImageUpload?U.onImageUpload(V,G,T):W.each(V,function(s,t){d.readFileAsDataURL(t).then(function(u){G.insertImage(T,u)}).fail(function(){U.onImageUploadError&&U.onImageUploadError()})})},N=function(T){X.isImg(T.target)&&T.preventDefault()},F=function(V){var U=B(V.currentTarget||V.target),T=G.currentStyle(V.target);T&&(O.update(U.toolbar(),T),L.update(U.popover(),T),M.update(U.handle(),T))},S=function(T){var U=B(T.currentTarget||T.target);L.hide(U.popover()),M.hide(U.handle())},E=function(V){var t=V.originalEvent;if(t.clipboardData&&t.clipboardData.items&&t.clipboardData.items.length){var u=B(V.currentTarget||V.target),T=a.head(t.clipboardData.items),U="file"===T.kind&&-1!==T.type.indexOf("image/");U&&R(u.editable(),[T.getAsFile()])}},Q=function(V){if(X.isControlSizing(V.target)){var Ad=B(V.target),Af=Ad.handle(),Ae=Ad.popover(),Ab=Ad.editable(),Ac=Ad.editor(),Aa=Af.find(".note-control-selection").data("target"),U=W(Aa),T=U.offset(),z=W(document).scrollTop();Ac.on("mousemove",function(s){G.resizeTo({x:s.clientX-T.left,y:s.clientY-(T.top-z)},U,!s.shiftKey),M.update(Af,{image:Aa}),L.update(Ae,{image:Aa})}).one("mouseup",function(){Ac.off("mousemove")}),U.data("ratio")||U.data("ratio",U.height()/U.width()),G.recordUndo(Ab),V.stopPropagation(),V.preventDefault()}},A=function(U){var T=W(U.target).closest("[data-event]");T.length>0&&U.preventDefault()},I=function(Av){var z=W(Av.target).closest("[data-event]");if(z.length>0){var At,V,AA,Aw=z.attr("data-event"),Ax=z.attr("data-value"),Az=B(Av.target),Al=Az.editor(),Ab=Az.toolbar(),Am=Az.dialog(),u=Az.editable(),T=Az.codable(),Aa=Al.data("options");if(-1!==W.inArray(Aw,["resize","floatMe","removeMedia"])){var Au=Az.handle(),An=Au.find(".note-control-selection");AA=W(An.data("target"))}if(G[Aw]&&(u.trigger("focus"),G[Aw](u,Ax,AA)),-1!==W.inArray(Aw,["backColor","foreColor"])){O.updateRecentColor(z[0],Aw,Ax)}else{if("showLinkDialog"===Aw){u.focus();var w=G.getLinkInfo();G.saveRange(u),P.showLinkDialog(u,Am,w).then(function(t,s){G.restoreRange(u),G.createLink(u,t,s)})}else{if("showImageDialog"===Aw){u.focus(),P.showImageDialog(u,Am).then(function(s){"string"==typeof s?(G.restoreRange(u),G.insertImage(u,s)):R(u,s)})}else{if("showVideoDialog"===Aw){u.focus();var Ay=G.getVideoInfo();G.saveRange(u),P.showVideoDialog(u,Am,Ay).then(function(s){G.restoreRange(u),G.insertVideo(u,s)})}else{if("showHelpDialog"===Aw){P.showHelpDialog(u,Am)}else{if("fullscreen"===Aw){var Ad=W("html, body"),Ap=function(s){Al.css("width",s.w),u.css("height",s.h),T.css("height",s.h),T.data("cmEditor")&&T.data("cmEditor").setSize(null,s.h)};Al.toggleClass("fullscreen");var x=Al.hasClass("fullscreen");x?(u.data("orgHeight",u.css("height")),W(window).on("resize",function(){Ap({w:W(window).width(),h:W(window).height()-Ab.outerHeight()})}).trigger("resize"),Ad.css("overflow","hidden")):(W(window).off("resize"),Ap({w:Aa.width||"",h:u.data("orgHeight")}),Ad.css("overflow","auto")),O.updateFullscreen(Ab,x)}else{if("codeview"===Aw){Al.toggleClass("codeview");var U=Al.hasClass("codeview");if(U){if(T.val(u.html()),T.height(u.height()),O.deactivate(Ab),T.focus(),Z.bCodeMirror){V=Y.fromTextArea(T[0],W.extend({mode:"text/html",lineNumbers:!0},Aa.codemirror));var y=Al.data("options").codemirror.tern||!1;y&&(At=new Y.TernServer(y),V.ternServer=At,V.on("cursorActivity",function(s){At.updateArgHints(s)})),V.setSize(null,u.outerHeight()),V.autoFormatRange&&V.autoFormatRange({line:0,ch:0},{line:V.lineCount(),ch:V.getTextArea().value.length}),T.data("cmEditor",V)}}else{Z.bCodeMirror&&(V=T.data("cmEditor"),T.val(V.getValue()),V.toTextArea()),u.html(T.val()||X.emptyPara),u.height(Aa.height?T.height():"auto"),O.activate(Ab),u.focus()}O.updateCodeview(Az.toolbar(),U)}}}}}}}F(Av)}},H=24,K=function(s){var U=W(document),T=B(s.target).editable(),V=T.offset().top-U.scrollTop();U.on("mousemove",function(u){var t=u.clientY-(V+H);T.height(t)}).one("mouseup",function(){U.off("mousemove")}),s.stopPropagation(),s.preventDefault()},C=18,D=function(Aa){var U,Ae=W(Aa.target.parentNode),Ab=Ae.next(),V=Ae.find(".note-dimension-picker-mousecatcher"),Ad=Ae.find(".note-dimension-picker-highlighted"),T=Ae.find(".note-dimension-picker-unhighlighted");if(void 0===Aa.offsetX){var z=W(Aa.target).offset();U={x:Aa.pageX-z.left,y:Aa.pageY-z.top}}else{U={x:Aa.offsetX,y:Aa.offsetY}}var Ac={c:Math.ceil(U.x/C)||1,r:Math.ceil(U.y/C)||1};Ad.css({width:Ac.c+"em",height:Ac.r+"em"}),V.attr("data-value",Ac.c+"x"+Ac.r),3<Ac.c&&Ac.c<10&&T.css({width:Ac.c+1+"em"}),3<Ac.r&&Ac.r<10&&T.css({height:Ac.r+1+"em"}),Ab.html(Ac.c+" x "+Ac.r)},J=function(s){var U=W(),T=s.dropzone,V=s.dropzone.find(".note-dropzone-message");W(document).on("dragenter",function(t){var u=s.editor.hasClass("codeview");u||0!==U.length||(s.editor.addClass("dragover"),T.width(s.editor.width()),T.height(s.editor.height()),V.text("Drag Image Here")),U=U.add(t.target)}).on("dragleave",function(t){U=U.not(t.target),0===U.length&&s.editor.removeClass("dragover")}).on("drop",function(){U=W(),s.editor.removeClass("dragover")}),T.on("dragenter",function(){T.addClass("hover"),V.text("Drop Image")}).on("dragleave",function(){T.removeClass("hover"),V.text("Drag Image Here")}),T.on("drop",function(w){var u=w.originalEvent.dataTransfer;if(u&&u.files){var v=B(w.currentTarget||w.target);v.editable().focus(),R(v.editable(),u.files)}w.preventDefault()}).on("dragover",!1)};this.bindKeyMap=function(s,T){var V=s.editor,U=s.editable;U.on("keydown",function(x){var y=[];x.metaKey&&y.push("CMD"),x.ctrlKey&&y.push("CTRL"),x.shiftKey&&y.push("SHIFT");var w=e.nameFromCode[x.keyCode];w&&y.push(w);var v=T[y.join("+")];v?(x.preventDefault(),G[v](U,V.data("options"))):e.isEdit(x.keyCode)&&G.recordUndo(U)})},this.attach=function(V,u){this.bindKeyMap(V,u.keyMap[Z.bMac?"mac":"pc"]),V.editable.on("mousedown",N),V.editable.on("keyup mouseup",F),V.editable.on("scroll",S),V.editable.on("paste",E),u.disableDragAndDrop||J(V),V.handle.on("mousedown",Q),V.toolbar.on("click",I),V.popover.on("click",I),V.toolbar.on("mousedown",A),V.popover.on("mousedown",A),V.statusbar.on("mousedown",K);var t=V.toolbar,U=t.find(".note-dimension-picker-mousecatcher");if(U.on("mousemove",D),V.editable.on("blur",function(){G.saveRange(V.editable)}),V.editor.data("options",u),u.styleWithSpan&&!Z.bMSIE&&setTimeout(function(){document.execCommand("styleWithCSS",0,!0)}),V.editable.data("NoteHistory",new j),u.onenter&&V.editable.keypress(function(s){s.keyCode===e.ENTER&&u.onenter(s)}),u.onfocus&&V.editable.focus(u.onfocus),u.onblur&&V.editable.blur(u.onblur),u.onkeyup&&V.editable.keyup(u.onkeyup),u.onkeydown&&V.editable.keydown(u.onkeydown),u.onpaste&&V.editable.on("paste",u.onpaste),u.onToolbarClick&&V.toolbar.click(u.onToolbarClick),u.onChange){var T=function(){u.onChange(V.editable,V.editable.html())};Z.bMSIE?V.editable.on("DOMCharacterDataModified, DOMSubtreeModified, DOMNodeInserted",T):V.editable.on("input",T)}V.editable.data("callbacks",{onAutoSave:u.onAutoSave,onImageUpload:u.onImageUpload,onImageUploadError:u.onImageUploadError,onFileUpload:u.onFileUpload,onFileUploadError:u.onFileUpload})},this.dettach=function(T){T.editable.off(),T.toolbar.off(),T.handle.off(),T.popover.off()}},o=function(){var K,J,O,L,N;K={picture:function(P){return'<button type="button" class="btn btn-default btn-sm btn-small" title="'+P.image.image+'" data-event="showImageDialog" tabindex="-1"><i class="fa fa-picture-o icon-picture"></i></button>'},link:function(P){return'<button type="button" class="btn btn-default btn-sm btn-small" title="'+P.link.link+'" data-event="showLinkDialog" tabindex="-1"><i class="fa fa-link icon-link"></i></button>'},video:function(P){return'<button type="button" class="btn btn-default btn-sm btn-small" title="'+P.video.video+'" data-event="showVideoDialog" tabindex="-1"><i class="fa fa-youtube-play icon-play"></i></button>'},table:function(P){return'<button type="button" class="btn btn-default btn-sm btn-small dropdown-toggle" title="'+P.table.table+'" data-toggle="dropdown" tabindex="-1"><i class="fa fa-table icon-table"></i> <span class="caret"></span></button><ul class="dropdown-menu"><div class="note-dimension-picker"><div class="note-dimension-picker-mousecatcher" data-event="insertTable" data-value="1x1"></div><div class="note-dimension-picker-highlighted"></div><div class="note-dimension-picker-unhighlighted"></div></div><div class="note-dimension-display"> 1 x 1 </div></ul>'},style:function(P){return'<button type="button" class="btn btn-default btn-sm btn-small dropdown-toggle" title="'+P.style.style+'" data-toggle="dropdown" tabindex="-1"><i class="fa fa-magic icon-magic"></i> <span class="caret"></span></button><ul class="dropdown-menu"><li><a data-event="formatBlock" data-value="p">'+P.style.normal+'</a></li><li><a data-event="formatBlock" data-value="blockquote"><blockquote>'+P.style.blockquote+'</blockquote></a></li><li><a data-event="formatBlock" data-value="pre">'+P.style.pre+'</a></li><li><a data-event="formatBlock" data-value="h1"><h1>'+P.style.h1+'</h1></a></li><li><a data-event="formatBlock" data-value="h2"><h2>'+P.style.h2+'</h2></a></li><li><a data-event="formatBlock" data-value="h3"><h3>'+P.style.h3+'</h3></a></li><li><a data-event="formatBlock" data-value="h4"><h4>'+P.style.h4+'</h4></a></li><li><a data-event="formatBlock" data-value="h5"><h5>'+P.style.h5+'</h5></a></li><li><a data-event="formatBlock" data-value="h6"><h6>'+P.style.h6+"</h6></a></li></ul>"},fontname:function(Q){var P=["Serif","Sans","Arial","Arial Black","Courier","Courier New","Comic Sans MS","Helvetica","Impact","Lucida Grande","Lucida Sans","Tahoma","Times","Times New Roman","Verdana"],R='<button type="button" class="btn btn-default btn-sm btn-small dropdown-toggle" data-toggle="dropdown" title="'+Q.font.name+'" tabindex="-1"><span class="note-current-fontname">Arial</span> <b class="caret"></b></button>';R+='<ul class="dropdown-menu">';for(var S=0;S<P.length;S++){R+='<li><a data-event="fontName" data-value="'+P[S]+'"><i class="fa fa-check icon-ok"></i> '+P[S]+"</a></li>"}return R+="</ul>"},fontsize:function(P){return'<button type="button" class="btn btn-default btn-sm btn-small dropdown-toggle" data-toggle="dropdown" title="'+P.font.size+'" tabindex="-1"><span class="note-current-fontsize">11</span> <b class="caret"></b></button><ul class="dropdown-menu"><li><a data-event="fontSize" data-value="8"><i class="fa fa-check icon-ok"></i> 8</a></li><li><a data-event="fontSize" data-value="9"><i class="fa fa-check icon-ok"></i> 9</a></li><li><a data-event="fontSize" data-value="10"><i class="fa fa-check icon-ok"></i> 10</a></li><li><a data-event="fontSize" data-value="11"><i class="fa fa-check icon-ok"></i> 11</a></li><li><a data-event="fontSize" data-value="12"><i class="fa fa-check icon-ok"></i> 12</a></li><li><a data-event="fontSize" data-value="14"><i class="fa fa-check icon-ok"></i> 14</a></li><li><a data-event="fontSize" data-value="18"><i class="fa fa-check icon-ok"></i> 18</a></li><li><a data-event="fontSize" data-value="24"><i class="fa fa-check icon-ok"></i> 24</a></li><li><a data-event="fontSize" data-value="36"><i class="fa fa-check icon-ok"></i> 36</a></li></ul>'},color:function(P){return'<button type="button" class="btn btn-default btn-sm btn-small note-recent-color" title="'+P.color.recent+'" data-event="color" data-value=\'{"backColor":"yellow"}\' tabindex="-1"><i class="fa fa-font icon-font" style="color:black;background-color:yellow;"></i></button><button type="button" class="btn btn-default btn-sm btn-small dropdown-toggle" title="'+P.color.more+'" data-toggle="dropdown" tabindex="-1"><span class="caret"></span></button><ul class="dropdown-menu"><li><div class="btn-group"><div class="note-palette-title">'+P.color.background+'</div><div class="note-color-reset" data-event="backColor" data-value="inherit" title="'+P.color.transparent+'">'+P.color.setTransparent+'</div><div class="note-color-palette" data-target-event="backColor"></div></div><div class="btn-group"><div class="note-palette-title">'+P.color.foreground+'</div><div class="note-color-reset" data-event="foreColor" data-value="inherit" title="'+P.color.reset+'">'+P.color.resetToDefault+'</div><div class="note-color-palette" data-target-event="foreColor"></div></div></li></ul>'},bold:function(P){return'<button type="button" class="btn btn-default btn-sm btn-small" title="'+P.font.bold+'" data-shortcut="Ctrl+B" data-mac-shortcut="⌘+B" data-event="bold" tabindex="-1"><i class="fa fa-bold icon-bold"></i></button>'},italic:function(P){return'<button type="button" class="btn btn-default btn-sm btn-small" title="'+P.font.italic+'" data-shortcut="Ctrl+I" data-mac-shortcut="⌘+I" data-event="italic" tabindex="-1"><i class="fa fa-italic icon-italic"></i></button>'},underline:function(P){return'<button type="button" class="btn btn-default btn-sm btn-small" title="'+P.font.underline+'" data-shortcut="Ctrl+U" data-mac-shortcut="⌘+U" data-event="underline" tabindex="-1"><i class="fa fa-underline icon-underline"></i></button>'},strike:function(P){return'<button type="button" class="btn btn-default btn-sm btn-small" title="'+P.font.strike+'" data-event="strikethrough" tabindex="-1"><i class="fa fa-strikethrough icon-strikethrough"></i></button>'},clear:function(P){return'<button type="button" class="btn btn-default btn-sm btn-small" title="'+P.font.clear+'" data-shortcut="Ctrl+\\" data-mac-shortcut="⌘+\\" data-event="removeFormat" tabindex="-1"><i class="fa fa-eraser icon-eraser"></i></button>'},ul:function(P){return'<button type="button" class="btn btn-default btn-sm btn-small" title="'+P.lists.unordered+'" data-shortcut="Ctrl+Shift+8" data-mac-shortcut="⌘+⇧+7" data-event="insertUnorderedList" tabindex="-1"><i class="fa fa-list-ul icon-list-ul"></i></button>'},ol:function(P){return'<button type="button" class="btn btn-default btn-sm btn-small" title="'+P.lists.ordered+'" data-shortcut="Ctrl+Shift+7" data-mac-shortcut="⌘+⇧+8" data-event="insertOrderedList" tabindex="-1"><i class="fa fa-list-ol icon-list-ol"></i></button>'},paragraph:function(P){return'<button type="button" class="btn btn-default btn-sm btn-small dropdown-toggle" title="'+P.paragraph.paragraph+'" data-toggle="dropdown" tabindex="-1"><i class="fa fa-align-left icon-align-left"></i>  <span class="caret"></span></button><div class="dropdown-menu"><div class="note-align btn-group"><button type="button" class="btn btn-default btn-sm btn-small" title="'+P.paragraph.left+'" data-shortcut="Ctrl+Shift+L" data-mac-shortcut="⌘+⇧+L" data-event="justifyLeft" tabindex="-1"><i class="fa fa-align-left icon-align-left"></i></button><button type="button" class="btn btn-default btn-sm btn-small" title="'+P.paragraph.center+'" data-shortcut="Ctrl+Shift+E" data-mac-shortcut="⌘+⇧+E" data-event="justifyCenter" tabindex="-1"><i class="fa fa-align-center icon-align-center"></i></button><button type="button" class="btn btn-default btn-sm btn-small" title="'+P.paragraph.right+'" data-shortcut="Ctrl+Shift+R" data-mac-shortcut="⌘+⇧+R" data-event="justifyRight" tabindex="-1"><i class="fa fa-align-right icon-align-right"></i></button><button type="button" class="btn btn-default btn-sm btn-small" title="'+P.paragraph.justify+'" data-shortcut="Ctrl+Shift+J" data-mac-shortcut="⌘+⇧+J" data-event="justifyFull" tabindex="-1"><i class="fa fa-align-justify icon-align-justify"></i></button></div><div class="note-list btn-group"><button type="button" class="btn btn-default btn-sm btn-small" title="'+P.paragraph.outdent+'" data-shortcut="Ctrl+[" data-mac-shortcut="⌘+[" data-event="outdent" tabindex="-1"><i class="fa fa-outdent icon-indent-left"></i></button><button type="button" class="btn btn-default btn-sm btn-small" title="'+P.paragraph.indent+'" data-shortcut="Ctrl+]" data-mac-shortcut="⌘+]" data-event="indent" tabindex="-1"><i class="fa fa-indent icon-indent-right"></i></button></div></div>'},height:function(P){return'<button type="button" class="btn btn-default btn-sm btn-small dropdown-toggle" data-toggle="dropdown" title="'+P.font.height+'" tabindex="-1"><i class="fa fa-text-height icon-text-height"></i>&nbsp; <b class="caret"></b></button><ul class="dropdown-menu"><li><a data-event="lineHeight" data-value="1.0"><i class="fa fa-check icon-ok"></i> 1.0</a></li><li><a data-event="lineHeight" data-value="1.2"><i class="fa fa-check icon-ok"></i> 1.2</a></li><li><a data-event="lineHeight" data-value="1.4"><i class="fa fa-check icon-ok"></i> 1.4</a></li><li><a data-event="lineHeight" data-value="1.5"><i class="fa fa-check icon-ok"></i> 1.5</a></li><li><a data-event="lineHeight" data-value="1.6"><i class="fa fa-check icon-ok"></i> 1.6</a></li><li><a data-event="lineHeight" data-value="1.8"><i class="fa fa-check icon-ok"></i> 1.8</a></li><li><a data-event="lineHeight" data-value="2.0"><i class="fa fa-check icon-ok"></i> 2.0</a></li><li><a data-event="lineHeight" data-value="3.0"><i class="fa fa-check icon-ok"></i> 3.0</a></li></ul>'},help:function(P){return'<button type="button" class="btn btn-default btn-sm btn-small" title="'+P.options.help+'" data-event="showHelpDialog" tabindex="-1"><i class="fa fa-question icon-question"></i></button>'},fullscreen:function(P){return'<button type="button" class="btn btn-default btn-sm btn-small" title="'+P.options.fullscreen+'" data-event="fullscreen" tabindex="-1"><i class="fa fa-arrows-alt icon-fullscreen"></i></button>'},codeview:function(P){return'<button type="button" class="btn btn-default btn-sm btn-small" title="'+P.options.codeview+'" data-event="codeview" tabindex="-1"><i class="fa fa-code icon-code"></i></button>'},undo:function(P){return'<button type="button" class="btn btn-default btn-sm btn-small" title="'+P.history.undo+'" data-event="undo" tabindex="-1"><i class="fa fa-undo icon-undo"></i></button>'},redo:function(P){return'<button type="button" class="btn btn-default btn-sm btn-small" title="'+P.history.redo+'" data-event="redo" tabindex="-1"><i class="fa fa-repeat icon-repeat"></i></button>'}},J=function(P){return'<div class="note-popover"><div class="note-link-popover popover bottom in" style="display: none;"><div class="arrow"></div><div class="popover-content note-link-content"><a href="http://www.google.com" target="_blank">www.google.com</a>&nbsp;&nbsp;<div class="note-insert btn-group"><button type="button" class="btn btn-default btn-sm btn-small" title="'+P.link.edit+'" data-event="showLinkDialog" tabindex="-1"><i class="fa fa-edit icon-edit"></i></button><button type="button" class="btn btn-default btn-sm btn-small" title="'+P.link.unlink+'" data-event="unlink" tabindex="-1"><i class="fa fa-unlink icon-unlink"></i></button></div></div></div><div class="note-image-popover popover bottom in" style="display: none;"><div class="arrow"></div><div class="popover-content note-image-content"><div class="btn-group"><button type="button" class="btn btn-default btn-sm btn-small" title="'+P.image.resizeFull+'" data-event="resize" data-value="1" tabindex="-1"><span class="note-fontsize-10">100%</span> </button><button type="button" class="btn btn-default btn-sm btn-small" title="'+P.image.resizeHalf+'" data-event="resize" data-value="0.5" tabindex="-1"><span class="note-fontsize-10">50%</span> </button><button type="button" class="btn btn-default btn-sm btn-small" title="'+P.image.resizeQuarter+'" data-event="resize" data-value="0.25" tabindex="-1"><span class="note-fontsize-10">25%</span> </button></div><div class="btn-group"><button type="button" class="btn btn-default btn-sm btn-small" title="'+P.image.floatLeft+'" data-event="floatMe" data-value="left" tabindex="-1"><i class="fa fa-align-left icon-align-left"></i></button><button type="button" class="btn btn-default btn-sm btn-small" title="'+P.image.floatRight+'" data-event="floatMe" data-value="right" tabindex="-1"><i class="fa fa-align-right icon-align-right"></i></button><button type="button" class="btn btn-default btn-sm btn-small" title="'+P.image.floatNone+'" data-event="floatMe" data-value="none" tabindex="-1"><i class="fa fa-align-justify icon-align-justify"></i></button></div><div class="btn-group"><button type="button" class="btn btn-default btn-sm btn-small" title="'+P.image.remove+'" data-event="removeMedia" data-value="none" tabindex="-1"><i class="fa fa-trash-o icon-trash"></i></button></div></div></div></div>'};var O=function(){return'<div class="note-handle"><div class="note-control-selection"><div class="note-control-selection-bg"></div><div class="note-control-holder note-control-nw"></div><div class="note-control-holder note-control-ne"></div><div class="note-control-holder note-control-sw"></div><div class="note-control-sizing note-control-se"></div><div class="note-control-selection-info"></div></div></div>'},A=function(P){return'<table class="note-shortcut"><thead><tr><th></th><th>'+P.shortcut.textFormatting+"</th></tr></thead><tbody><tr><td>⌘ + B</td><td>"+P.font.bold+"</td></tr><tr><td>⌘ + I</td><td>"+P.font.italic+"</td></tr><tr><td>⌘ + U</td><td>"+P.font.underline+"</td></tr><tr><td>⌘ + ⇧ + S</td><td>"+P.font.strike+"</td></tr><tr><td>⌘ + \\</td><td>"+P.font.clear+"</td></tr></tr></tbody></table>"},M=function(P){return'<table class="note-shortcut"><thead><tr><th></th><th>'+P.shortcut.action+"</th></tr></thead><tbody><tr><td>⌘ + Z</td><td>"+P.history.undo+"</td></tr><tr><td>⌘ + ⇧ + Z</td><td>"+P.history.redo+"</td></tr><tr><td>⌘ + ]</td><td>"+P.paragraph.indent+"</td></tr><tr><td>⌘ + [</td><td>"+P.paragraph.outdent+"</td></tr><tr><td>⌘ + ENTER</td><td>"+P.hr.insert+"</td></tr></tbody></table>"},B=function(Q,P){var R='<table class="note-shortcut"><thead><tr><th></th><th>'+Q.shortcut.extraKeys+"</th></tr></thead><tbody>";for(var S in P.extraKeys){P.extraKeys.hasOwnProperty(S)&&(R+="<tr><td>"+S+"</td><td>"+P.extraKeys[S]+"</td></tr>")}return R+="</tbody></table>"},C=function(P){return'<table class="note-shortcut"><thead><tr><th></th><th>'+P.shortcut.paragraphFormatting+"</th></tr></thead><tbody><tr><td>⌘ + ⇧ + L</td><td>"+P.paragraph.left+"</td></tr><tr><td>⌘ + ⇧ + E</td><td>"+P.paragraph.center+"</td></tr><tr><td>⌘ + ⇧ + R</td><td>"+P.paragraph.right+"</td></tr><tr><td>⌘ + ⇧ + J</td><td>"+P.paragraph.justify+"</td></tr><tr><td>⌘ + ⇧ + NUM7</td><td>"+P.lists.ordered+"</td></tr><tr><td>⌘ + ⇧ + NUM8</td><td>"+P.lists.unordered+"</td></tr></tbody></table>"},D=function(P){return'<table class="note-shortcut"><thead><tr><th></th><th>'+P.shortcut.documentStyle+"</th></tr></thead><tbody><tr><td>⌘ + NUM0</td><td>"+P.style.normal+"</td></tr><tr><td>⌘ + NUM1</td><td>"+P.style.h1+"</td></tr><tr><td>⌘ + NUM2</td><td>"+P.style.h2+"</td></tr><tr><td>⌘ + NUM3</td><td>"+P.style.h3+"</td></tr><tr><td>⌘ + NUM4</td><td>"+P.style.h4+"</td></tr><tr><td>⌘ + NUM5</td><td>"+P.style.h5+"</td></tr><tr><td>⌘ + NUM6</td><td>"+P.style.h6+"</td></tr></tbody></table>"},E=function(P,Q){var R='<table class="note-shortcut-layout"><tbody><tr><td>'+M(P,Q)+"</td><td>"+A(P,Q)+"</td></tr><tr><td>"+D(P,Q)+"</td><td>"+C(P,Q)+"</td></tr>";return Q.extraKeys&&(R+='<tr><td colspan="2">'+B(P,Q)+"</td></tr>"),R+="</tbody</table>"},F=function(P){return P.replace(/⌘/g,"Ctrl").replace(/⇧/g,"Shift")};L=function(R,U){var Q=function(){return'<div class="note-image-dialog modal" aria-hidden="false"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><button type="button" class="close" aria-hidden="true" tabindex="-1">&times;</button><h4>'+R.image.insert+'</h4></div><div class="modal-body"><div class="row-fluid"><h5>'+R.image.selectFromFiles+'</h5><input class="note-image-input" type="file" name="files" accept="image/*" /><h5>'+R.image.url+'</h5><input class="note-image-url form-control span12" type="text" /></div></div><div class="modal-footer"><button href="#" class="btn btn-primary note-image-btn disabled" disabled="disabled">'+R.image.insert+"</button></div></div></div></div>"},T=function(){return'<div class="note-link-dialog modal" aria-hidden="false"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><button type="button" class="close" aria-hidden="true" tabindex="-1">&times;</button><h4>'+R.link.insert+'</h4></div><div class="modal-body"><div class="row-fluid"><div class="form-group"><label>'+R.link.textToDisplay+'</label><input class="note-link-text form-control span12" disabled type="text" /></div><div class="form-group"><label>'+R.link.url+'</label><input class="note-link-url form-control span12" type="text" /></div>'+(U.disableLinkTarget?"":'<div class="checkbox"><label><input type="checkbox" checked> '+R.link.openInNewWindow+"</label></div>")+'</div></div><div class="modal-footer"><button href="#" class="btn btn-primary note-link-btn disabled" disabled="disabled">'+R.link.insert+"</button></div></div></div></div>"},S=function(){return'<div class="note-video-dialog modal" aria-hidden="false"><div class="modal-dialog"><div class="modal-content"><div class="modal-header"><button type="button" class="close" aria-hidden="true" tabindex="-1">&times;</button><h4>'+R.video.insert+'</h4></div><div class="modal-body"><div class="row-fluid"><div class="form-group"><label>'+R.video.url+'</label>&nbsp;<small class="text-muted">'+R.video.providers+'</small><input class="note-video-url form-control span12" type="text" /></div></div></div><div class="modal-footer"><button href="#" class="btn btn-primary note-video-btn disabled" disabled="disabled">'+R.video.insert+"</button></div></div></div></div>"},P=function(){return'<div class="note-help-dialog modal" aria-hidden="false"><div class="modal-dialog"><div class="modal-content"><div class="modal-body"><a class="modal-close pull-right" aria-hidden="true" tabindex="-1">'+R.shortcut.close+'</a><div class="title">'+R.shortcut.shortcuts+"</div>"+(Z.bMac?E(R,U):F(E(R,U)))+'<p class="text-center"><a href="//hackerwins.github.io/summernote/" target="_blank">Summernote 0.5.2</a> · <a href="//github.com/HackerWins/summernote" target="_blank">Project</a> · <a href="//github.com/HackerWins/summernote/issues" target="_blank">Issues</a></p></div></div></div></div>'};return'<div class="note-dialog">'+Q()+T()+S()+P()+"</div>"},N=function(){return'<div class="note-resizebar"><div class="note-icon-bar"></div><div class="note-icon-bar"></div><div class="note-icon-bar"></div></div>'};var G=function(P,Q){P.find("button").each(function(T,R){var S=W(R),U=S.attr(Z.bMac?"data-mac-shortcut":"data-shortcut");U&&S.attr("title",function(s,V){return V+" ("+U+")"})}).tooltip({container:"body",trigger:"hover",placement:Q||"top"}).on("click",function(){W(this).tooltip("hide")})},H=[["#000000","#424242","#636363","#9C9C94","#CEC6CE","#EFEFEF","#F7F7F7","#FFFFFF"],["#FF0000","#FF9C00","#FFFF00","#00FF00","#00FFFF","#0000FF","#9C00FF","#FF00FF"],["#F7C6CE","#FFE7CE","#FFEFC6","#D6EFD6","#CEDEE7","#CEE7F7","#D6D6E7","#E7D6DE"],["#E79C9C","#FFC69C","#FFE79C","#B5D6A5","#A5C6CE","#9CC6EF","#B5A5D6","#D6A5BD"],["#E76363","#F7AD6B","#FFD663","#94BD7B","#73A5AD","#6BADDE","#8C7BC6","#C67BA5"],["#CE0000","#E79439","#EFC631","#6BA54A","#4A7B8C","#3984C6","#634AA5","#A54A7B"],["#9C0000","#B56308","#BD9400","#397B21","#104A5A","#085294","#311873","#731842"],["#630000","#7B3900","#846300","#295218","#083139","#003163","#21104A","#4A1031"]],I=function(P){P.find(".note-color-palette").each(function(){for(var S=W(this),Q=S.attr("data-target-event"),t=[],V=0,T=H.length;T>V;V++){for(var v=H[V],U=[],R=0,s=v.length;s>R;R++){var u=v[R];U.push(['<button type="button" class="note-color-btn" style="background-color:',u,';" data-event="',Q,'" data-value="',u,'" title="',u,'" data-toggle="button" tabindex="-1"></button>'].join(""))}t.push("<div>"+U.join("")+"</div>")}S.html(t.join(""))})};this.createLayout=function(u,y){var P=u.next();if(!P||!P.hasClass("note-editor")){var t=W('<div class="note-editor"></div>');y.width&&t.width(y.width),y.height>0&&W('<div class="note-statusbar">'+N()+"</div>").prependTo(t);var s=!u.is(":disabled"),v=W('<div class="note-editable" contentEditable="'+s+'"></div>').prependTo(t);y.height&&v.height(y.height),y.direction&&v.attr("dir",y.direction),v.html(X.html(u)||X.emptyPara),W('<textarea class="note-codable"></textarea>').prependTo(t);for(var x=W.summernote.lang[y.lang],R="",Aa=0,w=y.toolbar.length;w>Aa;Aa++){var V=y.toolbar[Aa];R+='<div class="note-'+V[0]+' btn-group">';for(var Q=0,S=V[1].length;S>Q;Q++){R+=K[V[1][Q]](x)}R+="</div>"}R='<div class="note-toolbar btn-toolbar">'+R+"</div>";var z=W(R).prependTo(t);I(z),G(z,"bottom");var T=W(J(x)).prependTo(t);G(T),W(O()).prependTo(t);var U=W(L(x,y)).prependTo(t);U.find("button.close, a.modal-close").click(function(){W(this).closest(".modal").modal("hide")}),W('<div class="note-dropzone"><div class="note-dropzone-message"></div></div>').prependTo(t),t.insertAfter(u),u.hide()}},this.layoutInfoFromHolder=function(Q){var P=Q.next();if(P.hasClass("note-editor")){var R=X.buildLayoutInfo(P);for(var S in R){R.hasOwnProperty(S)&&(R[S]=R[S].call())}return R}},this.removeLayout=function(Q){var P=this.layoutInfoFromHolder(Q);P&&(Q.html(P.editable.html()),P.editor.remove(),Q.show())}};W.summernote=W.summernote||{},W.extend(W.summernote,b);var p=new o,r=new l;W.fn.extend({summernote:function(B){if(B=W.extend({},W.summernote.options,B),this.each(function(D,C){var F=W(C);p.createLayout(F,B);var E=p.layoutInfoFromHolder(F);r.attach(E,B),X.isTextarea(F[0])&&F.closest("form").submit(function(){F.html(F.code())})}),this.first()&&B.focus){var A=p.layoutInfoFromHolder(this.first());A.editable.focus()}return this.length>0&&B.oninit&&B.oninit(),this},code:function(D){if(void 0===D){var C=this.first();if(0===C.length){return}var B=p.layoutInfoFromHolder(C);if(B&&B.editable){var A=B.editor.hasClass("codeview");return A&&Z.bCodeMirror&&B.codable.data("cmEditor").save(),A?B.codable.val():B.editable.html()}return C.html()}return this.each(function(G,F){var E=p.layoutInfoFromHolder(W(F));E&&E.editable&&E.editable.html(D)}),this},destroy:function(){return this.each(function(D,A){var C=W(A),B=p.layoutInfoFromHolder(C);B&&B.editable&&(r.dettach(B),p.removeLayout(C))}),this}})});