(function(E,F,D){(function(A){typeof define=="function"&&define.amd?define(["jquery"],A):jQuery&&!jQuery.fn.sparkline&&A(jQuery)})(function(Ab){var t={},w,r,I,G,A,n,d,J,H,u,p,g,z,x,v,K,C,Ac,Aa,y,L,o,i,B,e,f,l,m,j,k,q,s,h=0;w=function(){return{common:{type:"line",lineColor:"#00f",fillColor:"#cdf",defaultPixelsPerValue:3,width:"auto",height:"auto",composite:!1,tagValuesAttribute:"values",tagOptionsPrefix:"spark",enableTagOptions:!1,enableHighlight:!0,highlightLighten:1.4,tooltipSkipNull:!0,tooltipPrefix:"",tooltipSuffix:"",disableHiddenCheck:!1,numberFormatter:!1,numberDigitGroupCount:3,numberDigitGroupSep:",",numberDecimalMark:".",disableTooltips:!1,disableInteraction:!1},line:{spotColor:"#f80",highlightSpotColor:"#5f5",highlightLineColor:"#f22",spotRadius:1.5,minSpotColor:"#f80",maxSpotColor:"#f80",lineWidth:1,normalRangeMin:D,normalRangeMax:D,normalRangeColor:"#ccc",drawNormalOnTop:!1,chartRangeMin:D,chartRangeMax:D,chartRangeMinX:D,chartRangeMaxX:D,tooltipFormat:new I('<span style="color: {{color}}">&#9679;</span> {{prefix}}{{y}}{{suffix}}')},bar:{barColor:"#3366cc",negBarColor:"#f44",stackedBarColor:["#3366cc","#dc3912","#ff9900","#109618","#66aa00","#dd4477","#0099c6","#990099"],zeroColor:D,nullColor:D,zeroAxis:!0,barWidth:4,barSpacing:1,chartRangeMax:D,chartRangeMin:D,chartRangeClip:!1,colorMap:D,tooltipFormat:new I('<span style="color: {{color}}">&#9679;</span> {{prefix}}{{value}}{{suffix}}')},tristate:{barWidth:4,barSpacing:1,posBarColor:"#6f6",negBarColor:"#f44",zeroBarColor:"#999",colorMap:{},tooltipFormat:new I('<span style="color: {{color}}">&#9679;</span> {{value:map}}'),tooltipValueLookups:{map:{"-1":"Loss",0:"Draw",1:"Win"}}},discrete:{lineHeight:"auto",thresholdColor:D,thresholdValue:0,chartRangeMax:D,chartRangeMin:D,chartRangeClip:!1,tooltipFormat:new I("{{prefix}}{{value}}{{suffix}}")},bullet:{targetColor:"#f33",targetWidth:3,performanceColor:"#33f",rangeColors:["#d3dafe","#a8b6ff","#7f94ff"],base:D,tooltipFormat:new I("{{fieldkey:fields}} - {{value}}"),tooltipValueLookups:{fields:{r:"Range",p:"Performance",t:"Target"}}},pie:{offset:0,sliceColors:["#3366cc","#dc3912","#ff9900","#109618","#66aa00","#dd4477","#0099c6","#990099"],borderWidth:0,borderColor:"#000",tooltipFormat:new I('<span style="color: {{color}}">&#9679;</span> {{value}} ({{percent.1}}%)')},box:{raw:!1,boxLineColor:"#000",boxFillColor:"#cdf",whiskerColor:"#000",outlierLineColor:"#333",outlierFillColor:"#fff",medianColor:"#f00",showOutliers:!0,outlierIQR:1.5,spotRadius:1.5,target:D,targetColor:"#4a2",chartRangeMax:D,chartRangeMin:D,tooltipFormat:new I("{{field:fields}}: {{value}}"),tooltipFormatFieldlistKey:"field",tooltipValueLookups:{fields:{lq:"Lower Quartile",med:"Median",uq:"Upper Quartile",lo:"Left Outlier",ro:"Right Outlier",lw:"Left Whisker",rw:"Right Whisker"}}}}},f='.jqstooltip { position: absolute;left: 0px;top: 0px;visibility: hidden;background: rgb(0, 0, 0) transparent;background-color: rgba(0,0,0,0.6);filter:progid:DXImageTransform.Microsoft.gradient(startColorstr=#99000000, endColorstr=#99000000);-ms-filter: "progid:DXImageTransform.Microsoft.gradient(startColorstr=#99000000, endColorstr=#99000000)";color: white;font: 10px arial, san serif;text-align: left;white-space: nowrap;padding: 5px;border: 1px solid white;z-index: 10000;}.jqsfield { color: white;font: 10px arial, san serif;text-align: left;}',r=function(){var N,M;return N=function(){this.init.apply(this,arguments)},arguments.length>1?(arguments[0]?(N.prototype=Ab.extend(new arguments[0],arguments[arguments.length-1]),N._super=arguments[0].prototype):N.prototype=arguments[arguments.length-1],arguments.length>2&&(M=Array.prototype.slice.call(arguments,1,-1),M.unshift(N.prototype),Ab.extend.apply(Ab,M))):N.prototype=arguments[0],N.prototype.cls=N,N},Ab.SPFormatClass=I=r({fre:/\{\{([\w.]+?)(:(.+?))?\}\}/g,precre:/(\w+)\.(\d+)/,init:function(N,M){this.format=N,this.fclass=M},render:function(V,O,T){var S=this,M=V,P,R,N,U,Q;return this.format.replace(this.fre,function(){var W;return R=arguments[1],N=arguments[3],P=S.precre.exec(R),P?(Q=P[2],R=P[1]):Q=!1,U=M[R],U===D?"":N&&O&&O[N]?(W=O[N],W.get?O[N].get(U)||U:O[N][U]||U):(H(U)&&(T.get("numberFormatter")?U=T.get("numberFormatter")(U):U=x(U,Q,T.get("numberDigitGroupCount"),T.get("numberDigitGroupSep"),T.get("numberDecimalMark"))),U)})}}),Ab.spformat=function(N,M){return new I(N,M)},G=function(M,N,O){return M<N?N:M>O?O:M},A=function(M,O){var N;return O===2?(N=F.floor(M.length/2),M.length%2?M[N]:(M[N-1]+M[N])/2):M.length%2?(N=(M.length*O+O)/4,N%1?(M[F.floor(N)]+M[F.floor(N)-1])/2:M[N-1]):(N=(M.length*O+2)/4,N%1?(M[F.floor(N)]+M[F.floor(N)-1])/2:M[N-1])},n=function(N){var M;switch(N){case"undefined":N=D;break;case"null":N=null;break;case"true":N=!0;break;case"false":N=!1;break;default:M=parseFloat(N),N==M&&(N=M)}return N},d=function(M){var N,O=[];for(N=M.length;N--;){O[N]=n(M[N])}return O},J=function(N,M){var O,P,Q=[];for(O=0,P=N.length;O<P;O++){N[O]!==M&&Q.push(N[O])}return Q},H=function(M){return !isNaN(parseFloat(M))&&isFinite(M)},x=function(O,N,M,P,S){var Q,R;O=(N===!1?parseFloat(O).toString():O.toFixed(N)).split(""),Q=(Q=Ab.inArray(".",O))<0?O.length:Q,Q<O.length&&(O[Q]=S);for(R=Q-M;R>0;R-=M){O.splice(R,0,P)}return O.join("")},u=function(N,P,M){var O;for(O=P.length;O--;){if(M&&P[O]===null){continue}if(P[O]!==N){return !1}}return !0},p=function(M){var N=0,O;for(O=M.length;O--;){N+=typeof M[O]=="number"?M[O]:0}return N},z=function(M){return Ab.isArray(M)?M:[M]},g=function(M){var N;E.createStyleSheet?E.createStyleSheet().cssText=M:(N=E.createElement("style"),N.type="text/css",E.getElementsByTagName("head")[0].appendChild(N),N[typeof E.body.style.WebkitAppearance=="string"?"innerText":"innerHTML"]=M)},Ab.fn.simpledraw=function(N,M,S,O){var P,Q;if(S&&(P=this.data("_jqs_vcanvas"))){return P}if(Ab.fn.sparkline.canvas===!1){return !1}if(Ab.fn.sparkline.canvas===D){var R=E.createElement("canvas");if(!R.getContext||!R.getContext("2d")){if(!E.namespaces||!!E.namespaces.v){return Ab.fn.sparkline.canvas=!1,!1}E.namespaces.add("v","urn:schemas-microsoft-com:vml","#default#VML"),Ab.fn.sparkline.canvas=function(W,V,U,T){return new q(W,V,U)}}else{Ab.fn.sparkline.canvas=function(W,V,U,T){return new k(W,V,U,T)}}}return N===D&&(N=Ab(this).innerWidth()),M===D&&(M=Ab(this).innerHeight()),P=Ab.fn.sparkline.canvas(N,M,this,O),Q=Ab(this).data("_jqs_mhandler"),Q&&Q.registerCanvas(P),P},Ab.fn.cleardraw=function(){var M=this.data("_jqs_vcanvas");M&&M.reset()},Ab.RangeMapClass=v=r({init:function(N){var P,M,O=[];for(P in N){N.hasOwnProperty(P)&&typeof P=="string"&&P.indexOf(":")>-1&&(M=P.split(":"),M[0]=M[0].length===0?-Infinity:parseFloat(M[0]),M[1]=M[1].length===0?Infinity:parseFloat(M[1]),M[2]=N[P],O.push(M))}this.map=N,this.rangelist=O||!1},get:function(N){var M=this.rangelist,O,P,Q;if((Q=this.map[N])!==D){return Q}if(M){for(O=M.length;O--;){P=M[O];if(P[0]<=N&&P[1]>=N){return P[2]}}}return D}}),Ab.range_map=function(M){return new v(M)},K=r({init:function(M,N){var O=Ab(M);this.$el=O,this.options=N,this.currentPageX=0,this.currentPageY=0,this.el=M,this.splist=[],this.tooltip=null,this.over=!1,this.displayTooltips=!N.get("disableTooltips"),this.highlightEnabled=!N.get("disableHighlight")},registerSparkline:function(M){this.splist.push(M),this.over&&this.updateDisplay()},registerCanvas:function(N){var M=Ab(N.canvas);this.canvas=N,this.$canvas=M,M.mouseenter(Ab.proxy(this.mouseenter,this)),M.mouseleave(Ab.proxy(this.mouseleave,this)),M.click(Ab.proxy(this.mouseclick,this))},reset:function(M){this.splist=[],this.tooltip&&M&&(this.tooltip.remove(),this.tooltip=D)},mouseclick:function(N){var M=Ab.Event("sparklineClick");M.originalEvent=N,M.sparklines=this.splist,this.$el.trigger(M)},mouseenter:function(M){Ab(E.body).unbind("mousemove.jqs"),Ab(E.body).bind("mousemove.jqs",Ab.proxy(this.mousemove,this)),this.over=!0,this.currentPageX=M.pageX,this.currentPageY=M.pageY,this.currentEl=M.target,!this.tooltip&&this.displayTooltips&&(this.tooltip=new C(this.options),this.tooltip.updatePosition(M.pageX,M.pageY)),this.updateDisplay()},mouseleave:function(){Ab(E.body).unbind("mousemove.jqs");var M=this.splist,N=M.length,P=!1,Q,O;this.over=!1,this.currentEl=null,this.tooltip&&(this.tooltip.remove(),this.tooltip=null);for(O=0;O<N;O++){Q=M[O],Q.clearRegionHighlight()&&(P=!0)}P&&this.canvas.render()},mousemove:function(M){this.currentPageX=M.pageX,this.currentPageY=M.pageY,this.currentEl=M.target,this.tooltip&&this.tooltip.updatePosition(M.pageX,M.pageY),this.updateDisplay()},updateDisplay:function(){var Q=this.splist,W=Q.length,M=!1,T=this.$canvas.offset(),P=this.currentPageX-T.left,V=this.currentPageY-T.top,S,N,U,R,O;if(!this.over){return}for(U=0;U<W;U++){N=Q[U],R=N.setRegionHighlight(this.currentEl,P,V),R&&(M=!0)}if(M){O=Ab.Event("sparklineRegionChange"),O.sparklines=this.splist,this.$el.trigger(O);if(this.tooltip){S="";for(U=0;U<W;U++){N=Q[U],S+=N.getCurrentRegionTooltip()}this.tooltip.setContent(S)}this.disableHighlight||this.canvas.render()}R===null&&this.mouseleave()}}),C=r({sizeStyle:"position: static !important;display: block !important;visibility: hidden !important;float: left !important;",init:function(P){var M=P.get("tooltipClassname","jqstooltip"),O=this.sizeStyle,N;this.container=P.get("tooltipContainer")||E.body,this.tooltipOffsetX=P.get("tooltipOffsetX",10),this.tooltipOffsetY=P.get("tooltipOffsetY",12),Ab("#jqssizetip").remove(),Ab("#jqstooltip").remove(),this.sizetip=Ab("<div/>",{id:"jqssizetip",style:O,"class":M}),this.tooltip=Ab("<div/>",{id:"jqstooltip","class":M}).appendTo(this.container),N=this.tooltip.offset(),this.offsetLeft=N.left,this.offsetTop=N.top,this.hidden=!0,Ab(window).unbind("resize.jqs scroll.jqs"),Ab(window).bind("resize.jqs scroll.jqs",Ab.proxy(this.updateWindowDims,this)),this.updateWindowDims()},updateWindowDims:function(){this.scrollTop=Ab(window).scrollTop(),this.scrollLeft=Ab(window).scrollLeft(),this.scrollRight=this.scrollLeft+Ab(window).width(),this.updatePosition()},getSize:function(M){this.sizetip.html(M).appendTo(this.container),this.width=this.sizetip.width()+1,this.height=this.sizetip.height(),this.sizetip.remove()},setContent:function(M){if(!M){this.tooltip.css("visibility","hidden"),this.hidden=!0;return}this.getSize(M),this.tooltip.html(M).css({width:this.width,height:this.height,visibility:"visible"}),this.hidden&&(this.hidden=!1,this.updatePosition())},updatePosition:function(N,M){if(N===D){if(this.mousex===D){return}N=this.mousex-this.offsetLeft,M=this.mousey-this.offsetTop}else{this.mousex=N-=this.offsetLeft,this.mousey=M-=this.offsetTop}if(!this.height||!this.width||this.hidden){return}M-=this.height+this.tooltipOffsetY,N+=this.tooltipOffsetX,M<this.scrollTop&&(M=this.scrollTop),N<this.scrollLeft?N=this.scrollLeft:N+this.width>this.scrollRight&&(N=this.scrollRight-this.width),this.tooltip.css({left:N,top:M})},remove:function(){this.tooltip.remove(),this.sizetip.remove(),this.sizetip=this.tooltip=D,Ab(window).unbind("resize.jqs scroll.jqs")}}),l=function(){g(f)},Ab(l),s=[],Ab.fn.sparkline=function(N,M){return this.each(function(){var Q=new Ab.fn.sparkline.options(this,M),O=Ab(this),P,R;P=function(){var W,Y,S,U,V,T,X;if(N==="html"||N===D){X=this.getAttribute(Q.get("tagValuesAttribute"));if(X===D||X===null){X=O.html()}W=X.replace(/(^\s*<!--)|(-->\s*$)|\s+/g,"").split(",")}else{W=N}Y=Q.get("width")==="auto"?W.length*Q.get("defaultPixelsPerValue"):Q.get("width");if(Q.get("height")==="auto"){if(!Q.get("composite")||!Ab.data(this,"_jqs_vcanvas")){U=E.createElement("span"),U.innerHTML="a",O.html(U),S=Ab(U).innerHeight()||Ab(U).height(),Ab(U).remove(),U=null}}else{S=Q.get("height")}Q.get("disableInteraction")?V=!1:(V=Ab.data(this,"_jqs_mhandler"),V?Q.get("composite")||V.reset():(V=new K(this,Q),Ab.data(this,"_jqs_mhandler",V)));if(Q.get("composite")&&!Ab.data(this,"_jqs_vcanvas")){Ab.data(this,"_jqs_errnotify")||(alert("Attempted to attach a composite sparkline to an element with no existing sparkline"),Ab.data(this,"_jqs_errnotify",!0));return}T=new (Ab.fn.sparkline[Q.get("type")])(this,W,Q,Y,S),T.render(),V&&V.registerSparkline(T)};if(Ab(this).html()&&!Q.get("disableHiddenCheck")&&Ab(this).is(":hidden")||!Ab(this).parents("body").length){if(!Q.get("composite")&&Ab.data(this,"_jqs_pending")){for(R=s.length;R;R--){s[R-1][0]==this&&s.splice(R-1,1)}}s.push([this,P]),Ab.data(this,"_jqs_pending",!0)}else{P.call(this)}})},Ab.fn.sparkline.defaults=w(),Ab.sparkline_display_visible=function(){var N,P,M,O=[];for(P=0,M=s.length;P<M;P++){N=s[P][0],Ab(N).is(":visible")&&!Ab(N).parents().is(":hidden")?(s[P][1].call(N),Ab.data(s[P][0],"_jqs_pending",!1),O.push(P)):!Ab(N).closest("html").length&&!Ab.data(N,"_jqs_pending")&&(Ab.data(s[P][0],"_jqs_pending",!1),O.push(P))}for(P=O.length;P;P--){s.splice(O[P-1],1)}},Ab.fn.sparkline.options=r({init:function(N,M){var O,R,P,Q;this.userOptions=M=M||{},this.tag=N,this.tagValCache={},R=Ab.fn.sparkline.defaults,P=R.common,this.tagOptionsPrefix=M.enableTagOptions&&(M.tagOptionsPrefix||P.tagOptionsPrefix),Q=this.getTagSetting("type"),Q===t?O=R[M.type||P.type]:O=R[Q],this.mergedOptions=Ab.extend({},P,O,M)},getTagSetting:function(N){var O=this.tagOptionsPrefix,P,M,Q,R;if(O===!1||O===D){return t}if(this.tagValCache.hasOwnProperty(N)){P=this.tagValCache.key}else{P=this.tag.getAttribute(O+N);if(P===D||P===null){P=t}else{if(P.substr(0,1)==="["){P=P.substr(1,P.length-2).split(",");for(M=P.length;M--;){P[M]=n(P[M].replace(/(^\s*)|(\s*$)/g,""))}}else{if(P.substr(0,1)==="{"){Q=P.substr(1,P.length-2).split(","),P={};for(M=Q.length;M--;){R=Q[M].split(":",2),P[R[0].replace(/(^\s*)|(\s*$)/g,"")]=n(R[1].replace(/(^\s*)|(\s*$)/g,""))}}else{P=n(P)}}}this.tagValCache.key=P}return P},get:function(M,P){var O=this.getTagSetting(M),N;return O!==t?O:(N=this.mergedOptions[M])===D?P:N}}),Ab.fn.sparkline._base=r({disabled:!1,init:function(N,M,P,Q,O){this.el=N,this.$el=Ab(N),this.values=M,this.options=P,this.width=Q,this.height=O,this.currentRegion=D},initTarget:function(){var M=!this.options.get("disableInteraction");(this.target=this.$el.simpledraw(this.width,this.height,this.options.get("composite"),M))?(this.canvasWidth=this.target.pixelWidth,this.canvasHeight=this.target.pixelHeight):this.disabled=!0},render:function(){return this.disabled?(this.el.innerHTML="",!1):!0},getRegion:function(N,M){},setRegionHighlight:function(N,O,P){var M=this.currentRegion,R=!this.options.get("disableHighlight"),Q;return O>this.canvasWidth||P>this.canvasHeight||O<0||P<0?null:(Q=this.getRegion(N,O,P),M!==Q?(M!==D&&R&&this.removeHighlight(),this.currentRegion=Q,Q!==D&&R&&this.renderHighlight(),!0):!1)},clearRegionHighlight:function(){return this.currentRegion!==D?(this.removeHighlight(),this.currentRegion=D,!0):!1},renderHighlight:function(){this.changeHighlight(!0)},removeHighlight:function(){this.changeHighlight(!1)},changeHighlight:function(M){},getCurrentRegionTooltip:function(){var N=this.options,M="",a=[],b,c,S,U,R,P,O,V,Q,W,X,Y,Z,T;if(this.currentRegion===D){return""}b=this.getCurrentRegionFields(),X=N.get("tooltipFormatter");if(X){return X(this,N,b)}N.get("tooltipChartTitle")&&(M+='<div class="jqs jqstitle">'+N.get("tooltipChartTitle")+"</div>\n"),c=this.options.get("tooltipFormat");if(!c){return""}Ab.isArray(c)||(c=[c]),Ab.isArray(b)||(b=[b]),O=this.options.get("tooltipFormatFieldlist"),V=this.options.get("tooltipFormatFieldlistKey");if(O&&V){Q=[];for(P=b.length;P--;){W=b[P][V],(T=Ab.inArray(W,O))!=-1&&(Q[T]=b[P])}b=Q}S=c.length,Z=b.length;for(P=0;P<S;P++){Y=c[P],typeof Y=="string"&&(Y=new I(Y)),U=Y.fclass||"jqsfield";for(T=0;T<Z;T++){if(!b[T].isNull||!N.get("tooltipSkipNull")){Ab.extend(b[T],{prefix:N.get("tooltipPrefix"),suffix:N.get("tooltipSuffix")}),R=Y.render(b[T],N.get("tooltipValueLookups"),N),a.push('<div class="'+U+'">'+R+"</div>")}}}return a.length?M+a.join("\n"):""},getCurrentRegionFields:function(){},calcHighlightColor:function(N,Q){var M=Q.get("highlightColor"),R=Q.get("highlightLighten"),O,T,P,S;if(M){return M}if(R){O=/^#([0-9a-f])([0-9a-f])([0-9a-f])$/i.exec(N)||/^#([0-9a-f]{2})([0-9a-f]{2})([0-9a-f]{2})$/i.exec(N);if(O){P=[],T=N.length===4?16:1;for(S=0;S<3;S++){P[S]=G(F.round(parseInt(O[S+1],16)*T*R),0,255)}return"rgb("+P.join(",")+")"}}return N}}),Ac={changeHighlight:function(N){var P=this.currentRegion,M=this.target,O=this.regionShapes[P],Q;O&&(Q=this.renderRegion(P,N),Ab.isArray(Q)||Ab.isArray(O)?(M.replaceWithShapes(O,Q),this.regionShapes[P]=Ab.map(Q,function(R){return R.id})):(M.replaceWithShape(O,Q),this.regionShapes[P]=Q.id))},render:function(){var O=this.values,N=this.target,M=this.regionShapes,P,S,Q,R;if(!this.cls._super.render.call(this)){return}for(Q=O.length;Q--;){P=this.renderRegion(Q);if(P){if(Ab.isArray(P)){S=[];for(R=P.length;R--;){P[R].append(),S.push(P[R].id)}M[Q]=S}else{P.append(),M[Q]=P.id}}else{M[Q]=null}}N.render()}},Ab.fn.sparkline.line=Aa=r(Ab.fn.sparkline._base,{type:"line",init:function(N,M,O,P,Q){Aa._super.init.call(this,N,M,O,P,Q),this.vertices=[],this.regionMap=[],this.xvalues=[],this.yvalues=[],this.yminmax=[],this.hightlightSpotId=null,this.lastShapeId=null,this.initTarget()},getRegion:function(N,M,O){var P,Q=this.regionMap;for(P=Q.length;P--;){if(Q[P]!==null&&M>=Q[P][0]&&M<=Q[P][1]){return Q[P][2]}}return D},getCurrentRegionFields:function(){var M=this.currentRegion;return{isNull:this.yvalues[M]===null,x:this.xvalues[M],y:this.yvalues[M],color:this.options.get("lineColor"),fillColor:this.options.get("fillColor"),offset:M}},renderHighlight:function(){var O=this.currentRegion,N=this.target,P=this.vertices[O],S=this.options,U=S.get("spotRadius"),M=S.get("highlightSpotColor"),Q=S.get("highlightLineColor"),R,T;if(!P){return}U&&M&&(R=N.drawCircle(P[0],P[1],U,D,M),this.highlightSpotId=R.id,N.insertAfterShape(this.lastShapeId,R)),Q&&(T=N.drawLine(P[0],this.canvasTop,P[0],this.canvasTop+this.canvasHeight,Q),this.highlightLineId=T.id,N.insertAfterShape(this.lastShapeId,T))},removeHighlight:function(){var M=this.target;this.highlightSpotId&&(M.removeShapeId(this.highlightSpotId),this.highlightSpotId=null),this.highlightLineId&&(M.removeShapeId(this.highlightLineId),this.highlightLineId=null)},scanValues:function(){var V=this.values,O=V.length,T=this.xvalues,S=this.yvalues,M=this.yminmax,P,R,N,U,Q;for(P=0;P<O;P++){R=V[P],N=typeof V[P]=="string",U=typeof V[P]=="object"&&V[P] instanceof Array,Q=N&&V[P].split(":"),N&&Q.length===2?(T.push(Number(Q[0])),S.push(Number(Q[1])),M.push(Number(Q[1]))):U?(T.push(R[0]),S.push(R[1]),M.push(R[1])):(T.push(P),V[P]===null||V[P]==="null"?S.push(null):(S.push(Number(R)),M.push(Number(R))))}this.options.get("xvalues")&&(T=this.options.get("xvalues")),this.maxy=this.maxyorg=F.max.apply(F,M),this.miny=this.minyorg=F.min.apply(F,M),this.maxx=F.max.apply(F,T),this.minx=F.min.apply(F,T),this.xvalues=T,this.yvalues=S,this.yminmax=M},processRangeOptions:function(){var M=this.options,O=M.get("normalRangeMin"),N=M.get("normalRangeMax");O!==D&&(O<this.miny&&(this.miny=O),N>this.maxy&&(this.maxy=N)),M.get("chartRangeMin")!==D&&(M.get("chartRangeClip")||M.get("chartRangeMin")<this.miny)&&(this.miny=M.get("chartRangeMin")),M.get("chartRangeMax")!==D&&(M.get("chartRangeClip")||M.get("chartRangeMax")>this.maxy)&&(this.maxy=M.get("chartRangeMax")),M.get("chartRangeMinX")!==D&&(M.get("chartRangeClipX")||M.get("chartRangeMinX")<this.minx)&&(this.minx=M.get("chartRangeMinX")),M.get("chartRangeMaxX")!==D&&(M.get("chartRangeClipX")||M.get("chartRangeMaxX")>this.maxx)&&(this.maxx=M.get("chartRangeMaxX"))},drawNormalRange:function(O,P,S,U,M){var R=this.options.get("normalRangeMin"),N=this.options.get("normalRangeMax"),T=P+F.round(S-S*((N-this.miny)/M)),Q=F.round(S*(N-R)/M);this.target.drawRect(O,T,U,Q,D,this.options.get("normalRangeColor")).append()},render:function(){var U=this.options,Am=this.target,Aj=this.canvasWidth,An=this.canvasHeight,Ae=this.vertices,M=U.get("spotRadius"),Af=this.regionMap,N,Ad,a,Ah,Y,R,Ap,Ai,b,Z,Ak,c,Ar,V,O,X,Ag,Al,P,T,Q,S,Aq,Ao,W;if(!Aa._super.render.call(this)){return}this.scanValues(),this.processRangeOptions(),Aq=this.xvalues,Ao=this.yvalues;if(!this.yminmax.length||this.yvalues.length<2){return}Ah=Y=0,N=this.maxx-this.minx===0?1:this.maxx-this.minx,Ad=this.maxy-this.miny===0?1:this.maxy-this.miny,a=this.yvalues.length-1,M&&(Aj<M*4||An<M*4)&&(M=0);if(M){Q=U.get("highlightSpotColor")&&!U.get("disableInteraction");if(Q||U.get("minSpotColor")||U.get("spotColor")&&Ao[a]===this.miny){An-=F.ceil(M)}if(Q||U.get("maxSpotColor")||U.get("spotColor")&&Ao[a]===this.maxy){An-=F.ceil(M),Ah+=F.ceil(M)}if(Q||(U.get("minSpotColor")||U.get("maxSpotColor"))&&(Ao[0]===this.miny||Ao[0]===this.maxy)){Y+=F.ceil(M),Aj-=F.ceil(M)}if(Q||U.get("spotColor")||U.get("minSpotColor")||U.get("maxSpotColor")&&(Ao[a]===this.miny||Ao[a]===this.maxy)){Aj-=F.ceil(M)}}An--,U.get("normalRangeMin")!==D&&!U.get("drawNormalOnTop")&&this.drawNormalRange(Y,Ah,An,Aj,Ad),Ap=[],Ai=[Ap],V=O=null,X=Ao.length;for(W=0;W<X;W++){b=Aq[W],Ak=Aq[W+1],Z=Ao[W],c=Y+F.round((b-this.minx)*(Aj/N)),Ar=W<X-1?Y+F.round((Ak-this.minx)*(Aj/N)):Aj,O=c+(Ar-c)/2,Af[W]=[V||0,O,W],V=O,Z===null?W&&(Ao[W-1]!==null&&(Ap=[],Ai.push(Ap)),Ae.push(null)):(Z<this.miny&&(Z=this.miny),Z>this.maxy&&(Z=this.maxy),Ap.length||Ap.push([c,Ah+An]),R=[c,Ah+F.round(An-An*((Z-this.miny)/Ad))],Ap.push(R),Ae.push(R))}Ag=[],Al=[],P=Ai.length;for(W=0;W<P;W++){Ap=Ai[W],Ap.length&&(U.get("fillColor")&&(Ap.push([Ap[Ap.length-1][0],Ah+An]),Al.push(Ap.slice(0)),Ap.pop()),Ap.length>2&&(Ap[0]=[Ap[0][0],Ap[1][1]]),Ag.push(Ap))}P=Al.length;for(W=0;W<P;W++){Am.drawShape(Al[W],U.get("fillColor"),U.get("fillColor")).append()}U.get("normalRangeMin")!==D&&U.get("drawNormalOnTop")&&this.drawNormalRange(Y,Ah,An,Aj,Ad),P=Ag.length;for(W=0;W<P;W++){Am.drawShape(Ag[W],U.get("lineColor"),D,U.get("lineWidth")).append()}if(M&&U.get("valueSpots")){T=U.get("valueSpots"),T.get===D&&(T=new v(T));for(W=0;W<X;W++){S=T.get(Ao[W]),S&&Am.drawCircle(Y+F.round((Aq[W]-this.minx)*(Aj/N)),Ah+F.round(An-An*((Ao[W]-this.miny)/Ad)),M,D,S).append()}}M&&U.get("spotColor")&&Ao[a]!==null&&Am.drawCircle(Y+F.round((Aq[Aq.length-1]-this.minx)*(Aj/N)),Ah+F.round(An-An*((Ao[a]-this.miny)/Ad)),M,D,U.get("spotColor")).append(),this.maxy!==this.minyorg&&(M&&U.get("minSpotColor")&&(b=Aq[Ab.inArray(this.minyorg,Ao)],Am.drawCircle(Y+F.round((b-this.minx)*(Aj/N)),Ah+F.round(An-An*((this.minyorg-this.miny)/Ad)),M,D,U.get("minSpotColor")).append()),M&&U.get("maxSpotColor")&&(b=Aq[Ab.inArray(this.maxyorg,Ao)],Am.drawCircle(Y+F.round((b-this.minx)*(Aj/N)),Ah+F.round(An-An*((this.maxyorg-this.miny)/Ad)),M,D,U.get("maxSpotColor")).append())),this.lastShapeId=Am.getLastShapeId(),this.canvasTop=Ah,Am.render()}}),Ab.fn.sparkline.bar=y=r(Ab.fn.sparkline._base,Ac,{type:"bar",init:function(Ai,Ay,Af,V,b){var Ae=parseInt(Af.get("barWidth"),10),R=parseInt(Af.get("barSpacing"),10),O=Af.get("chartRangeMin"),X=Af.get("chartRangeMax"),Ax=Af.get("chartRangeClip"),Aj=Infinity,Ad=-Infinity,P,Ao,Ag,Al,a,Y,Ah,N,S,Ar,T,U,Aq,Z,Ak,An,c,W,Q,M,Au,Av,Aw;y._super.init.call(this,Ai,Ay,Af,V,b);for(Y=0,Ah=Ay.length;Y<Ah;Y++){M=Ay[Y],P=typeof M=="string"&&M.indexOf(":")>-1;if(P||Ab.isArray(M)){Ak=!0,P&&(M=Ay[Y]=d(M.split(":"))),M=J(M,null),Ao=F.min.apply(F,M),Ag=F.max.apply(F,M),Ao<Aj&&(Aj=Ao),Ag>Ad&&(Ad=Ag)}}this.stacked=Ak,this.regionShapes={},this.barWidth=Ae,this.barSpacing=R,this.totalBarWidth=Ae+R,this.width=V=Ay.length*Ae+(Ay.length-1)*R,this.initTarget(),Ax&&(Aq=O===D?-Infinity:O,Z=X===D?Infinity:X),a=[],Al=Ak?[]:a;var Ap=[],Am=[];for(Y=0,Ah=Ay.length;Y<Ah;Y++){if(Ak){An=Ay[Y],Ay[Y]=Q=[],Ap[Y]=0,Al[Y]=Am[Y]=0;for(c=0,W=An.length;c<W;c++){M=Q[c]=Ax?G(An[c],Aq,Z):An[c],M!==null&&(M>0&&(Ap[Y]+=M),Aj<0&&Ad>0?M<0?Am[Y]+=F.abs(M):Al[Y]+=M:Al[Y]+=F.abs(M-(M<0?Ad:Aj)),a.push(M))}}else{M=Ax?G(Ay[Y],Aq,Z):Ay[Y],M=Ay[Y]=n(M),M!==null&&a.push(M)}}this.max=U=F.max.apply(F,a),this.min=T=F.min.apply(F,a),this.stackMax=Ad=Ak?F.max.apply(F,Ap):U,this.stackMin=Aj=Ak?F.min.apply(F,a):T,Af.get("chartRangeMin")!==D&&(Af.get("chartRangeClip")||Af.get("chartRangeMin")<T)&&(T=Af.get("chartRangeMin")),Af.get("chartRangeMax")!==D&&(Af.get("chartRangeClip")||Af.get("chartRangeMax")>U)&&(U=Af.get("chartRangeMax")),this.zeroAxis=S=Af.get("zeroAxis",!0),T<=0&&U>=0&&S?Ar=0:S==0?Ar=T:T>0?Ar=T:Ar=U,this.xaxisOffset=Ar,N=Ak?F.max.apply(F,Al)+F.max.apply(F,Am):U-T,this.canvasHeightEf=S&&T<0?this.canvasHeight-2:this.canvasHeight-1,T<Ar?(Av=Ak&&U>=0?Ad:U,Au=(Av-Ar)/N*this.canvasHeight,Au!==F.ceil(Au)&&(this.canvasHeightEf-=2,Au=F.ceil(Au))):Au=this.canvasHeight,this.yoffset=Au,Ab.isArray(Af.get("colorMap"))?(this.colorMapByIndex=Af.get("colorMap"),this.colorMapByValue=null):(this.colorMapByIndex=null,this.colorMapByValue=Af.get("colorMap"),this.colorMapByValue&&this.colorMapByValue.get===D&&(this.colorMapByValue=new v(this.colorMapByValue))),this.range=N},getRegion:function(M,O,P){var N=F.floor(O/this.totalBarWidth);return N<0||N>=this.values.length?D:N},getCurrentRegionFields:function(){var N=this.currentRegion,M=z(this.values[N]),O=[],P,Q;for(Q=M.length;Q--;){P=M[Q],O.push({isNull:P===null,value:P,color:this.calcColor(Q,P,N),offset:N})}return O},calcColor:function(O,N,R){var T=this.colorMapByIndex,M=this.colorMapByValue,P=this.options,Q,S;return this.stacked?Q=P.get("stackedBarColor"):Q=N<0?P.get("negBarColor"):P.get("barColor"),N===0&&P.get("zeroColor")!==D&&(Q=P.get("zeroColor")),M&&(S=M.get(N))?Q=S:T&&T.length>R&&(Q=T[R]),Ab.isArray(Q)?Q[O%Q.length]:Q},renderRegion:function(N,a){var Y=this.values[N],M=this.options,R=this.xaxisOffset,c=[],b=this.range,V=this.stacked,T=this.target,Z=N*this.totalBarWidth,W=this.canvasHeightEf,Ad=this.yoffset,Ae,Af,Ag,O,X,P,Q,Ah,U,S;Y=Ab.isArray(Y)?Y:[Y],Q=Y.length,Ah=Y[0],O=u(null,Y),S=u(R,Y,!0);if(O){return M.get("nullColor")?(Ag=a?M.get("nullColor"):this.calcHighlightColor(M.get("nullColor"),M),Ae=Ad>0?Ad-1:Ad,T.drawRect(Z,Ae,this.barWidth-1,0,Ag,Ag)):D}X=Ad;for(P=0;P<Q;P++){Ah=Y[P];if(V&&Ah===R){if(!S||U){continue}U=!0}b>0?Af=F.floor(W*(F.abs(Ah-R)/b))+1:Af=1,Ah<R||Ah===R&&Ad===0?(Ae=X,X+=Af):(Ae=Ad-Af,Ad-=Af),Ag=this.calcColor(P,Ah,N),a&&(Ag=this.calcHighlightColor(Ag,M)),c.push(T.drawRect(Z,Ae,this.barWidth-1,Af-1,Ag,Ag))}return c.length===1?c[0]:c}}),Ab.fn.sparkline.tristate=L=r(Ab.fn.sparkline._base,Ac,{type:"tristate",init:function(O,N,M,S,P){var Q=parseInt(M.get("barWidth"),10),R=parseInt(M.get("barSpacing"),10);L._super.init.call(this,O,N,M,S,P),this.regionShapes={},this.barWidth=Q,this.barSpacing=R,this.totalBarWidth=Q+R,this.values=Ab.map(N,Number),this.width=S=N.length*Q+(N.length-1)*R,Ab.isArray(M.get("colorMap"))?(this.colorMapByIndex=M.get("colorMap"),this.colorMapByValue=null):(this.colorMapByIndex=null,this.colorMapByValue=M.get("colorMap"),this.colorMapByValue&&this.colorMapByValue.get===D&&(this.colorMapByValue=new v(this.colorMapByValue))),this.initTarget()},getRegion:function(M,O,N){return F.floor(O/this.totalBarWidth)},getCurrentRegionFields:function(){var M=this.currentRegion;return{isNull:this.values[M]===D,value:this.values[M],color:this.calcColor(this.values[M],M),offset:M}},calcColor:function(N,P){var Q=this.values,M=this.options,R=this.colorMapByIndex,O=this.colorMapByValue,T,S;return O&&(S=O.get(N))?T=S:R&&R.length>P?T=R[P]:Q[P]<0?T=M.get("negBarColor"):Q[P]>0?T=M.get("posBarColor"):T=M.get("zeroBarColor"),T},renderRegion:function(M,W){var R=this.values,S=this.options,P=this.target,U,V,N,T,Q,O;U=P.pixelHeight,N=F.round(U/2),T=M*this.totalBarWidth,R[M]<0?(Q=N,V=N-1):R[M]>0?(Q=0,V=N-1):(Q=N-1,V=2),O=this.calcColor(R[M],M);if(O===null){return}return W&&(O=this.calcHighlightColor(O,S)),P.drawRect(T,Q,this.barWidth-1,V-1,O,O)}}),Ab.fn.sparkline.discrete=o=r(Ab.fn.sparkline._base,Ac,{type:"discrete",init:function(N,M,Q,O,P){o._super.init.call(this,N,M,Q,O,P),this.regionShapes={},this.values=M=Ab.map(M,Number),this.min=F.min.apply(F,M),this.max=F.max.apply(F,M),this.range=this.max-this.min,this.width=O=Q.get("width")==="auto"?M.length*2:this.width,this.interval=F.floor(O/M.length),this.itemWidth=O/M.length,Q.get("chartRangeMin")!==D&&(Q.get("chartRangeClip")||Q.get("chartRangeMin")<this.min)&&(this.min=Q.get("chartRangeMin")),Q.get("chartRangeMax")!==D&&(Q.get("chartRangeClip")||Q.get("chartRangeMax")>this.max)&&(this.max=Q.get("chartRangeMax")),this.initTarget(),this.target&&(this.lineHeight=Q.get("lineHeight")==="auto"?F.round(this.canvasHeight*0.3):Q.get("lineHeight"))},getRegion:function(M,O,N){return F.floor(O/this.itemWidth)},getCurrentRegionFields:function(){var M=this.currentRegion;return{isNull:this.values[M]===D,value:this.values[M],offset:M}},renderRegion:function(S,R){var Z=this.values,X=this.options,P=this.min,Q=this.max,b=this.range,N=this.interval,O=this.target,V=this.canvasHeight,U=this.lineHeight,M=V-U,T,Y,a,W;return Y=G(Z[S],P,Q),W=S*N,T=F.round(M-M*((Y-P)/b)),a=X.get("thresholdColor")&&Y<X.get("thresholdValue")?X.get("thresholdColor"):X.get("lineColor"),R&&(a=this.calcHighlightColor(a,X)),O.drawLine(W,T,W,T+U,a)}}),Ab.fn.sparkline.bullet=i=r(Ab.fn.sparkline._base,{type:"bullet",init:function(N,M,R,O,T){var P,Q,S;i._super.init.call(this,N,M,R,O,T),this.values=M=d(M),S=M.slice(),S[0]=S[0]===null?S[2]:S[0],S[1]=M[1]===null?S[2]:S[1],P=F.min.apply(F,M),Q=F.max.apply(F,M),R.get("base")===D?P=P<0?P:0:P=R.get("base"),this.min=P,this.max=Q,this.range=Q-P,this.shapes={},this.valueShapes={},this.regiondata={},this.width=O=R.get("width")==="auto"?"4.0em":O,this.target=this.$el.simpledraw(O,T,R.get("composite")),M.length||(this.disabled=!0),this.initTarget()},getRegion:function(N,M,O){var P=this.target.getShapeAt(N,M,O);return P!==D&&this.shapes[P]!==D?this.shapes[P]:D},getCurrentRegionFields:function(){var M=this.currentRegion;return{fieldkey:M.substr(0,1),value:this.values[M.substr(1)],region:M}},changeHighlight:function(N){var P=this.currentRegion,M=this.valueShapes[P],O;delete this.shapes[M];switch(P.substr(0,1)){case"r":O=this.renderRange(P.substr(1),N);break;case"p":O=this.renderPerformance(N);break;case"t":O=this.renderTarget(N)}this.valueShapes[P]=O.id,this.shapes[O.id]=P,this.target.replaceWithShape(M,O)},renderRange:function(N,M){var O=this.values[N],P=F.round(this.canvasWidth*((O-this.min)/this.range)),Q=this.options.get("rangeColors")[N-2];return M&&(Q=this.calcHighlightColor(Q,this.options)),this.target.drawRect(0,0,P-1,this.canvasHeight-1,Q,Q)},renderPerformance:function(N){var M=this.values[1],O=F.round(this.canvasWidth*((M-this.min)/this.range)),P=this.options.get("performanceColor");return N&&(P=this.calcHighlightColor(P,this.options)),this.target.drawRect(0,F.round(this.canvasHeight*0.3),O-1,F.round(this.canvasHeight*0.4)-1,P,P)},renderTarget:function(N){var O=this.values[0],P=F.round(this.canvasWidth*((O-this.min)/this.range)-this.options.get("targetWidth")/2),M=F.round(this.canvasHeight*0.1),R=this.canvasHeight-M*2,Q=this.options.get("targetColor");return N&&(Q=this.calcHighlightColor(Q,this.options)),this.target.drawRect(P,M,this.options.get("targetWidth")-1,R-1,Q,Q)},render:function(){var N=this.values.length,P=this.target,M,O;if(!i._super.render.call(this)){return}for(M=2;M<N;M++){O=this.renderRange(M).append(),this.shapes[O.id]="r"+M,this.valueShapes["r"+M]=O.id}this.values[1]!==null&&(O=this.renderPerformance().append(),this.shapes[O.id]="p1",this.valueShapes.p1=O.id),this.values[0]!==null&&(O=this.renderTarget().append(),this.shapes[O.id]="t0",this.valueShapes.t0=O.id),P.render()}}),Ab.fn.sparkline.pie=B=r(Ab.fn.sparkline._base,{type:"pie",init:function(O,N,M,S,P){var Q=0,R;B._super.init.call(this,O,N,M,S,P),this.shapes={},this.valueShapes={},this.values=N=Ab.map(N,Number),M.get("width")==="auto"&&(this.width=this.height);if(N.length>0){for(R=N.length;R--;){Q+=N[R]}}this.total=Q,this.initTarget(),this.radius=F.floor(F.min(this.canvasWidth,this.canvasHeight)/2)},getRegion:function(N,M,O){var P=this.target.getShapeAt(N,M,O);return P!==D&&this.shapes[P]!==D?this.shapes[P]:D},getCurrentRegionFields:function(){var M=this.currentRegion;return{isNull:this.values[M]===D,value:this.values[M],percent:this.values[M]/this.total*100,color:this.options.get("sliceColors")[M%this.options.get("sliceColors").length],offset:M}},changeHighlight:function(N){var P=this.currentRegion,M=this.renderSlice(P,N),O=this.valueShapes[P];delete this.shapes[O],this.target.replaceWithShape(O,M),this.valueShapes[P]=M.id,this.shapes[M.id]=P},renderSlice:function(P,a){var X=this.target,Q=this.options,Z=this.radius,b=Q.get("borderWidth"),M=Q.get("offset"),N=2*F.PI,O=this.values,R=this.total,S=M?2*F.PI*(M/360):0,T,U,Y,V,W;V=O.length;for(Y=0;Y<V;Y++){T=S,U=S,R>0&&(U=S+N*(O[Y]/R));if(P===Y){return W=Q.get("sliceColors")[Y%Q.get("sliceColors").length],a&&(W=this.calcHighlightColor(W,Q)),X.drawPieSlice(Z,Z,Z-b,T,U,D,W)}S=U}},render:function(){var O=this.target,P=this.values,M=this.options,S=this.radius,Q=M.get("borderWidth"),N,R;if(!B._super.render.call(this)){return}Q&&O.drawCircle(S,S,F.floor(S-Q/2),M.get("borderColor"),D,Q).append();for(R=P.length;R--;){P[R]&&(N=this.renderSlice(R).append(),this.valueShapes[R]=N.id,this.shapes[N.id]=R)}O.render()}}),Ab.fn.sparkline.box=e=r(Ab.fn.sparkline._base,{type:"box",init:function(N,P,M,O,Q){e._super.init.call(this,N,P,M,O,Q),this.values=Ab.map(P,Number),this.width=M.get("width")==="auto"?"4.0em":O,this.initTarget(),this.values.length||(this.disabled=1)},getRegion:function(){return 1},getCurrentRegionFields:function(){var M=[{field:"lq",value:this.quartiles[0]},{field:"med",value:this.quartiles[1]},{field:"uq",value:this.quartiles[2]}];return this.loutlier!==D&&M.push({field:"lo",value:this.loutlier}),this.routlier!==D&&M.push({field:"ro",value:this.routlier}),this.lwhisker!==D&&M.push({field:"lw",value:this.lwhisker}),this.rwhisker!==D&&M.push({field:"rw",value:this.rwhisker}),M},render:function(){var S=this.target,V=this.values,M=V.length,W=this.options,N=this.canvasWidth,R=this.canvasHeight,Ae=W.get("chartRangeMin")===D?F.min.apply(F,V):W.get("chartRangeMin"),X=W.get("chartRangeMax")===D?F.max.apply(F,V):W.get("chartRangeMax"),Y=0,T,Af,Ad,Z,a,b,c,O,U,P,Q;if(!e._super.render.call(this)){return}if(W.get("raw")){W.get("showOutliers")&&V.length>5?(Af=V[0],T=V[1],Z=V[2],a=V[3],b=V[4],c=V[5],O=V[6]):(T=V[0],Z=V[1],a=V[2],b=V[3],c=V[4])}else{V.sort(function(Ah,Ag){return Ah-Ag}),Z=A(V,1),a=A(V,2),b=A(V,3),Ad=b-Z;if(W.get("showOutliers")){T=c=D;for(U=0;U<M;U++){T===D&&V[U]>Z-Ad*W.get("outlierIQR")&&(T=V[U]),V[U]<b+Ad*W.get("outlierIQR")&&(c=V[U])}Af=V[0],O=V[M-1]}else{T=V[0],c=V[M-1]}}this.quartiles=[Z,a,b],this.lwhisker=T,this.rwhisker=c,this.loutlier=Af,this.routlier=O,Q=N/(X-Ae+1),W.get("showOutliers")&&(Y=F.ceil(W.get("spotRadius")),N-=2*F.ceil(W.get("spotRadius")),Q=N/(X-Ae+1),Af<T&&S.drawCircle((Af-Ae)*Q+Y,R/2,W.get("spotRadius"),W.get("outlierLineColor"),W.get("outlierFillColor")).append(),O>c&&S.drawCircle((O-Ae)*Q+Y,R/2,W.get("spotRadius"),W.get("outlierLineColor"),W.get("outlierFillColor")).append()),S.drawRect(F.round((Z-Ae)*Q+Y),F.round(R*0.1),F.round((b-Z)*Q),F.round(R*0.8),W.get("boxLineColor"),W.get("boxFillColor")).append(),S.drawLine(F.round((T-Ae)*Q+Y),F.round(R/2),F.round((Z-Ae)*Q+Y),F.round(R/2),W.get("lineColor")).append(),S.drawLine(F.round((T-Ae)*Q+Y),F.round(R/4),F.round((T-Ae)*Q+Y),F.round(R-R/4),W.get("whiskerColor")).append(),S.drawLine(F.round((c-Ae)*Q+Y),F.round(R/2),F.round((b-Ae)*Q+Y),F.round(R/2),W.get("lineColor")).append(),S.drawLine(F.round((c-Ae)*Q+Y),F.round(R/4),F.round((c-Ae)*Q+Y),F.round(R-R/4),W.get("whiskerColor")).append(),S.drawLine(F.round((a-Ae)*Q+Y),F.round(R*0.1),F.round((a-Ae)*Q+Y),F.round(R*0.9),W.get("medianColor")).append(),W.get("target")&&(P=F.ceil(W.get("spotRadius")),S.drawLine(F.round((W.get("target")-Ae)*Q+Y),F.round(R/2-P),F.round((W.get("target")-Ae)*Q+Y),F.round(R/2+P),W.get("targetColor")).append(),S.drawLine(F.round((W.get("target")-Ae)*Q+Y-P),F.round(R/2),F.round((W.get("target")-Ae)*Q+Y+P),F.round(R/2),W.get("targetColor")).append()),S.render()}}),m=r({init:function(N,P,M,O){this.target=N,this.id=P,this.type=M,this.args=O},append:function(){return this.target.appendShape(this),this}}),j=r({_pxregex:/(\d+)(px)?\s*$/i,init:function(M,N,O){if(!M){return}this.width=M,this.height=N,this.target=O,this.lastShapeId=null,O[0]&&(O=O[0]),Ab.data(O,"_jqs_vcanvas",this)},drawLine:function(N,M,O,P,Q,R){return this.drawShape([[N,M],[O,P]],Q,R)},drawShape:function(N,P,M,O){return this._genShape("Shape",[N,P,M,O])},drawCircle:function(N,M,O,P,Q,R){return this._genShape("Circle",[N,M,O,P,Q,R])},drawPieSlice:function(O,N,M,P,Q,S,R){return this._genShape("PieSlice",[O,N,M,P,Q,S,R])},drawRect:function(N,M,O,P,Q,R){return this._genShape("Rect",[N,M,O,P,Q,R])},getElement:function(){return this.canvas},getLastShapeId:function(){return this.lastShapeId},reset:function(){alert("reset not implemented")},_insert:function(N,M){Ab(M).html(N)},_calculatePixelDims:function(N,P,M){var O;O=this._pxregex.exec(P),O?this.pixelHeight=O[1]:this.pixelHeight=Ab(M).height(),O=this._pxregex.exec(N),O?this.pixelWidth=O[1]:this.pixelWidth=Ab(M).width()},_genShape:function(M,N){var O=h++;return N.unshift(O),new m(this,O,M,N)},appendShape:function(M){alert("appendShape not implemented")},replaceWithShape:function(N,M){alert("replaceWithShape not implemented")},insertAfterShape:function(N,M){alert("insertAfterShape not implemented")},removeShapeId:function(M){alert("removeShapeId not implemented")},getShapeAt:function(M,N,O){alert("getShapeAt not implemented")},render:function(){alert("render not implemented")}}),k=r(j,{init:function(M,P,N,O){k._super.init.call(this,M,P,N),this.canvas=E.createElement("canvas"),N[0]&&(N=N[0]),Ab.data(N,"_jqs_vcanvas",this),Ab(this.canvas).css({display:"inline-block",width:M,height:P,verticalAlign:"top"}),this._insert(this.canvas,N),this._calculatePixelDims(M,P,this.canvas),this.canvas.width=this.pixelWidth,this.canvas.height=this.pixelHeight,this.interact=O,this.shapes={},this.shapeseq=[],this.currentTargetShapeId=D,Ab(this.canvas).css({width:this.pixelWidth,height:this.pixelHeight})},_getContext:function(N,M,O){var P=this.canvas.getContext("2d");return N!==D&&(P.strokeStyle=N),P.lineWidth=O===D?1:O,M!==D&&(P.fillStyle=M),P},reset:function(){var M=this._getContext();M.clearRect(0,0,this.pixelWidth,this.pixelHeight),this.shapes={},this.shapeseq=[],this.currentTargetShapeId=D},_drawShape:function(N,Q,M,R,O){var T=this._getContext(M,R,O),S,P;T.beginPath(),T.moveTo(Q[0][0]+0.5,Q[0][1]+0.5);for(S=1,P=Q.length;S<P;S++){T.lineTo(Q[S][0]+0.5,Q[S][1]+0.5)}M!==D&&T.stroke(),R!==D&&T.fill(),this.targetX!==D&&this.targetY!==D&&T.isPointInPath(this.targetX,this.targetY)&&(this.currentTargetShapeId=N)},_drawCircle:function(N,M,R,O,T,P,Q){var S=this._getContext(T,P,Q);S.beginPath(),S.arc(M,R,O,0,2*F.PI,!1),this.targetX!==D&&this.targetY!==D&&S.isPointInPath(this.targetX,this.targetY)&&(this.currentTargetShapeId=N),T!==D&&S.stroke(),P!==D&&S.fill()},_drawPieSlice:function(O,N,P,S,U,M,Q,R){var T=this._getContext(Q,R);T.beginPath(),T.moveTo(N,P),T.arc(N,P,S,U,M,!1),T.lineTo(N,P),T.closePath(),Q!==D&&T.stroke(),R&&T.fill(),this.targetX!==D&&this.targetY!==D&&T.isPointInPath(this.targetX,this.targetY)&&(this.currentTargetShapeId=O)},_drawRect:function(O,N,M,P,Q,S,R){return this._drawShape(O,[[N,M],[N+P,M],[N+P,M+Q],[N,M+Q],[N,M]],S,R)},appendShape:function(M){return this.shapes[M.id]=M,this.shapeseq.push(M.id),this.lastShapeId=M.id,M.id},replaceWithShape:function(N,P){var M=this.shapeseq,O;this.shapes[P.id]=P;for(O=M.length;O--;){M[O]==N&&(M[O]=P.id)}delete this.shapes[N]},replaceWithShapes:function(O,N){var M=this.shapeseq,P={},Q,S,R;for(S=O.length;S--;){P[O[S]]=!0}for(S=M.length;S--;){Q=M[S],P[Q]&&(M.splice(S,1),delete this.shapes[Q],R=S)}for(S=N.length;S--;){M.splice(R,0,N[S].id),this.shapes[N[S].id]=N[S]}},insertAfterShape:function(N,P){var M=this.shapeseq,O;for(O=M.length;O--;){if(M[O]===N){M.splice(O+1,0,P.id),this.shapes[P.id]=P;return}}},removeShapeId:function(M){var N=this.shapeseq,O;for(O=N.length;O--;){if(N[O]===M){N.splice(O,1);break}}delete this.shapes[M]},getShapeAt:function(M,N,O){return this.targetX=N,this.targetY=O,this.render(),this.currentTargetShapeId},render:function(){var O=this.shapeseq,N=this.shapes,M=O.length,P=this._getContext(),Q,S,R;P.clearRect(0,0,this.pixelWidth,this.pixelHeight);for(R=0;R<M;R++){Q=O[R],S=N[Q],this["_draw"+S.type].apply(this,S.args)}this.interact||(this.shapes={},this.shapeseq=[])}}),q=r(j,{init:function(P,M,O){var N;q._super.init.call(this,P,M,O),O[0]&&(O=O[0]),Ab.data(O,"_jqs_vcanvas",this),this.canvas=E.createElement("span"),Ab(this.canvas).css({display:"inline-block",position:"relative",overflow:"hidden",width:P,height:M,margin:"0px",padding:"0px",verticalAlign:"top"}),this._insert(this.canvas,O),this._calculatePixelDims(P,M,this.canvas),this.canvas.width=this.pixelWidth,this.canvas.height=this.pixelHeight,N='<v:group coordorigin="0 0" coordsize="'+this.pixelWidth+" "+this.pixelHeight+'" style="position:absolute;top:0;left:0;width:'+this.pixelWidth+"px;height="+this.pixelHeight+'px;"></v:group>',this.canvas.insertAdjacentHTML("beforeEnd",N),this.group=Ab(this.canvas).children()[0],this.rendered=!1,this.prerender=""},_drawShape:function(V,R,M,X,O){var P=[],U,N,W,T,Y,Q,S;for(S=0,Q=R.length;S<Q;S++){P[S]=""+R[S][0]+","+R[S][1]}return U=P.splice(0,1),O=O===D?1:O,N=M===D?' stroked="false" ':' strokeWeight="'+O+'px" strokeColor="'+M+'" ',W=X===D?' filled="false"':' fillColor="'+X+'" filled="true" ',T=P[0]===P[P.length-1]?"x ":"",Y='<v:shape coordorigin="0 0" coordsize="'+this.pixelWidth+" "+this.pixelHeight+'"  id="jqsshape'+V+'" '+N+W+' style="position:absolute;left:0px;top:0px;height:'+this.pixelHeight+"px;width:"+this.pixelWidth+'px;padding:0px;margin:0px;"  path="m '+U+" l "+P.join(", ")+" "+T+'e"> </v:shape>',Y},_drawCircle:function(V,O,T,S,M,P,R){var N,U,Q;return O-=S,T-=S,N=M===D?' stroked="false" ':' strokeWeight="'+R+'px" strokeColor="'+M+'" ',U=P===D?' filled="false"':' fillColor="'+P+'" filled="true" ',Q='<v:oval  id="jqsshape'+V+'" '+N+U+' style="position:absolute;top:'+T+"px; left:"+O+"px; width:"+S*2+"px; height:"+S*2+'px"></v:oval>',Q},_drawPieSlice:function(P,a,X,Q,Z,b,M,N){var O,R,S,T,U,Y,V,W;if(Z===b){return""}b-Z===2*F.PI&&(Z=0,b=2*F.PI),R=a+F.round(F.cos(Z)*Q),S=X+F.round(F.sin(Z)*Q),T=a+F.round(F.cos(b)*Q),U=X+F.round(F.sin(b)*Q);if(R===T&&S===U){if(b-Z<F.PI){return""}R=T=a+Q,S=U=X}return R===T&&S===U&&b-Z<F.PI?"":(O=[a-Q,X-Q,a+Q,X+Q,R,S,T,U],Y=M===D?' stroked="false" ':' strokeWeight="1px" strokeColor="'+M+'" ',V=N===D?' filled="false"':' fillColor="'+N+'" filled="true" ',W='<v:shape coordorigin="0 0" coordsize="'+this.pixelWidth+" "+this.pixelHeight+'"  id="jqsshape'+P+'" '+Y+V+' style="position:absolute;left:0px;top:0px;height:'+this.pixelHeight+"px;width:"+this.pixelWidth+'px;padding:0px;margin:0px;"  path="m '+a+","+X+" wa "+O.join(", ")+' x e"> </v:shape>',W)},_drawRect:function(O,N,M,P,Q,S,R){return this._drawShape(O,[[N,M],[N,M+Q],[N+P,M+Q],[N+P,M],[N,M]],S,R)},reset:function(){this.group.innerHTML=""},appendShape:function(N){var M=this["_draw"+N.type].apply(this,N.args);return this.rendered?this.group.insertAdjacentHTML("beforeEnd",M):this.prerender+=M,this.lastShapeId=N.id,N.id},replaceWithShape:function(N,P){var M=Ab("#jqsshape"+N),O=this["_draw"+P.type].apply(this,P.args);M[0].outerHTML=O},replaceWithShapes:function(N,M){var O=Ab("#jqsshape"+N[0]),P="",R=M.length,Q;for(Q=0;Q<R;Q++){P+=this["_draw"+M[Q].type].apply(this,M[Q].args)}O[0].outerHTML=P;for(Q=1;Q<N.length;Q++){Ab("#jqsshape"+N[Q]).remove()}},insertAfterShape:function(N,P){var M=Ab("#jqsshape"+N),O=this["_draw"+P.type].apply(this,P.args);M[0].insertAdjacentHTML("afterEnd",O)},removeShapeId:function(N){var M=Ab("#jqsshape"+N);this.group.removeChild(M[0])},getShapeAt:function(N,P,M){var O=N.id.substr(8);return O},render:function(){this.rendered||(this.group.innerHTML=this.prerender,this.rendered=!0)}})})})(document,Math);