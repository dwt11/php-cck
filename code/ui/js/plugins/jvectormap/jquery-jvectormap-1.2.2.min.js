(function(D){var C={set:{colors:1,values:1,backgroundColor:1,scaleColors:1,normalizeFunction:1,focus:1},get:{selectedRegions:1,selectedMarkers:1,mapObject:1,regionName:1}};D.fn.vectorMap=function(B){var G,H,A,G=this.children(".jvectormap-container").data("mapObject");if(B==="addMap"){jvm.WorldMap.maps[arguments[1]]=arguments[2]}else{if(!(B!=="set"&&B!=="get"||!C[B][arguments[1]])){return H=arguments[1].charAt(0).toUpperCase()+arguments[1].substr(1),G[B+H].apply(G,Array.prototype.slice.call(arguments,2))}B=B||{},B.container=this,G=new jvm.WorldMap(B)}return this}})(jQuery),function(F){function H(N){var A=N||window.event,D=[].slice.call(arguments,1),B=0,M=!0,C=0,L=0;return N=F.event.fix(A),N.type="mousewheel",A.wheelDelta&&(B=A.wheelDelta/120),A.detail&&(B=-A.detail/3),L=B,A.axis!==undefined&&A.axis===A.HORIZONTAL_AXIS&&(L=0,C=-1*B),A.wheelDeltaY!==undefined&&(L=A.wheelDeltaY/120),A.wheelDeltaX!==undefined&&(C=-1*A.wheelDeltaX/120),D.unshift(N,B,C,L),(F.event.dispatch||F.event.handle).apply(this,D)}var E=["DOMMouseScroll","mousewheel"];if(F.event.fixHooks){for(var G=E.length;G;){F.event.fixHooks[E[--G]]=F.event.mouseHooks}}F.event.special.mousewheel={setup:function(){if(this.addEventListener){for(var A=E.length;A;){this.addEventListener(E[--A],H,!1)}}else{this.onmousewheel=H}},teardown:function(){if(this.removeEventListener){for(var A=E.length;A;){this.removeEventListener(E[--A],H,!1)}}else{this.onmousewheel=null}}},F.fn.extend({mousewheel:function(A){return A?this.bind("mousewheel",A):this.trigger("mousewheel")},unmousewheel:function(A){return this.unbind("mousewheel",A)}})}(jQuery);var jvm={inherits:function(F,E){function D(){}D.prototype=E.prototype,F.prototype=new D,F.prototype.constructor=F,F.parentClass=E},mixin:function(F,E){var D;for(D in E.prototype){E.prototype.hasOwnProperty(D)&&(F.prototype[D]=E.prototype[D])}},min:function(F){var E=Number.MAX_VALUE,D;if(F instanceof Array){for(D=0;D<F.length;D++){F[D]<E&&(E=F[D])}}else{for(D in F){F[D]<E&&(E=F[D])}}return E},max:function(F){var E=Number.MIN_VALUE,D;if(F instanceof Array){for(D=0;D<F.length;D++){F[D]>E&&(E=F[D])}}else{for(D in F){F[D]>E&&(E=F[D])}}return E},keys:function(F){var E=[],D;for(D in F){E.push(D)}return E},values:function(F){var E=[],G,H;for(H=0;H<arguments.length;H++){F=arguments[H];for(G in F){E.push(F[G])}}return E}};jvm.$=jQuery,jvm.AbstractElement=function(D,C){this.node=this.createElement(D),this.name=D,this.properties={},C&&this.set(C)},jvm.AbstractElement.prototype.set=function(F,E){var D;if(typeof F=="object"){for(D in F){this.properties[D]=F[D],this.applyAttr(D,F[D])}}else{this.properties[F]=E,this.applyAttr(F,E)}},jvm.AbstractElement.prototype.get=function(B){return this.properties[B]},jvm.AbstractElement.prototype.applyAttr=function(D,C){this.node.setAttribute(D,C)},jvm.AbstractElement.prototype.remove=function(){jvm.$(this.node).remove()},jvm.AbstractCanvasElement=function(F,E,D){this.container=F,this.setSize(E,D),this.rootElement=new jvm[this.classPrefix+"GroupElement"],this.node.appendChild(this.rootElement.node),this.container.appendChild(this.node)},jvm.AbstractCanvasElement.prototype.add=function(D,C){C=C||this.rootElement,C.add(D),D.canvas=this},jvm.AbstractCanvasElement.prototype.addPath=function(F,E,G){var H=new jvm[this.classPrefix+"PathElement"](F,E);return this.add(H,G),H},jvm.AbstractCanvasElement.prototype.addCircle=function(F,E,G){var H=new jvm[this.classPrefix+"CircleElement"](F,E);return this.add(H,G),H},jvm.AbstractCanvasElement.prototype.addGroup=function(D){var C=new jvm[this.classPrefix+"GroupElement"];return D?D.node.appendChild(C.node):this.node.appendChild(C.node),C.canvas=this,C},jvm.AbstractShapeElement=function(F,E,D){this.style=D||{},this.style.current={},this.isHovered=!1,this.isSelected=!1,this.updateStyle()},jvm.AbstractShapeElement.prototype.setHovered=function(B){this.isHovered!==B&&(this.isHovered=B,this.updateStyle())},jvm.AbstractShapeElement.prototype.setSelected=function(B){this.isSelected!==B&&(this.isSelected=B,this.updateStyle(),jvm.$(this.node).trigger("selected",[B]))},jvm.AbstractShapeElement.prototype.setStyle=function(F,E){var D={};typeof F=="object"?D=F:D[F]=E,jvm.$.extend(this.style.current,D),this.updateStyle()},jvm.AbstractShapeElement.prototype.updateStyle=function(){var B={};jvm.AbstractShapeElement.mergeStyles(B,this.style.initial),jvm.AbstractShapeElement.mergeStyles(B,this.style.current),this.isHovered&&jvm.AbstractShapeElement.mergeStyles(B,this.style.hover),this.isSelected&&(jvm.AbstractShapeElement.mergeStyles(B,this.style.selected),this.isHovered&&jvm.AbstractShapeElement.mergeStyles(B,this.style.selectedHover)),this.set(B)},jvm.AbstractShapeElement.mergeStyles=function(F,E){var D;E=E||{};for(D in E){E[D]===null?delete F[D]:F[D]=E[D]}},jvm.SVGElement=function(D,C){jvm.SVGElement.parentClass.apply(this,arguments)},jvm.inherits(jvm.SVGElement,jvm.AbstractElement),jvm.SVGElement.svgns="http://www.w3.org/2000/svg",jvm.SVGElement.prototype.createElement=function(B){return document.createElementNS(jvm.SVGElement.svgns,B)},jvm.SVGElement.prototype.addClass=function(B){this.node.setAttribute("class",B)},jvm.SVGElement.prototype.getElementCtr=function(B){return jvm["SVG"+B]},jvm.SVGElement.prototype.getBBox=function(){return this.node.getBBox()},jvm.SVGGroupElement=function(){jvm.SVGGroupElement.parentClass.call(this,"g")},jvm.inherits(jvm.SVGGroupElement,jvm.SVGElement),jvm.SVGGroupElement.prototype.add=function(B){this.node.appendChild(B.node)},jvm.SVGCanvasElement=function(F,E,D){this.classPrefix="SVG",jvm.SVGCanvasElement.parentClass.call(this,"svg"),jvm.AbstractCanvasElement.apply(this,arguments)},jvm.inherits(jvm.SVGCanvasElement,jvm.SVGElement),jvm.mixin(jvm.SVGCanvasElement,jvm.AbstractCanvasElement),jvm.SVGCanvasElement.prototype.setSize=function(D,C){this.width=D,this.height=C,this.node.setAttribute("width",D),this.node.setAttribute("height",C)},jvm.SVGCanvasElement.prototype.applyTransformParams=function(F,E,D){this.scale=F,this.transX=E,this.transY=D,this.rootElement.node.setAttribute("transform","scale("+F+") translate("+E+", "+D+")")},jvm.SVGShapeElement=function(F,E,D){jvm.SVGShapeElement.parentClass.call(this,F,E),jvm.AbstractShapeElement.apply(this,arguments)},jvm.inherits(jvm.SVGShapeElement,jvm.SVGElement),jvm.mixin(jvm.SVGShapeElement,jvm.AbstractShapeElement),jvm.SVGPathElement=function(D,C){jvm.SVGPathElement.parentClass.call(this,"path",D,C),this.node.setAttribute("fill-rule","evenodd")},jvm.inherits(jvm.SVGPathElement,jvm.SVGShapeElement),jvm.SVGCircleElement=function(D,C){jvm.SVGCircleElement.parentClass.call(this,"circle",D,C)},jvm.inherits(jvm.SVGCircleElement,jvm.SVGShapeElement),jvm.VMLElement=function(D,C){jvm.VMLElement.VMLInitialized||jvm.VMLElement.initializeVML(),jvm.VMLElement.parentClass.apply(this,arguments)},jvm.inherits(jvm.VMLElement,jvm.AbstractElement),jvm.VMLElement.VMLInitialized=!1,jvm.VMLElement.initializeVML=function(){try{document.namespaces.rvml||document.namespaces.add("rvml","urn:schemas-microsoft-com:vml"),jvm.VMLElement.prototype.createElement=function(A){return document.createElement("<rvml:"+A+' class="rvml">')}}catch(B){jvm.VMLElement.prototype.createElement=function(A){return document.createElement("<"+A+' xmlns="urn:schemas-microsoft.com:vml" class="rvml">')}}document.createStyleSheet().addRule(".rvml","behavior:url(#default#VML)"),jvm.VMLElement.VMLInitialized=!0},jvm.VMLElement.prototype.getElementCtr=function(B){return jvm["VML"+B]},jvm.VMLElement.prototype.addClass=function(B){jvm.$(this.node).addClass(B)},jvm.VMLElement.prototype.applyAttr=function(D,C){this.node[D]=C},jvm.VMLElement.prototype.getBBox=function(){var B=jvm.$(this.node);return{x:B.position().left/this.canvas.scale,y:B.position().top/this.canvas.scale,width:B.width()/this.canvas.scale,height:B.height()/this.canvas.scale}},jvm.VMLGroupElement=function(){jvm.VMLGroupElement.parentClass.call(this,"group"),this.node.style.left="0px",this.node.style.top="0px",this.node.coordorigin="0 0"},jvm.inherits(jvm.VMLGroupElement,jvm.VMLElement),jvm.VMLGroupElement.prototype.add=function(B){this.node.appendChild(B.node)},jvm.VMLCanvasElement=function(F,E,D){this.classPrefix="VML",jvm.VMLCanvasElement.parentClass.call(this,"group"),jvm.AbstractCanvasElement.apply(this,arguments),this.node.style.position="absolute"},jvm.inherits(jvm.VMLCanvasElement,jvm.VMLElement),jvm.mixin(jvm.VMLCanvasElement,jvm.AbstractCanvasElement),jvm.VMLCanvasElement.prototype.setSize=function(J,G){var K,L,H,I;this.width=J,this.height=G,this.node.style.width=J+"px",this.node.style.height=G+"px",this.node.coordsize=J+" "+G,this.node.coordorigin="0 0";if(this.rootElement){K=this.rootElement.node.getElementsByTagName("shape");for(H=0,I=K.length;H<I;H++){K[H].coordsize=J+" "+G,K[H].style.width=J+"px",K[H].style.height=G+"px"}L=this.node.getElementsByTagName("group");for(H=0,I=L.length;H<I;H++){L[H].coordsize=J+" "+G,L[H].style.width=J+"px",L[H].style.height=G+"px"}}},jvm.VMLCanvasElement.prototype.applyTransformParams=function(F,E,D){this.scale=F,this.transX=E,this.transY=D,this.rootElement.node.coordorigin=this.width-E-this.width/100+","+(this.height-D-this.height/100),this.rootElement.node.coordsize=this.width/F+","+this.height/F},jvm.VMLShapeElement=function(D,C){jvm.VMLShapeElement.parentClass.call(this,D,C),this.fillElement=new jvm.VMLElement("fill"),this.strokeElement=new jvm.VMLElement("stroke"),this.node.appendChild(this.fillElement.node),this.node.appendChild(this.strokeElement.node),this.node.stroked=!1,jvm.AbstractShapeElement.apply(this,arguments)},jvm.inherits(jvm.VMLShapeElement,jvm.VMLElement),jvm.mixin(jvm.VMLShapeElement,jvm.AbstractShapeElement),jvm.VMLShapeElement.prototype.applyAttr=function(D,C){switch(D){case"fill":this.node.fillcolor=C;break;case"fill-opacity":this.fillElement.node.opacity=Math.round(C*100)+"%";break;case"stroke":C==="none"?this.node.stroked=!1:this.node.stroked=!0,this.node.strokecolor=C;break;case"stroke-opacity":this.strokeElement.node.opacity=Math.round(C*100)+"%";break;case"stroke-width":parseInt(C,10)===0?this.node.stroked=!1:this.node.stroked=!0,this.node.strokeweight=C;break;case"d":this.node.path=jvm.VMLPathElement.pathSvgToVml(C);break;default:jvm.VMLShapeElement.parentClass.prototype.applyAttr.apply(this,arguments)}},jvm.VMLPathElement=function(F,E){var D=new jvm.VMLElement("skew");jvm.VMLPathElement.parentClass.call(this,"shape",F,E),this.node.coordorigin="0 0",D.node.on=!0,D.node.matrix="0.01,0,0,0.01,0,0",D.node.offset="0,0",this.node.appendChild(D.node)},jvm.inherits(jvm.VMLPathElement,jvm.VMLShapeElement),jvm.VMLPathElement.prototype.applyAttr=function(D,C){D==="d"?this.node.path=jvm.VMLPathElement.pathSvgToVml(C):jvm.VMLShapeElement.prototype.applyAttr.call(this,D,C)},jvm.VMLPathElement.pathSvgToVml=function(J){var G="",K=0,L=0,H,I;return J=J.replace(/(-?\d+)e(-?\d+)/g,"0"),J.replace(/([MmLlHhVvCcSs])\s*((?:-?\d*(?:\.\d+)?\s*,?\s*)+)/g,function(B,C,A,F){A=A.replace(/(\d)-/g,"$1,-").replace(/^\s+/g,"").replace(/\s+$/g,"").replace(/\s+/g,",").split(","),A[0]||A.shift();for(var E=0,D=A.length;E<D;E++){A[E]=Math.round(100*A[E])}switch(C){case"m":return K+=A[0],L+=A[1],"t"+A.join(",");case"M":return K=A[0],L=A[1],"m"+A.join(",");case"l":return K+=A[0],L+=A[1],"r"+A.join(",");case"L":return K=A[0],L=A[1],"l"+A.join(",");case"h":return K+=A[0],"r"+A[0]+",0";case"H":return K=A[0],"l"+K+","+L;case"v":return L+=A[0],"r0,"+A[0];case"V":return L=A[0],"l"+K+","+L;case"c":return H=K+A[A.length-4],I=L+A[A.length-3],K+=A[A.length-2],L+=A[A.length-1],"v"+A.join(",");case"C":return H=A[A.length-4],I=A[A.length-3],K=A[A.length-2],L=A[A.length-1],"c"+A.join(",");case"s":return A.unshift(L-I),A.unshift(K-H),H=K+A[A.length-4],I=L+A[A.length-3],K+=A[A.length-2],L+=A[A.length-1],"v"+A.join(",");case"S":return A.unshift(L+L-I),A.unshift(K+K-H),H=A[A.length-4],I=A[A.length-3],K=A[A.length-2],L=A[A.length-1],"c"+A.join(",")}return""}).replace(/z/g,"e")},jvm.VMLCircleElement=function(D,C){jvm.VMLCircleElement.parentClass.call(this,"oval",D,C)},jvm.inherits(jvm.VMLCircleElement,jvm.VMLShapeElement),jvm.VMLCircleElement.prototype.applyAttr=function(D,C){switch(D){case"r":this.node.style.width=C*2+"px",this.node.style.height=C*2+"px",this.applyAttr("cx",this.get("cx")||0),this.applyAttr("cy",this.get("cy")||0);break;case"cx":if(!C){return}this.node.style.left=C-(this.get("r")||0)+"px";break;case"cy":if(!C){return}this.node.style.top=C-(this.get("r")||0)+"px";break;default:jvm.VMLCircleElement.parentClass.prototype.applyAttr.call(this,D,C)}},jvm.VectorCanvas=function(F,E,D){return this.mode=window.SVGAngle?"svg":"vml",this.mode=="svg"?this.impl=new jvm.SVGCanvasElement(F,E,D):this.impl=new jvm.VMLCanvasElement(F,E,D),this.impl},jvm.SimpleScale=function(B){this.scale=B},jvm.SimpleScale.prototype.getValue=function(B){return B},jvm.OrdinalScale=function(B){this.scale=B},jvm.OrdinalScale.prototype.getValue=function(B){return this.scale[B]},jvm.NumericScale=function(F,E,G,H){this.scale=[],E=E||"linear",F&&this.setScale(F),E&&this.setNormalizeFunction(E),G&&this.setMin(G),H&&this.setMax(H)},jvm.NumericScale.prototype={setMin:function(B){this.clearMinValue=B,typeof this.normalize=="function"?this.minValue=this.normalize(B):this.minValue=B},setMax:function(B){this.clearMaxValue=B,typeof this.normalize=="function"?this.maxValue=this.normalize(B):this.maxValue=B},setScale:function(D){var C;for(C=0;C<D.length;C++){this.scale[C]=[D[C]]}},setNormalizeFunction:function(B){B==="polynomial"?this.normalize=function(A){return Math.pow(A,0.2)}:B==="linear"?delete this.normalize:this.normalize=B,this.setMin(this.clearMinValue),this.setMax(this.clearMaxValue)},getValue:function(J){var G=[],K=0,L,H=0,I;typeof this.normalize=="function"&&(J=this.normalize(J));for(H=0;H<this.scale.length-1;H++){L=this.vectorLength(this.vectorSubtract(this.scale[H+1],this.scale[H])),G.push(L),K+=L}I=(this.maxValue-this.minValue)/K;for(H=0;H<G.length;H++){G[H]*=I}H=0,J-=this.minValue;while(J-G[H]>=0){J-=G[H],H++}return H==this.scale.length-1?J=this.vectorToNum(this.scale[H]):J=this.vectorToNum(this.vectorAdd(this.scale[H],this.vectorMult(this.vectorSubtract(this.scale[H+1],this.scale[H]),J/G[H]))),J},vectorToNum:function(F){var E=0,D;for(D=0;D<F.length;D++){E+=Math.round(F[D])*Math.pow(256,F.length-D-1)}return E},vectorSubtract:function(F,E){var G=[],H;for(H=0;H<F.length;H++){G[H]=F[H]-E[H]}return G},vectorAdd:function(F,E){var G=[],H;for(H=0;H<F.length;H++){G[H]=F[H]+E[H]}return G},vectorMult:function(F,E){var G=[],H;for(H=0;H<F.length;H++){G[H]=F[H]*E}return G},vectorLength:function(F){var E=0,D;for(D=0;D<F.length;D++){E+=F[D]*F[D]}return Math.sqrt(E)}},jvm.ColorScale=function(F,E,G,H){jvm.ColorScale.parentClass.apply(this,arguments)},jvm.inherits(jvm.ColorScale,jvm.NumericScale),jvm.ColorScale.prototype.setScale=function(D){var C;for(C=0;C<D.length;C++){this.scale[C]=jvm.ColorScale.rgbToArray(D[C])}},jvm.ColorScale.prototype.getValue=function(B){return jvm.ColorScale.numToRgb(jvm.ColorScale.parentClass.prototype.getValue.call(this,B))},jvm.ColorScale.arrayToRgb=function(F){var E="#",G,H;for(H=0;H<F.length;H++){G=F[H].toString(16),E+=G.length==1?"0"+G:G}return E},jvm.ColorScale.numToRgb=function(B){B=B.toString(16);while(B.length<6){B="0"+B}return"#"+B},jvm.ColorScale.rgbToArray=function(B){return B=B.substr(1),[parseInt(B.substr(0,2),16),parseInt(B.substr(2,2),16),parseInt(B.substr(4,2),16)]},jvm.DataSeries=function(F,E){var D;F=F||{},F.attribute=F.attribute||"fill",this.elements=E,this.params=F,F.attributes&&this.setAttributes(F.attributes),jvm.$.isArray(F.scale)?(D=F.attribute==="fill"||F.attribute==="stroke"?jvm.ColorScale:jvm.NumericScale,this.scale=new D(F.scale,F.normalizeFunction,F.min,F.max)):F.scale?this.scale=new jvm.OrdinalScale(F.scale):this.scale=new jvm.SimpleScale(F.scale),this.values=F.values||{},this.setValues(this.values)},jvm.DataSeries.prototype={setAttributes:function(F,E){var G=F,H;if(typeof F=="string"){this.elements[F]&&this.elements[F].setStyle(this.params.attribute,E)}else{for(H in G){this.elements[H]&&this.elements[H].element.setStyle(this.params.attribute,G[H])}}},setValues:function(J){var G=Number.MIN_VALUE,K=Number.MAX_VALUE,L,H,I={};if(this.scale instanceof jvm.OrdinalScale||this.scale instanceof jvm.SimpleScale){for(H in J){J[H]?I[H]=this.scale.getValue(J[H]):I[H]=this.elements[H].element.style.initial[this.params.attribute]}}else{if(!this.params.min||!this.params.max){for(H in J){L=parseFloat(J[H]),L>G&&(G=J[H]),L<K&&(K=L)}this.params.min||this.scale.setMin(K),this.params.max||this.scale.setMax(G),this.params.min=K,this.params.max=G}for(H in J){L=parseFloat(J[H]),isNaN(L)?I[H]=this.elements[H].element.style.initial[this.params.attribute]:I[H]=this.scale.getValue(L)}}this.setAttributes(I),jvm.$.extend(this.values,J)},clear:function(){var D,C={};for(D in this.values){this.elements[D]&&(C[D]=this.elements[D].element.style.initial[this.params.attribute])}this.setAttributes(C),this.values={}},setScale:function(B){this.scale.setScale(B),this.values&&this.setValues(this.values)},setNormalizeFunction:function(B){this.scale.setNormalizeFunction(B),this.values&&this.setValues(this.values)}},jvm.Proj={degRad:180/Math.PI,radDeg:Math.PI/180,radius:6381372,sgn:function(B){return B>0?1:B<0?-1:B},mill:function(F,E,D){return{x:this.radius*(E-D)*this.radDeg,y:-this.radius*Math.log(Math.tan((45+0.4*F)*this.radDeg))/0.8}},mill_inv:function(F,E,D){return{lat:(2.5*Math.atan(Math.exp(0.8*E/this.radius))-5*Math.PI/8)*this.degRad,lng:(D*this.radDeg+F/this.radius)*this.degRad}},merc:function(F,E,D){return{x:this.radius*(E-D)*this.radDeg,y:-this.radius*Math.log(Math.tan(Math.PI/4+F*Math.PI/360))}},merc_inv:function(F,E,D){return{lat:(2*Math.atan(Math.exp(E/this.radius))-Math.PI/2)*this.degRad,lng:(D*this.radDeg+F/this.radius)*this.degRad}},aea:function(W,a,Q){var Z=0,P=Q*this.radDeg,U=29.5*this.radDeg,b=45.5*this.radDeg,X=W*this.radDeg,T=a*this.radDeg,R=(Math.sin(U)+Math.sin(b))/2,O=Math.cos(U)*Math.cos(U)+2*R*Math.sin(U),S=R*(T-P),Y=Math.sqrt(O-2*R*Math.sin(X))/R,V=Math.sqrt(O-2*R*Math.sin(Z))/R;return{x:Y*Math.sin(S)*this.radius,y:-(V-Y*Math.cos(S))*this.radius}},aea_inv:function(W,a,Q){var Z=W/this.radius,P=a/this.radius,U=0,b=Q*this.radDeg,X=29.5*this.radDeg,T=45.5*this.radDeg,R=(Math.sin(X)+Math.sin(T))/2,O=Math.cos(X)*Math.cos(X)+2*R*Math.sin(X),S=Math.sqrt(O-2*R*Math.sin(U))/R,Y=Math.sqrt(Z*Z+(S-P)*(S-P)),V=Math.atan(Z/(S-P));return{lat:Math.asin((O-Y*Y*R*R)/(2*R))*this.degRad,lng:(b+V/R)*this.degRad}},lcc:function(U,X,O){var T=0,W=O*this.radDeg,S=X*this.radDeg,P=33*this.radDeg,Y=45*this.radDeg,Q=U*this.radDeg,R=Math.log(Math.cos(P)*(1/Math.cos(Y)))/Math.log(Math.tan(Math.PI/4+Y/2)*(1/Math.tan(Math.PI/4+P/2))),Z=Math.cos(P)*Math.pow(Math.tan(Math.PI/4+P/2),R)/R,N=Z*Math.pow(1/Math.tan(Math.PI/4+Q/2),R),V=Z*Math.pow(1/Math.tan(Math.PI/4+T/2),R);return{x:N*Math.sin(R*(S-W))*this.radius,y:-(V-N*Math.cos(R*(S-W)))*this.radius}},lcc_inv:function(W,a,Q){var Z=W/this.radius,P=a/this.radius,U=0,b=Q*this.radDeg,X=33*this.radDeg,T=45*this.radDeg,R=Math.log(Math.cos(X)*(1/Math.cos(T)))/Math.log(Math.tan(Math.PI/4+T/2)*(1/Math.tan(Math.PI/4+X/2))),O=Math.cos(X)*Math.pow(Math.tan(Math.PI/4+X/2),R)/R,S=O*Math.pow(1/Math.tan(Math.PI/4+U/2),R),Y=this.sgn(R)*Math.sqrt(Z*Z+(S-P)*(S-P)),V=Math.atan(Z/(S-P));return{lat:(2*Math.atan(Math.pow(O/Y,1/R))-Math.PI/2)*this.degRad,lng:(b+V/R)*this.degRad}}},jvm.WorldMap=function(F){var E=this,D;this.params=jvm.$.extend(!0,{},jvm.WorldMap.defaultParams,F);if(!jvm.WorldMap.maps[this.params.map]){throw new Error("Attempt to use map which was not loaded: "+this.params.map)}this.mapData=jvm.WorldMap.maps[this.params.map],this.markers={},this.regions={},this.regionsColors={},this.regionsData={},this.container=jvm.$("<div>").css({width:"100%",height:"100%"}).addClass("jvectormap-container"),this.params.container.append(this.container),this.container.data("mapObject",this),this.container.css({position:"relative",overflow:"hidden"}),this.defaultWidth=this.mapData.width,this.defaultHeight=this.mapData.height,this.setBackgroundColor(this.params.backgroundColor),this.onResize=function(){E.setSize()},jvm.$(window).resize(this.onResize);for(D in jvm.WorldMap.apiEvents){this.params[D]&&this.container.bind(jvm.WorldMap.apiEvents[D]+".jvectormap",this.params[D])}this.canvas=new jvm.VectorCanvas(this.container[0],this.width,this.height),"ontouchstart" in window||window.DocumentTouch&&document instanceof DocumentTouch?this.params.bindTouchEvents&&this.bindContainerTouchEvents():this.bindContainerEvents(),this.bindElementEvents(),this.createLabel(),this.params.zoomButtons&&this.bindZoomButtons(),this.createRegions(),this.createMarkers(this.params.markers||{}),this.setSize(),this.params.focusOn&&(typeof this.params.focusOn=="object"?this.setFocus.call(this,this.params.focusOn.scale,this.params.focusOn.x,this.params.focusOn.y):this.setFocus.call(this,this.params.focusOn)),this.params.selectedRegions&&this.setSelectedRegions(this.params.selectedRegions),this.params.selectedMarkers&&this.setSelectedMarkers(this.params.selectedMarkers),this.params.series&&this.createSeries()},jvm.WorldMap.prototype={transX:0,transY:0,scale:1,baseTransX:0,baseTransY:0,baseScale:1,width:0,height:0,setBackgroundColor:function(B){this.container.css("background-color",B)},resize:function(){var B=this.baseScale;this.width/this.height>this.defaultWidth/this.defaultHeight?(this.baseScale=this.height/this.defaultHeight,this.baseTransX=Math.abs(this.width-this.defaultWidth*this.baseScale)/(2*this.baseScale)):(this.baseScale=this.width/this.defaultWidth,this.baseTransY=Math.abs(this.height-this.defaultHeight*this.baseScale)/(2*this.baseScale)),this.scale*=this.baseScale/B,this.transX*=this.baseScale/B,this.transY*=this.baseScale/B},setSize:function(){this.width=this.container.width(),this.height=this.container.height(),this.resize(),this.canvas.setSize(this.width,this.height),this.applyTransform()},reset:function(){var D,C;for(D in this.series){for(C=0;C<this.series[D].length;C++){this.series[D][C].clear()}}this.scale=this.baseScale,this.transX=this.baseTransX,this.transY=this.baseTransY,this.applyTransform()},applyTransform:function(){var F,E,G,H;this.defaultWidth*this.scale<=this.width?(F=(this.width-this.defaultWidth*this.scale)/(2*this.scale),G=(this.width-this.defaultWidth*this.scale)/(2*this.scale)):(F=0,G=(this.width-this.defaultWidth*this.scale)/this.scale),this.defaultHeight*this.scale<=this.height?(E=(this.height-this.defaultHeight*this.scale)/(2*this.scale),H=(this.height-this.defaultHeight*this.scale)/(2*this.scale)):(E=0,H=(this.height-this.defaultHeight*this.scale)/this.scale),this.transY>E?this.transY=E:this.transY<H&&(this.transY=H),this.transX>F?this.transX=F:this.transX<G&&(this.transX=G),this.canvas.applyTransformParams(this.scale,this.transX,this.transY),this.markers&&this.repositionMarkers(),this.container.trigger("viewportChange",[this.scale/this.baseScale,this.transX,this.transY])},bindContainerEvents:function(){var F=!1,E,G,H=this;this.container.mousemove(function(A){return F&&(H.transX-=(E-A.pageX)/H.scale,H.transY-=(G-A.pageY)/H.scale,H.applyTransform(),E=A.pageX,G=A.pageY),!1}).mousedown(function(A){return F=!0,E=A.pageX,G=A.pageY,!1}),jvm.$("body").mouseup(function(){F=!1}),this.params.zoomOnScroll&&this.container.mousewheel(function(O,N,P,C){var M=jvm.$(H.container).offset(),A=O.pageX-M.left,B=O.pageY-M.top,D=Math.pow(1.3,C);H.label.hide(),H.setScale(H.scale*D,A,B),O.preventDefault()})},bindContainerTouchEvents:function(){var N,Q,P=this,M,O,L,J,R,K=function(B){var C=B.originalEvent.touches,D,E,F,A;B.type=="touchstart"&&(R=0),C.length==1?(R==1&&(F=P.transX,A=P.transY,P.transX-=(M-C[0].pageX)/P.scale,P.transY-=(O-C[0].pageY)/P.scale,P.applyTransform(),P.label.hide(),(F!=P.transX||A!=P.transY)&&B.preventDefault()),M=C[0].pageX,O=C[0].pageY):C.length==2&&(R==2?(E=Math.sqrt(Math.pow(C[0].pageX-C[1].pageX,2)+Math.pow(C[0].pageY-C[1].pageY,2))/Q,P.setScale(N*E,L,J),P.label.hide(),B.preventDefault()):(D=jvm.$(P.container).offset(),C[0].pageX>C[1].pageX?L=C[1].pageX+(C[0].pageX-C[1].pageX)/2:L=C[0].pageX+(C[1].pageX-C[0].pageX)/2,C[0].pageY>C[1].pageY?J=C[1].pageY+(C[0].pageY-C[1].pageY)/2:J=C[0].pageY+(C[1].pageY-C[0].pageY)/2,L-=D.left,J-=D.top,N=P.scale,Q=Math.sqrt(Math.pow(C[0].pageX-C[1].pageX,2)+Math.pow(C[0].pageY-C[1].pageY,2)))),R=C.length};jvm.$(this.container).bind("touchstart",K),jvm.$(this.container).bind("touchmove",K)},bindElementEvents:function(){var D=this,C;this.container.mousemove(function(){C=!0}),this.container.delegate("[class~='jvectormap-element']","mouseover mouseout",function(Q){var B=this,M=jvm.$(this).attr("class").baseVal?jvm.$(this).attr("class").baseVal:jvm.$(this).attr("class"),O=M.indexOf("jvectormap-region")===-1?"marker":"region",P=O=="region"?jvm.$(this).attr("data-code"):jvm.$(this).attr("data-index"),L=O=="region"?D.regions[P].element:D.markers[P].element,N=O=="region"?D.mapData.paths[P].name:D.markers[P].config.name||"",R=jvm.$.Event(O+"LabelShow.jvectormap"),A=jvm.$.Event(O+"Over.jvectormap");Q.type=="mouseover"?(D.container.trigger(A,[P]),A.isDefaultPrevented()||L.setHovered(!0),D.label.text(N),D.container.trigger(R,[D.label,P]),R.isDefaultPrevented()||(D.label.show(),D.labelWidth=D.label.width(),D.labelHeight=D.label.height())):(L.setHovered(!1),D.label.hide(),D.container.trigger(O+"Out.jvectormap",[P]))}),this.container.delegate("[class~='jvectormap-element']","mousedown",function(A){C=!1}),this.container.delegate("[class~='jvectormap-element']","mouseup",function(J){var L=this,K=jvm.$(this).attr("class").baseVal?jvm.$(this).attr("class").baseVal:jvm.$(this).attr("class"),A=K.indexOf("jvectormap-region")===-1?"marker":"region",B=A=="region"?jvm.$(this).attr("data-code"):jvm.$(this).attr("data-index"),N=jvm.$.Event(A+"Click.jvectormap"),M=A=="region"?D.regions[B].element:D.markers[B].element;if(!C){D.container.trigger(N,[B]);if(A==="region"&&D.params.regionsSelectable||A==="marker"&&D.params.markersSelectable){N.isDefaultPrevented()||(D.params[A+"sSelectableOne"]&&D.clearSelected(A+"s"),M.setSelected(!M.isSelected))}}})},bindZoomButtons:function(){var B=this;jvm.$("<div/>").addClass("jvectormap-zoomin").text("+").appendTo(this.container),jvm.$("<div/>").addClass("jvectormap-zoomout").html("&#x2212;").appendTo(this.container),this.container.find(".jvectormap-zoomin").click(function(){B.setScale(B.scale*B.params.zoomStep,B.width/2,B.height/2)}),this.container.find(".jvectormap-zoomout").click(function(){B.setScale(B.scale/B.params.zoomStep,B.width/2,B.height/2)})},createLabel:function(){var B=this;this.label=jvm.$("<div/>").addClass("jvectormap-label").appendTo(jvm.$("body")),this.container.mousemove(function(A){var F=A.pageX-15-B.labelWidth,E=A.pageY-15-B.labelHeight;F<5&&(F=A.pageX+15),E<5&&(E=A.pageY+15),B.label.is(":visible")&&B.label.css({left:F,top:E})})},setScale:function(J,G,K,L){var H,I=jvm.$.Event("zoom.jvectormap");J>this.params.zoomMax*this.baseScale?J=this.params.zoomMax*this.baseScale:J<this.params.zoomMin*this.baseScale&&(J=this.params.zoomMin*this.baseScale),typeof G!="undefined"&&typeof K!="undefined"&&(H=J/this.scale,L?(this.transX=G+this.defaultWidth*(this.width/(this.defaultWidth*J))/2,this.transY=K+this.defaultHeight*(this.height/(this.defaultHeight*J))/2):(this.transX-=(H-1)/J*G,this.transY-=(H-1)/J*K)),this.scale=J,this.applyTransform(),this.container.trigger(I,[J/this.baseScale])},setFocus:function(L,O,N){var K,M,J,I,P;if(jvm.$.isArray(L)||this.regions[L]){jvm.$.isArray(L)?I=L:I=[L];for(P=0;P<I.length;P++){this.regions[I[P]]&&(M=this.regions[I[P]].element.getBBox(),M&&(typeof K=="undefined"?K=M:(J={x:Math.min(K.x,M.x),y:Math.min(K.y,M.y),width:Math.max(K.x+K.width,M.x+M.width)-Math.min(K.x,M.x),height:Math.max(K.y+K.height,M.y+M.height)-Math.min(K.y,M.y)},K=J)))}this.setScale(Math.min(this.width/K.width,this.height/K.height),-(K.x+K.width/2),-(K.y+K.height/2),!0)}else{L*=this.baseScale,this.setScale(L,-O*this.defaultWidth,-N*this.defaultHeight,!0)}},getSelected:function(F){var E,D=[];for(E in this[F]){this[F][E].element.isSelected&&D.push(E)}return D},getSelectedRegions:function(){return this.getSelected("regions")},getSelectedMarkers:function(){return this.getSelected("markers")},setSelected:function(F,E){var D;typeof E!="object"&&(E=[E]);if(jvm.$.isArray(E)){for(D=0;D<E.length;D++){this[F][E[D]].element.setSelected(!0)}}else{for(D in E){this[F][D].element.setSelected(!!E[D])}}},setSelectedRegions:function(B){this.setSelected("regions",B)},setSelectedMarkers:function(B){this.setSelected("markers",B)},clearSelected:function(F){var E={},G=this.getSelected(F),H;for(H=0;H<G.length;H++){E[G[H]]=!1}this.setSelected(F,E)},clearSelectedRegions:function(){this.clearSelected("regions")},clearSelectedMarkers:function(){this.clearSelected("markers")},getMapObject:function(){return this},getRegionName:function(B){return this.mapData.paths[B].name},createRegions:function(){var F,E,D=this;for(F in this.mapData.paths){E=this.canvas.addPath({d:this.mapData.paths[F].path,"data-code":F},jvm.$.extend(!0,{},this.params.regionStyle)),jvm.$(E.node).bind("selected",function(A,B){D.container.trigger("regionSelected.jvectormap",[jvm.$(this).attr("data-code"),B,D.getSelectedRegions()])}),E.addClass("jvectormap-region jvectormap-element"),this.regions[F]={element:E,config:this.mapData.paths[F]}}},createMarkers:function(L){var I,M,N,J,K,H=this;this.markersGroup=this.markersGroup||this.canvas.addGroup();if(jvm.$.isArray(L)){K=L.slice(),L={};for(I=0;I<K.length;I++){L[I]=K[I]}}for(I in L){J=L[I] instanceof Array?{latLng:L[I]}:L[I],N=this.getMarkerPosition(J),N!==!1&&(M=this.canvas.addCircle({"data-index":I,cx:N.x,cy:N.y},jvm.$.extend(!0,{},this.params.markerStyle,{initial:J.style||{}}),this.markersGroup),M.addClass("jvectormap-marker jvectormap-element"),jvm.$(M.node).bind("selected",function(A,B){H.container.trigger("markerSelected.jvectormap",[jvm.$(this).attr("data-index"),B,H.getSelectedMarkers()])}),this.markers[I]&&this.removeMarkers([I]),this.markers[I]={element:M,config:J})}},repositionMarkers:function(){var D,C;for(D in this.markers){C=this.getMarkerPosition(this.markers[D].config),C!==!1&&this.markers[D].element.setStyle({cx:C.x,cy:C.y})}},getMarkerPosition:function(B){return jvm.WorldMap.maps[this.params.map].projection?this.latLngToPoint.apply(this,B.latLng||[0,0]):{x:B.coords[0]*this.scale+this.transX*this.scale,y:B.coords[1]*this.scale+this.transY*this.scale}},addMarker:function(L,I,M){var N={},J=[],K,H,M=M||[];N[L]=I;for(H=0;H<M.length;H++){K={},K[L]=M[H],J.push(K)}this.addMarkers(N,J)},addMarkers:function(F,E){var D;E=E||[],this.createMarkers(F);for(D=0;D<E.length;D++){this.series.markers[D].setValues(E[D]||{})}},removeMarkers:function(D){var C;for(C=0;C<D.length;C++){this.markers[D[C]].element.remove(),delete this.markers[D[C]]}},removeAllMarkers:function(){var D,C=[];for(D in this.markers){C.push(D)}this.removeMarkers(C)},latLngToPoint:function(O,R){var Q,N=jvm.WorldMap.maps[this.params.map].projection,P=N.centralMeridian,M=this.width-this.baseTransX*2*this.baseScale,K=this.height-this.baseTransY*2*this.baseScale,S,L,T=this.scale/this.baseScale;return R<-180+P&&(R+=360),Q=jvm.Proj[N.type](O,R,P),S=this.getInsetForPoint(Q.x,Q.y),S?(L=S.bbox,Q.x=(Q.x-L[0].x)/(L[1].x-L[0].x)*S.width*this.scale,Q.y=(Q.y-L[0].y)/(L[1].y-L[0].y)*S.height*this.scale,{x:Q.x+this.transX*this.scale+S.left*this.scale,y:Q.y+this.transY*this.scale+S.top*this.scale}):!1},pointToLatLng:function(O,R){var Q=jvm.WorldMap.maps[this.params.map].projection,N=Q.centralMeridian,P=jvm.WorldMap.maps[this.params.map].insets,M,K,S,L,T;for(M=0;M<P.length;M++){K=P[M],S=K.bbox,L=O-(this.transX*this.scale+K.left*this.scale),T=R-(this.transY*this.scale+K.top*this.scale),L=L/(K.width*this.scale)*(S[1].x-S[0].x)+S[0].x,T=T/(K.height*this.scale)*(S[1].y-S[0].y)+S[0].y;if(L>S[0].x&&L<S[1].x&&T>S[0].y&&T<S[1].y){return jvm.Proj[Q.type+"_inv"](L,-T,N)}}return !1},getInsetForPoint:function(H,G){var I=jvm.WorldMap.maps[this.params.map].insets,J,F;for(J=0;J<I.length;J++){F=I[J].bbox;if(H>F[0].x&&H<F[1].x&&G>F[0].y&&G<F[1].y){return I[J]}}},createSeries:function(){var D,C;this.series={markers:[],regions:[]};for(C in this.params.series){for(D=0;D<this.params.series[C].length;D++){this.series[C][D]=new jvm.DataSeries(this.params.series[C][D],this[C])}}},remove:function(){this.label.remove(),this.container.remove(),jvm.$(window).unbind("resize",this.onResize)}},jvm.WorldMap.maps={},jvm.WorldMap.defaultParams={map:"world_mill_en",backgroundColor:"#505050",zoomButtons:!0,zoomOnScroll:!0,zoomMax:8,zoomMin:1,zoomStep:1.6,regionsSelectable:!1,markersSelectable:!1,bindTouchEvents:!0,regionStyle:{initial:{fill:"white","fill-opacity":1,stroke:"none","stroke-width":0,"stroke-opacity":1},hover:{"fill-opacity":0.8},selected:{fill:"yellow"},selectedHover:{}},markerStyle:{initial:{fill:"grey",stroke:"#505050","fill-opacity":1,"stroke-width":1,"stroke-opacity":1,r:5},hover:{stroke:"black","stroke-width":2},selected:{fill:"blue"},selectedHover:{}}},jvm.WorldMap.apiEvents={onRegionLabelShow:"regionLabelShow",onRegionOver:"regionOver",onRegionOut:"regionOut",onRegionClick:"regionClick",onRegionSelected:"regionSelected",onMarkerLabelShow:"markerLabelShow",onMarkerOver:"markerOver",onMarkerOut:"markerOut",onMarkerClick:"markerClick",onMarkerSelected:"markerSelected",onViewportChange:"viewportChange"};