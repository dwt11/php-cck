(function(D){D.gritter={};D.gritter.options={position:"",class_name:"",fade_in_speed:"medium",fade_out_speed:1000,time:6000};D.gritter.add=function(B){try{return C.add(B||{})}catch(F){var A="Gritter Error: "+F;(typeof(console)!="undefined"&&console.error)?console.error(A,B):alert(A)}};D.gritter.remove=function(B,A){C.removeSpecific(B,A||{})};D.gritter.removeAll=function(A){C.stop(A||{})};var C={position:"",fade_in_speed:"",fade_out_speed:"",time:"",_custom_timer:0,_item_count:0,_is_setup:0,_tpl_close:'<a class="gritter-close" href="#" tabindex="1">Close Notification</a>',_tpl_title:'<span class="gritter-title">[[title]]</span>',_tpl_item:'<div id="gritter-item-[[number]]" class="gritter-item-wrapper [[item_class]]" style="display:none" role="alert"><div class="gritter-top"></div><div class="gritter-item">[[close]][[image]]<div class="[[class_name]]">[[title]]<p>[[text]]</p></div><div style="clear:both"></div></div><div class="gritter-bottom"></div></div>',_tpl_wrap:'<div id="gritter-notice-wrapper"></div>',add:function(Q){if(typeof(Q)=="string"){Q={text:Q}}if(Q.text===null){throw'You must supply "text" parameter.'}if(!this._is_setup){this._runSetup()}var Y=Q.title,B=Q.text,U=Q.image||"",Z=Q.sticky||false,A=Q.class_name||D.gritter.options.class_name,X=D.gritter.options.position,R=Q.time||"";this._verifyWrapper();this._item_count++;var T=this._item_count,W=this._tpl_item;D(["before_open","after_open","before_close","after_close"]).each(function(E,F){C["_"+F+"_"+T]=(D.isFunction(Q[F]))?Q[F]:function(){}});this._custom_timer=0;if(R){this._custom_timer=R}var S=(U!="")?'<img alt="image" src="'+U+'" class="gritter-image" />':"",V=(U!="")?"gritter-with-image":"gritter-without-image";if(Y){Y=this._str_replace("[[title]]",Y,this._tpl_title)}else{Y=""}W=this._str_replace(["[[title]]","[[text]]","[[close]]","[[image]]","[[number]]","[[class_name]]","[[item_class]]"],[Y,B,this._tpl_close,S,this._item_count,V,A],W);if(this["_before_open_"+T]()===false){return false}D("#gritter-notice-wrapper").addClass(X).append(W);var P=D("#gritter-item-"+this._item_count);P.fadeIn(this.fade_in_speed,function(){C["_after_open_"+T](D(this))});if(!Z){this._setFadeTimer(P,T)}D(P).bind("mouseenter mouseleave",function(E){if(E.type=="mouseenter"){if(!Z){C._restoreItemIfFading(D(this),T)}}else{if(!Z){C._setFadeTimer(D(this),T)}}C._hoverState(D(this),E.type)});D(P).find(".gritter-close").click(function(){C.removeSpecific(T,{},null,true);return false});return T},_countRemoveWrapper:function(A,F,B){F.remove();this["_after_close_"+A](F,B);if(D(".gritter-item-wrapper").length==0){D("#gritter-notice-wrapper").remove()}},_fade:function(N,J,B,A){var B=B||{},K=(typeof(B.fade)!="undefined")?B.fade:true,L=B.speed||this.fade_out_speed,M=A;this["_before_close_"+J](N,M);if(A){N.unbind("mouseenter mouseleave")}if(K){N.animate({opacity:0},L,function(){N.animate({height:0},300,function(){C._countRemoveWrapper(J,N,M)})})}else{this._countRemoveWrapper(J,N)}},_hoverState:function(B,A){if(A=="mouseenter"){B.addClass("hover");B.find(".gritter-close").show()}else{B.removeClass("hover");B.find(".gritter-close").hide()}},removeSpecific:function(G,H,A,B){if(!A){var A=D("#gritter-item-"+G)}this._fade(A,G,H||{},B)},_restoreItemIfFading:function(B,A){clearTimeout(this["_int_id_"+A]);B.stop().css({opacity:"",height:""})},_runSetup:function(){for(opt in D.gritter.options){this[opt]=D.gritter.options[opt]}this._is_setup=1},_setFadeTimer:function(B,F){var A=(this._custom_timer)?this._custom_timer:this.time;this["_int_id_"+F]=setTimeout(function(){C._fade(B,F)},A)},stop:function(B){var G=(D.isFunction(B.before_close))?B.before_close:function(){};var A=(D.isFunction(B.after_close))?B.after_close:function(){};var H=D("#gritter-notice-wrapper");G(H);H.fadeOut(function(){D(this).remove();A()})},_str_replace:function(X,W,U,A){var R=0,d=0,Y="",S="",b=0,a=0,V=[].concat(X),T=[].concat(W),B=U,c=T instanceof Array,Z=B instanceof Array;B=[].concat(B);if(A){this.window[A]=0}for(R=0,b=B.length;R<b;R++){if(B[R]===""){continue}for(d=0,a=V.length;d<a;d++){Y=B[R]+"";S=c?(T[d]!==undefined?T[d]:""):T[0];B[R]=(Y).split(V[d]).join(S);if(A&&B[R]!==Y){this.window[A]+=(Y.length-B[R].length)/V[d].length}}}return Z?B:B[0]},_verifyWrapper:function(){if(D("#gritter-notice-wrapper").length==0){D("body").append(this._tpl_wrap)}}}})(jQuery);