(function(B){jQuery.fn.extend({slimScroll:function(A){var D=B.extend({width:"auto",height:"250px",size:"4px",color:"#000",position:"right",distance:"1px",start:"top",opacity:0.4,alwaysVisible:!1,disableFadeOut:!1,railVisible:!1,railColor:"#333",railOpacity:0.2,railDraggable:!0,railClass:"slimScrollRail",barClass:"slimScrollBar",wrapperClass:"slimScrollDiv",allowPageScroll:!1,wheelStep:20,touchScrollStep:200,borderRadius:"7px",railBorderRadius:"7px"},A);this.each(function(){function s(E){if(q){E=E||window.event;var F=0;E.wheelDelta&&(F=-E.wheelDelta/120);E.detail&&(F=E.detail/3);B(E.target||E.srcTarget||E.srcElement).closest("."+D.wrapperClass).is(c.parent())&&n(F,!0);E.preventDefault&&!o&&E.preventDefault();o||(E.returnValue=!1)}}function n(F,H,E){o=!1;var I=F,G=c.outerHeight()-d.outerHeight();H&&(I=parseInt(d.css("top"))+F*parseInt(D.wheelStep)/100*d.outerHeight(),I=Math.min(Math.max(I,0),G),I=0<F?Math.ceil(I):Math.floor(I),d.css({top:I+"px"}));m=parseInt(d.css("top"))/(c.outerHeight()-d.outerHeight());I=m*(c[0].scrollHeight-c.outerHeight());E&&(I=F,F=I/c[0].scrollHeight*c.outerHeight(),F=Math.min(Math.max(F,0),G),d.css({top:F+"px"}));c.scrollTop(I);c.trigger("slimscrolling",~~I);l();r()}function g(){window.addEventListener?(this.addEventListener("DOMMouseScroll",s,!1),this.addEventListener("mousewheel",s,!1),this.addEventListener("MozMousePixelScroll",s,!1)):document.attachEvent("onmousewheel",s)}function i(){j=Math.max(c.outerHeight()/c[0].scrollHeight*c.outerHeight(),e);d.css({height:j+"px"});var E=j==c.outerHeight()?"none":"block";d.css({display:E})}function l(){i();clearTimeout(h);m==~~m?(o=D.allowPageScroll,b!=m&&c.trigger("slimscroll",0==~~m?"top":"bottom")):o=!1;b=m;j>=c.outerHeight()?o=!0:(d.stop(!0,!0).fadeIn("fast"),D.railVisible&&a.stop(!0,!0).fadeIn("fast"))}function r(){D.alwaysVisible||(h=setTimeout(function(){D.disableFadeOut&&q||(C||Z)||(d.fadeOut("slow"),a.fadeOut("slow"))},1000))}var q,C,Z,h,f,j,m,b,e=30,o=!1,c=B(this);if(c.parent().hasClass(D.wrapperClass)){var p=c.scrollTop(),d=c.parent().find("."+D.barClass),a=c.parent().find("."+D.railClass);i();if(B.isPlainObject(A)){if("height" in A&&"auto"==A.height){c.parent().css("height","auto");c.css("height","auto");var k=c.parent().parent().height();c.parent().css("height",k);c.css("height",k)}if("scrollTo" in A){p=parseInt(D.scrollTo)}else{if("scrollBy" in A){p+=parseInt(D.scrollBy)}else{if("destroy" in A){d.remove();a.remove();c.unwrap();return}}}n(p,!1,!0)}}else{D.height="auto"==D.height?c.parent().height():D.height;p=B("<div></div>").addClass(D.wrapperClass).css({position:"relative",width:D.width,height:D.height});c.css({width:D.width,height:D.height});var a=B("<div></div>").addClass(D.railClass).css({width:D.size,height:"100%",position:"absolute",top:0,display:D.alwaysVisible&&D.railVisible?"block":"none","border-radius":D.railBorderRadius,background:D.railColor,opacity:D.railOpacity,zIndex:90}),d=B("<div></div>").addClass(D.barClass).css({background:D.color,width:D.size,position:"absolute",top:0,opacity:D.opacity,display:D.alwaysVisible?"block":"none","border-radius":D.borderRadius,BorderRadius:D.borderRadius,MozBorderRadius:D.borderRadius,WebkitBorderRadius:D.borderRadius,zIndex:99}),k="right"==D.position?{right:D.distance}:{left:D.distance};a.css(k);d.css(k);c.wrap(p);c.parent().append(d);c.parent().append(a);D.railDraggable&&d.bind("mousedown",function(F){var E=B(document);Z=!0;t=parseFloat(d.css("top"));pageY=F.pageY;E.bind("mousemove.slimscroll",function(G){currTop=t+G.pageY-pageY;d.css("top",currTop);n(0,d.position().top,!1)});E.bind("mouseup.slimscroll",function(G){Z=!1;r();E.unbind(".slimscroll")});return !1}).bind("selectstart.slimscroll",function(E){E.stopPropagation();E.preventDefault();return !1});a.hover(function(){l()},function(){r()});d.hover(function(){C=!0},function(){C=!1});c.hover(function(){q=!0;l();r()},function(){q=!1;r()});c.bind("touchstart",function(F,E){F.originalEvent.touches.length&&(f=F.originalEvent.touches[0].pageY)});c.bind("touchmove",function(E){o||E.originalEvent.preventDefault();E.originalEvent.touches.length&&(n((f-E.originalEvent.touches[0].pageY)/D.touchScrollStep,!0),f=E.originalEvent.touches[0].pageY)});i();"bottom"===D.start?(d.css({top:c.outerHeight()-d.outerHeight()}),n(0,!0)):"top"!==D.start&&(n(B(D.start).position().top,null,!0),D.alwaysVisible||d.hide());g()}});return this}});jQuery.fn.extend({slimscroll:jQuery.fn.slimScroll})})(jQuery);