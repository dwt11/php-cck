(function(){var B;B=jQuery;B.fn.extend({prettyTextDiff:function(F){var E,A;A={originalContainer:".original",changedContainer:".changed",diffContainer:".diff",cleanup:true,debug:false};A=B.extend(A,F);B.fn.prettyTextDiff.debug("Options: ",A,A);E=new diff_match_patch();return this.each(function(){var D,C,J,I;if(A.originalContent&&A.changedContent){I=B("<div />").html(A.originalContent).text();D=B("<div />").html(A.changedContent).text()}else{I=B(A.originalContainer,this).text();D=B(A.changedContainer,this).text()}B.fn.prettyTextDiff.debug("Original text found: ",I,A);B.fn.prettyTextDiff.debug("Changed  text found: ",D,A);J=E.diff_main(I,D);if(A.cleanup){E.diff_cleanupSemantic(J)}B.fn.prettyTextDiff.debug("Diffs: ",J,A);C=B.map(J,function(G){return B.fn.prettyTextDiff.createHTML(G)});B(A.diffContainer,this).html(C.join(""));return this})}});B.fn.prettyTextDiff.debug=function(A,E,F){if(F.debug){return console.log(A,E)}};B.fn.prettyTextDiff.createHTML=function(P){var M,R,Q,L,K,O,A,N;R=[];L=/&/g;O=/</g;K=/>/g;A=/\n/g;Q=P[0],M=P[1];N=M.replace(L,"&amp;").replace(O,"&lt;").replace(K,"&gt;").replace(A,"<br>");switch(Q){case DIFF_INSERT:return"<ins>"+N+"</ins>";case DIFF_DELETE:return"<del>"+N+"</del>";case DIFF_EQUAL:return"<span>"+N+"</span>"}}}).call(this);